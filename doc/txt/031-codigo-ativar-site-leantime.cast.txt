]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano tasks/tasks.yml 
[?2004h[?1049h[22;0;0t[1;39r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[37;64H(B[0;7m[ A ler... ](B[m[37;60H(B[0;7m[ 157 linhas lidas ](B[m[H(B[0;7m  GNU nano 4.8                                                tasks/tasks.yml                                                             [1;137H(B[m[38d(B[0;7m^G(B[m Ajuda[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar[52G(B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor    (B[0;7mM-U(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39d(B[0;7m^X(B[m Sair[39;18H(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer[120G(B[0;7mM-6(B[m Copiar txt[37d[2d[39;49m(B[m---[3d- name: Atualiza a cache (equivalente a apt update)[4;6Hapt:[5dupdate_cache: true[6;8Hcache_valid_time: 3600[8;4H- name: "Atualiza o sistema operativo"[9;6Hapt:[10dupgrade: safe[12;4H- name: "Instalar as dependencias necess√°ria ao programa leantime"[13;6Hapt:[14dpkg:[15;8H- mc[16;8H- screen[17;8H- git[18;8H- apache2[19;8H- mysql-server[20;8H- php[21;8H- php-mysql[22;8H- php-ldap[23;8H- php-cli[24;8H- php-soap[25;8H- php-json[26;8H- graphviz[27;8H- php-xml[28;8H- php-gd[29;8H- php-zip[30;8H- libapache2-mod-php[31;8H- php-dev[32;8H- libmcrypt-dev[33;8H- gcc[34;8H- make[35;8H- autoconf[36;8H- libc-dev[2d[?12l[?25h[?25l[7G[1K - autoconf[3;4H    - libc-dev[K[4;6H  - pkg-config[5;8H- pwgen[K[6;8H- curl[K[7;8H- unzip[8;4H    - zip[K[9;6H  - php-mbstring[10;8H- expect[K[11;8H- net-tools[12;4H    - python3-mysqldb[K[13;6H  - python3-apt[14;8H- python3-pycurl[15d[K[16d[36m   # Fonte de inspira√ß√£o: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html[17;4H[39m(B[m- name: "Instala o servi√ßo apache2 no arranque do sistema"[18;6Hservice:[K[19;8Hname: apache2[K[20;8Hstate: started[21;8Henabled: true[22d[K[23d[36m   # Fonte: https://www.mydailytutorials.com/using-ansible-find-module-search-filesfolder[24;4H[39m(B[m- name: "Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2"[25;6Hfind:[K[26;8Hpaths: /etc[27;8Hpatterns: "php.ini"[28;8Hrecurse: true[29;6Hregister: caminho_php_ini[30d[K[31d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html[32;4H[39m(B[m- name: "Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile."[33;6Hansible.builtin.lineinfile:[34;8Hpath: "{{ caminho_php_ini.files[0].path }}"[35;8Hregexp: "{{ item.regexp  }}"[36;8Hline: "{{ item.line }}"[2d[?12l[?25h[?25l[8Gregexp: "{{ item.regexp  }}"[3;8Hline: "{{ item.line }}"[4;6Hwith_items:[K[5;10Hregexp: "^file_uploads"[6;8H  line: "file_uploads = 1"[7;10Hregexp: "^upload_max_filesize"[8;8H  line: "upload_max_filesize = 1G"[9;10Hregexp: "^max_file_uploads"[10;8H  line: "max_file_uploads = 20"[11;10Hregexp: "^post_max_size"[12;8H  line: "post_max_size = 2G"[13;10Hregexp: "^memory_limit"[14;8H  line: "memory_limit = 2G"[15;8H- regexp: "^max_input_time"[16;9H[1K line: "max_input_time = 3600"[K[17d[K[18d[36m   # Fonte: https://docs.ansible.com/ansible/2.7/modules/file_module.html[19;4H[39m(B[m- name: Cria a directoria tempor√°ria leantime e a directoria de apache leantime[20;6Hfile:[K[21;8Hpath: "{{ item.path }}"[22;8Hstate: directory[23;7H[1K mode: 0755[K[24;4H    owner: www-data[K[25;6H  group: www-data[26;6Hwith_items:[K[27;8H- path: "/tmp/leantime"[28;8H- path: "/var/www/leantime"[29d[K[30d[36m   # Fonte: Ansible for DevOps - Server and configuration management for humans de Jeff Geerling, p√°gina 98[31d[39m(B[m   - name: "Cria a base de dados de mysql para o leantime"[K[32;4H  mysql_db: "db=leantime_database state=present"[K[33d[K[34;4H- name: "Cria o utilizador para a base de dados leantime"[35;6Hmysql_user:[K[36;8Hnam[18Glogin_leantime }}"[2d[?12l[?25h[?25l[6Gmysql_user:[K[3;8Hnam[18Glogin_leantime }}"[4;6H  password: "{{ password_leantime }}"[5;8Hpriv: "leantime_database.*:ALL"[6;8Hhost: localhost[K[7;8Hstate: present[K[8d[K[9;4H- name: "Faz o download do software leantime a partir do reposit√≥rio git"[10;6Hget_url:[K[11;8Hurl: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zip[12;8Hdest: /tmp/leantime[K[13;8Hmode: 0755[K[14d[K[15d[36m   # O ficheiro Leantime-versao.zip necessita de ser descomprimido[16;4H[39m(B[m- name: Descomprime o software leantime[17;6Hunarchive:[18;7H[1K src: "/tmp/leantime/Leantime-{{ versao_leantime }}.zip"[K[19;4H    dest: "/var/www/leantime"[K[20;6H  owner: www-data[21;8Hgroup: www-data[K[22;8Hmode: 0755[K[23;8Hremote_src: true[24d[K[25d[36m   # Ap√≥s a descompress√£o, se o ficheiro configuration.php n√£o existir, este necessita de ser[26d   # criado a partir do ficheiro configuration.sample.php[27d   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html[28;4H[39m(B[m- name: Copia o ficheiro de configura√ß√£o configuration.sample.php[29;6Hansible.builtin.copy:[30;7H[1K src: /var/www/leantime/config/configuration.sample.php[K[31;4H    dest: /var/www/leantime/config/configuration.php[K[32;6H  owner: www-data[K[33;8Hgroup: www-data[34;4H    mode: '0755'[K[35;6H  remote_src: true[36;8Hforce: false[K[2d[?12l[?25h[?25l[6G  remote_src: true[3;8Hforce: false[K[4d[K[5d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[6;4H[39m(B[m- name: Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.[7;6Hansible.builtin.replace:[8;8Hpath: /var/www/leantime/config/configuration.php[9;4H    regexp: "{{ item.regexp  }}"[K[10;6H  replace: "{{ item.line }}"[11;6Hwith_items:[K[12;8H- regexp: 'dbUser=""'[13;8H  line: 'dbUser="{{ login_leantime }}"'[14;8H- regexp: 'dbDatabase=""'[15;9H[1K line: 'dbDatabase="leantime_database"'[K[16;4H    - regexp: 'dbPassword=""'[K[17;6H    line: 'dbPassword="{{ password_leantime }}"'[18d[K[19d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html[20;4H[39m(B[m- name: Copia o template do site para a p√°sta /etc/apache2/sites-available[21;6Hansible.builtin.template:[22;8Hsrc: leantime.template.j2[23;8Hdest: /etc/apache2/sites-available/leantime.conf[24;8Howner: root[25;7H[1K group: www-data[K[26;7H[1K mode: 0755[K[27d[K[28d[K[29d[K[30d[K[31d[K[32d[K[33d[K[34d[K[35d[K[36d[K[2d[?12l[?25h[?25l[27d[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[1;127H(B[0;7mModificado(B[m[28d[?12l[?25h[?25l[A[?12l[?25h[?25l[28d[?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l[36m  #[39m(B[m[?12l[?25h[?25l[36m [39m(B[m[?12l[?25h[?25l[36mF[39m(B[m[?12l[?25h[?25l[36mo[37d[39m(B[m[K[28;7H[?12l[?25h[?25l[36mn[39m(B[m[?12l[?25h[?25l[36mt[39m(B[m[?12l[?25h[?25l[36me[39m(B[m[?12l[?25h[?25l[36m:[39m(B[m[?12l[?25h[?25l[36m [39m(B[m[?12l[?25h[?25l[36mh[39m(B[m[?12l[?25h[?25l[36mt[39m(B[m[?12l[?25h[?25l[36mt[39m(B[m[?12l[?25h[?25l[36mp[39m(B[m[?12l[?25h[?25l[36ms[39m(B[m[?12l[?25h[?25l[36m:[39m(B[m[?12l[?25h[?25l[36m/[39m(B[m[?12l[?25h[?25l[36m/[39m(B[m[?12l[?25h[?25l[36md[39m(B[m[?12l[?25h[?25l[36mo[39m(B[m[?12l[?25h[?25l[36mc[39m(B[m[?12l[?25h[?25l[36ms[39m(B[m[?12l[?25h[?25l[36m.[39m(B[m[?12l[?25h[?25l[36ma[39m(B[m[?12l[?25h[?25l[36mn[39m(B[m[?12l[?25h[?25l[36ms[39m(B[m[?12l[?25h[?25l[36mi[39m(B[m[?12l[?25h[?25l[36mb[39m(B[m[?12l[?25h[?25l[36ml[39m(B[m[?12l[?25h[?25l[36me[39m(B[m[?12l[?25h[?25l[36m.[39m(B[m[?12l[?25h[?25l[36mc[39m(B[m[?12l[?25h[?25l[36mo[39m(B[m[?12l[?25h[?25l[36mm[39m(B[m[?12l[?25h[?25l[36m/[39m(B[m[?12l[?25h[?25l[36ma[39m(B[m[?12l[?25h[?25l[36mn[39m(B[m[?12l[?25h[?25l[36ms[39m(B[m[?12l[?25h[?25l[36mi[39m(B[m[?12l[?25h[?25l[36mb[39m(B[m[?12l[?25h[?25l[36ml[39m(B[m[?12l[?25h[?25l[36me[39m(B[m[?12l[?25h[?25l[36m/[39m(B[m[?12l[?25h[?25l[36ml[39m(B[m[?12l[?25h[?25l[36ma[39m(B[m[?12l[?25h[?25l[36mt[39m(B[m[?12l[?25h[?25l[36me[39m(B[m[?12l[?25h[?25l[36ms[39m(B[m[?12l[?25h[?25l[36mt[39m(B[m[?12l[?25h[?25l[36m/[39m(B[m[?12l[?25h[?25l[36mc[39m(B[m[?12l[?25h[?25l[36mo[39m(B[m[?12l[?25h[?25l[36ml[39m(B[m[?12l[?25h[?25l[36ml[39m(B[m[?12l[?25h[?25l[36me[39m(B[m[?12l[?25h[?25l[36mc[39m(B[m[?12l[?25h[?25l[36mt[39m(B[m[?12l[?25h[?25l[36mi[39m(B[m[?12l[?25h[?25l[36mo[39m(B[m[?12l[?25h[?25l[36mn[39m(B[m[?12l[?25h[?25l[36ms[39m(B[m[?12l[?25h[?25l[36m/[39m(B[m[?12l[?25h[?25l[36ma[39m(B[m[?12l[?25h[?25l[36mn[39m(B[m[?12l[?25h[?25l[36ms[39m(B[m[?12l[?25h[?25l[36mi[39m(B[m[?12l[?25h[?25l[36mb[39m(B[m[?12l[?25h[?25l[36ml[39m(B[m[?12l[?25h[?25l[36me[39m(B[m[?12l[?25h[?25l[36m/[39m(B[m[?12l[?25h[?25l[36mb[39m(B[m[?12l[?25h[?25l[36mu[39m(B[m[?12l[?25h[?25l[36mi[39m(B[m[?12l[?25h[?25l[36ml[39m(B[m[?12l[?25h[?25l[36mt[39m(B[m[?12l[?25h[?25l[36mi[39m(B[m[?12l[?25h[?25l[36mn[39m(B[m[?12l[?25h[?25l[36m/[39m(B[m[?12l[?25h[?25l[36mf[39m(B[m[?12l[?25h[?25l[36mi[39m(B[m[?12l[?25h[?25l[36ml[39m(B[m[?12l[?25h[?25l[36me[39m(B[m[?12l[?25h[?25l[36m_[39m(B[m[?12l[?25h[?25l[36mm[39m(B[m[?12l[?25h[?25l[36mo[39m(B[m[?12l[?25h[?25l[36md[39m(B[m[?12l[?25h[?25l[36mu[39m(B[m[?12l[?25h[?25l[36ml[39m(B[m[?12l[?25h[?25l[36me[39m(B[m[?12l[?25h[?25l[36m.[39m(B[m[?12l[?25h[?25l[36mh[39m(B[m[?12l[?25h[?25l[36mt[39m(B[m[?12l[?25h[?25l[36mm[39m(B[m[?12l[?25h[?25l[36ml[39m(B[m[?12l[?25h[?25l[29d[?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l-[?12l[?25h[?25l [?12l[?25h[?25ln[?12l[?25h[?25la[?12l[?25h[?25lm[?12l[?25h[?25le[?12l[?25h[?25l:[?12l[?25h[?25l [?12l[?25h[?25l"[?12l[?25h[?25lC[?12l[?25h[?25lr[?12l[?25h[?25li[?12l[?25h[?25la[?12l[?25h[?25l [?12l[?25h[?25lu[?12l[?25h[?25lm[?12l[?25h[?25l [?12l[?25h[?25ll[?12l[?25h[?25li[?12l[?25h[?25ln[?12l[?25h[?25lk[?12l[?25h[?25l [?12l[?25h[?25ls[?12l[?25h[?25li[?12l[?25h[?25lm[?12l[?25h[?25lb[?12l[?25h[?25l√≥[?12l[?25h[?25ll[?12l[?25h[?25li[?12l[?25h[?25lc[?12l[?25h[?25lo[?12l[?25h[?25l [?12l[?25h[?25lp[?12l[?25h[?25la[?12l[?25h[?25lr[?12l[?25h[?25la[?12l[?25h[?25l [?12l[?25h[?25lo[?12l[?25h[?25l [?12l[?25h[?25lf[?12l[?25h[?25li[?12l[?25h[?25lc[?12l[?25h[?25lh[?12l[?25h[?25le[?12l[?25h[?25li[?12l[?25h[?25lr[?12l[?25h[?25lo[?12l[?25h[?25l [?12l[?25h[?25ll[?12l[?25h[?25le[?12l[?25h[?25la[?12l[?25h[?25ln[?12l[?25h[?25lt[?12l[?25h[?25li[?12l[?25h[?25lm[?12l[?25h[?25le[?12l[?25h[?25l.[?12l[?25h[?25lc[?12l[?25h[?25lo[?12l[?25h[?25ln[?12l[?25h[?25lf[?12l[?25h[?25l [?12l[?25h[?25ln[?12l[?25h[?25la[?12l[?25h[?25l [?12l[?25h[?25lp[?12l[?25h[?25ls[?12l[?25h[?25lt[?12l[?25h[?25la[?12l[?25h[?25l [?12l[?25h[?25l/[?12l[?25h[?25le[?12l[?25h[?25lt[?12l[?25h[?25lc[?12l[?25h[?25l/[?12l[?25h[?25la[?12l[?25h[?25lp[?12l[?25h[?25la[?12l[?25h[?25lc[?12l[?25h[?25lh[?12l[?25h[?25le[?12l[?25h[?25l/[?12l[?25h[?25ls[?12l[?25h[?25li[?12l[?25h[?25lt[?12l[?25h[?25le[?12l[?25h[?25ls[?12l[?25h[?25l-[?12l[?25h[?25le[?12l[?25h[?25ln[?12l[?25h[?25la[?12l[?25h[?25lb[?12l[?25h[?25ll[?12l[?25h[?25le[?12l[?25h[?25ld[?12l[?25h[?25l"[?12l[?25h[?25l[30d[?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25la[?12l[?25h[?25ln[?12l[?25h[?25ls[?12l[?25h[?25li[?12l[?25h[?25lb[?12l[?25h[?25ll[?12l[?25h[?25le[?12l[?25h[?25l.[?12l[?25h[?25lb[?12l[?25h[?25lu[?12l[?25h[?25li[?12l[?25h[?25ll[?12l[?25h[?25lt[?12l[?25h[?25li[?12l[?25h[?25ln[?12l[?25h[?25l.[?12l[?25h[?25lf[?12l[?25h[?25li[?12l[?25h[?25ll[?12l[?25h[?25le[?12l[?25h[?25l:[?12l[?25h[?25l[31d[?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25ls[?12l[?25h[?25lr[?12l[?25h[?25lc[?12l[?25h[?25l:[?12l[?25h[?25l [?12l[?25h[?25l/[?12l[?25h[?25le[?12l[?25h[?25lt[?12l[?25h[?25lc[?12l[?25h[?25l/[?12l[?25h[?25la[?12l[?25h[?25lp[?12l[?25h[?25la[?12l[?25h[?25lc[?12l[?25h[?25lh[?12l[?25h[?25le[?12l[?25h[?25l2[?12l[?25h[?25l/[?12l[?25h[?25ls[?12l[?25h[?25li[?12l[?25h[?25lt[?12l[?25h[?25le[?12l[?25h[?25ls[?12l[?25h[?25l-[?12l[?25h[?25la[?12l[?25h[?25lv[?12l[?25h[?25la[?12l[?25h[?25li[?12l[?25h[?25ll[?12l[?25h[?25la[?12l[?25h[?25lb[?12l[?25h[?25ll[?12l[?25h[?25le[?12l[?25h[?25l/[?12l[?25h[?25ll[?12l[?25h[?25le[?12l[?25h[?25la[?12l[?25h[?25ln[?12l[?25h[?25lt[?12l[?25h[?25li[?12l[?25h[?25lm[?12l[?25h[?25le[?12l[?25h[?25l.[?12l[?25h[?25lc[?12l[?25h[?25lo[?12l[?25h[?25ln[?12l[?25h[?25lf[?12l[?25h[?25l[32d[?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25ld[?12l[?25h[?25le[?12l[?25h[?25ls[?12l[?25h[?25lt[?12l[?25h[?25l:[?12l[?25h[?25l [?12l[?25h[?25l/[?12l[?25h[?25le[?12l[?25h[?25lt[?12l[?25h[?25lc[?12l[?25h[?25l/[?12l[?25h[?25la[?12l[?25h[?25lp[?12l[?25h[?25la[?12l[?25h[?25lc[?12l[?25h[?25lh[?12l[?25h[?25le[?12l[?25h[?25l2[?12l[?25h[?25l/[?12l[?25h[?25ls[?12l[?25h[?25li[?12l[?25h[?25lt[?12l[?25h[?25le[?12l[?25h[?25ls[?12l[?25h[?25l-[?12l[?25h[?25le[?12l[?25h[?25ln[?12l[?25h[?25la[?12l[?25h[?25lb[?12l[?25h[?25ll[?12l[?25h[?25le[?12l[?25h[?25ld[?12l[?25h[?25l[33d[?12l[?25h[?25l  [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25lo[?12l[?25h[?25lw[?12l[?25h[?25ln[?12l[?25h[?25le[?12l[?25h[?25lr[?12l[?25h[?25l:[?12l[?25h[?25l [?12l[?25h[?25lr[?12l[?25h[?25lo[?12l[?25h[?25lo[?12l[?25h[?25lt[?12l[?25h[?25l[34d[?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25lg[?12l[?25h[?25lr[?12l[?25h[?25lo[?12l[?25h[?25lu[?12l[?25h[?25lp[?12l[?25h[?25l:[?12l[?25h[?25l [?12l[?25h[?25lr[?12l[?25h[?25lo[?12l[?25h[?25lo[?12l[?25h[?25lt[?12l[?25h[?25l[35d[?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25lm[?12l[?25h[?25lo[?12l[?25h[?25ld[?12l[?25h[?25le[?12l[?25h[?25l:[?12l[?25h[?25l [?12l[?25h[?25l'[?12l[?25h[?25l0[?12l[?25h[?25l7[?12l[?25h[?25l7[?12l[?25h[?25l7[?12l[?25h[?25l'[?12l[?25h[?25l[36d[?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25ls[?12l[?25h[?25lt[?12l[?25h[?25la[?12l[?25h[?25lt[?12l[?25h[?25le[?12l[?25h[?25l:[?12l[?25h[?25l [?12l[?25h[?25ll[?12l[?25h[?25li[?12l[?25h[?25ln[?12l[?25h[?25lk[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[29d[?12l[?25h[?25lm[?12l[?25h[?25l [?12l[?25h[?25ll[?12l[?25h[?25li[?12l[?25h[?25ln[?12l[?25h[?25lk[?12l[?25h[?25l [?12l[?25h[?25ls[?12l[?25h[?25li[?12l[?25h[?25lm[?12l[?25h[?25lb[?12l[?25h[?25l[C[?12l[?25h[?25ll[?12l[?25h[?25li[?12l[?25h[?25lc[?12l[?25h[?25lo[?12l[?25h[?25l [?12l[?25h[?25lp[?12l[?25h[?25la[?12l[?25h[?25lr[?12l[?25h[?25la[?12l[?25h[?25l [?12l[?25h[?25lo[?12l[?25h[?25l [?12l[?25h[?25lf[?12l[?25h[?25li[?12l[?25h[?25lc[?12l[?25h[?25lh[?12l[?25h[?25le[?12l[?25h[?25li[?12l[?25h[?25lr[?12l[?25h[?25lo[?12l[?25h[?25l [?12l[?25h[?25ll[?12l[?25h[?25le[?12l[?25h[?25la[?12l[?25h[?25ln[?12l[?25h[?25lt[?12l[?25h[?25li[?12l[?25h[?25lm[?12l[?25h[?25le[?12l[?25h[?25l.[?12l[?25h[?25lc[?12l[?25h[?25lo[?12l[?25h[?25ln[?12l[?25h[?25lf[?12l[?25h[?25l [?12l[?25h[?25ln[?12l[?25h[?25la[?12l[?25h[?25l [?12l[?25h[?25lp[?12l[?25h[?25lasta /etc/apache/sites-enabled"[29;70H[?12l[?25h[?25l[30;26H[?12l[?25h[?25l[31;54H[?12l[?25h[?25l[32;39H[?12l[?25h[?25l[33;18H[?12l[?25h[?25l[34d[?12l[?25h[?25l[35d'[?12l[?25h[?25l[36d[?12l[?25h[?25l7[2;37r8[37d
[1;39r[36;1H[?12l[?25h[?25l[?12l[?25h[?25l[38;18H         [38;35H(B[0;7mM-D(B[m Formato DOS[19X[38;69H(B[0;7mM-A(B[m Anexar[20X[38;105H(B[0;7mB(B[m Seguran√ßa[K[39;2H(B[0;7mC(B[m Cancelar[18G           [35G(B[0;7mM-M(B[m Formato Mac[19X[39;69H(B[0;7mM-P(B[m Prepor[24X[39;103H(B[0;7m^T(B[m P/ ficheiros[K[37d(B[0;7mNome do ficheiro onde escrever: tasks/tasks.yml                                                                                           [37;1H(B[m[37;48H[?12l[?25h[?25l[37;60H[1K (B[0;7m[ A escrever... ](B[m[K[1;127H(B[0;7m          (B[m[37;58H(B[0;7m[ 167 linhas escritas ](B[m[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar      (B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor[105G(B[0;7mU(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39;2H(B[0;7mX(B[m Sair    [18G(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer      (B[0;7mM-6(B[m Copiar txt[37d[A[?12l[?25h[?25l[37d[J[39d[?12l[?25h[39;1H[?1049l[23;0;0t[?1l>[?2004l]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule lint
[34mINFO    [0m default scenario test matrix: dependency, lint
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mdependency[0m
[31mWARNING [0m Skipping, missing the requirements file.
[31mWARNING [0m Skipping, missing the requirements file.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mlint[0m
COMMAND: set -e
yamllint .
ansible-lint

./tasks/tasks.yml
  160:3     error    syntax error: expected '<document start>', but found '<block sequence start>' (syntax)

[1;31mCRITICAL[0m Lint failed with error code [1;36m1[0m
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule lintnano tasks/tasks.yml 
[?2004h[?1049h[22;0;0t[1;39r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[37;64H(B[0;7m[ A ler... ](B[m[37;60H(B[0;7m[ 167 linhas lidas ](B[m[H(B[0;7m  GNU nano 4.8                                                tasks/tasks.yml                                                             [1;137H(B[m[38d(B[0;7m^G(B[m Ajuda[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar[52G(B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor    (B[0;7mM-U(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39d(B[0;7m^X(B[m Sair[39;18H(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer[120G(B[0;7mM-6(B[m Copiar txt[37d[2d[39;49m(B[m---[3d- name: Atualiza a cache (equivalente a apt update)[4;6Hapt:[5dupdate_cache: true[6;8Hcache_valid_time: 3600[8;4H- name: "Atualiza o sistema operativo"[9;6Hapt:[10dupgrade: safe[12;4H- name: "Instalar as dependencias necess√°ria ao programa leantime"[13;6Hapt:[14dpkg:[15;8H- mc[16;8H- screen[17;8H- git[18;8H- apache2[19;8H- mysql-server[20;8H- php[21;8H- php-mysql[22;8H- php-ldap[23;8H- php-cli[24;8H- php-soap[25;8H- php-json[26;8H- graphviz[27;8H- php-xml[28;8H- php-gd[29;8H- php-zip[30;8H- libapache2-mod-php[31;8H- php-dev[32;8H- libmcrypt-dev[33;8H- gcc[34;8H- make[35;8H- autoconf[36;8H- libc-dev[2d[?12l[?25h[?25l[38;18H         [38;38HIn. par√°g[22X[38;69H(B[0;7m^Y(B[m Prim.linha[21X[38;103H(B[0;7m^T(B[m Ir para txt[K[39;2H(B[0;7mC(B[m Cancelar[18G           [36G(B[0;7mO(B[m Fim par√°g[17X[39;70H(B[0;7mV(B[m √ölt. linha[K[37d(B[0;7mInsira n¬∫ da linha, n¬∫ da coluna:                                                                                                         [37;1H(B[m[37;35H[?12l[?25h[?25l(B[0;7m1(B[m[37;36H[?12l[?25h[?25l(B[0;7m6(B[m[37;37H[?12l[?25h[?25l(B[0;7m0(B[m[37;38H[?12l[?25h[?25l(B[0;7m,(B[m[37;39H[?12l[?25h[?25l(B[0;7m3(B[m[37;40H[?12l[?25h[?25l[K[38;18H(B[0;7m^O(B[m Gravar[38;38HProcurar      (B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor    (B[0;7mM-U(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39;2H(B[0;7mX(B[m Sair    [18G(B[0;7m^R(B[m Carregar[36G(B[0;7m\(B[m Substituir    (B[0;7m^U(B[m Colar txt[70G(B[0;7mT(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer[120G(B[0;7mM-6(B[m Copiar txt[37d[2;7H[1K - regexp: 'dbUser=""'[3;9H[1K line: 'dbUser="{{ login_leantime }}"'[K[4;6H  - regexp: 'dbDatabase=""'[5;8H  line: 'dbDatabase="leantime_database"'[6;8H- regexp: 'dbPassword=""'[7;10Hline: 'dbPassword="{{ password_leantime }}"'[8d[K[9d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html[10;4H[39m(B[m- name: Copia o template do site para a p√°sta /etc/apache2/sites-available[11;6Hansible.builtin.template:[12;4H    src: leantime.template.j2[K[13;6H  dest: /etc/apache2/sites-available/leantime.conf[14;8Howner: root[15;8Hgroup: www-data[16;8Hmode: 0755[17d[K[18d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html[19;3H[39m(B[m- name: "Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled"[20;5Hansible.builtin.file:[21;7Hsrc: /etc/apache2/sites-available/leantime.conf[22;7Hdest: /etc/apache2/sites-enabled[23;7Howner: root[24;7Hgroup: root[25;7Hmode: '0777'[26;7Hstate: link[27d[K[28d[K[29d[K[30d[K[31d[K[32d[K[33d[K[34d[K[35d[K[36d[K[19d  [?12l[?25h[?25l[1;127H(B[0;7mModificado(B[m[19d   - name: "Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled"   [?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A   [?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[11d[?12l[?25h[?25l[12d[?12l[?25h[?25l[13d[?12l[?25h[?25l[14d[?12l[?25h[?25l[15d[?12l[?25h[?25l[16d[?12l[?25h[?25l[17d[?12l[?25h[?25l[18;4H[?12l[?25h[?25l[?12l[?25h[?25l[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html   [39m(B[m[?12l[?25h[?25l[19d[?12l[?25h[?25l[20d[?12l[?25h[?25l     ansible.builtin.file:[5G[?12l[?25h[?25l[21d[?12l[?25h[?25l[7G src: /etc/apache2/sites-available/leantime.conf[6G[?12l[?25h[?25l[22d[?12l[?25h[?25l[7G dest: /etc/apache2/sites-enabled[7G[?12l[?25h[?25l[23d[?12l[?25h[?25l[?12l[?25h[?25l[7G owner: root[7G[?12l[?25h[?25l[24d[?12l[?25h[?25l[?12l[?25h[?25l[7G group: root[7G[?12l[?25h[?25l[25d[?12l[?25h[?25l[?12l[?25h[?25l[7G mode: '0777'[7G[?12l[?25h[?25l[26d[?12l[?25h[?25l[?12l[?25h[?25l[7G state: link[7G[?12l[?25h[?25l[27d[?12l[?25h[?25l[?12l[?25h[?25l[38;18H         [38;35H(B[0;7mM-D(B[m Formato DOS[19X[38;69H(B[0;7mM-A(B[m Anexar[20X[38;105H(B[0;7mB(B[m Seguran√ßa[K[39;2H(B[0;7mC(B[m Cancelar[18G           [35G(B[0;7mM-M(B[m Formato Mac[19X[39;69H(B[0;7mM-P(B[m Prepor[24X[39;103H(B[0;7m^T(B[m P/ ficheiros[K[37d(B[0;7mNome do ficheiro onde escrever: tasks/tasks.yml                                                                                           [37;1H(B[m[37;48H[?12l[?25h[?25l[37;60H[1K (B[0;7m[ A escrever... ](B[m[K[1;127H(B[0;7m          (B[m[37;58H(B[0;7m[ 167 linhas escritas ](B[m[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar      (B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor[105G(B[0;7mU(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39;2H(B[0;7mX(B[m Sair    [18G(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer      (B[0;7mM-6(B[m Copiar txt[37d[27d[?12l[?25h[?25l[37d[J[39d[?12l[?25h[39;1H[?1049l[23;0;0t[?1l>[?2004l]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano tasks/tasks.yml [8Pmolecule lint
[34mINFO    [0m default scenario test matrix: dependency, lint
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mdependency[0m
[31mWARNING [0m Skipping, missing the requirements file.
[31mWARNING [0m Skipping, missing the requirements file.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mlint[0m
COMMAND: set -e
yamllint .
ansible-lint

Loading custom .yamllint config file, this extends our internal yamllint config.
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule converge
[34mINFO    [0m default scenario test matrix: dependency, create, prepare, converge
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mdependency[0m
[31mWARNING [0m Skipping, missing the requirements file.
[31mWARNING [0m Skipping, missing the requirements file.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mcreate[0m
[31mWARNING [0m Skipping, instances already created.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mprepare[0m
[31mWARNING [0m Skipping, instances already prepared.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mconverge[0m

PLAY [Converge] **************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Include leantime_ansible] **********************************************************************************************************

TASK [leantime_ansible : Atualiza a cache (equivalente a apt update)] ********************************************************************
[33mchanged: [ubuntu-20.04][0m

TASK [leantime_ansible : Atualiza o sistema operativo] ***********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instalar as dependencias necess√°ria ao programa leantime] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instala o servi√ßo apache2 no arranque do sistema] ***************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2] *************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ***************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [leantime_ansible : Cria a directoria tempor√°ria leantime e a directoria de apache leantime] ****************************************
[32mok: [ubuntu-20.04] => (item={'path': '/tmp/leantime'})[0m
[32mok: [ubuntu-20.04] => (item={'path': '/var/www/leantime'})[0m

TASK [leantime_ansible : Cria a base de dados de mysql para o leantime] ******************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria o utilizador para a base de dados leantime] ****************************************************************
[1;35m[WARNING]: Module did not set no_log for update_password[0m
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Faz o download do software leantime a partir do reposit√≥rio git] ************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Descomprime o software leantime] ********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Copia o ficheiro de configura√ß√£o configuration.sample.php] ******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.] ***
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbUser=""', 'line': 'dbUser="leantimeDBadmin"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbDatabase=""', 'line': 'dbDatabase="leantime_database"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbPassword=""', 'line': 'dbPassword="#S3gr3d0S3cr3t0#"'})[0m

TASK [leantime_ansible : Copia o template do site para a p√°sta /etc/apache2/sites-available] *********************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled] ************************
[31mfatal: [ubuntu-20.04]: FAILED! => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "msg": "refusing to convert from directory to symlink for /etc/apache2/sites-enabled", "owner": "root", "path": "/etc/apache2/sites-enabled", "size": 4096, "state": "directory", "uid": 0}[0m

PLAY RECAP *******************************************************************************************************************************
[31mubuntu-20.04[0m               : [32mok=15  [0m [33mchanged=1   [0m unreachable=0    [31mfailed=1   [0m skipped=0    rescued=0    ignored=0


[1;31mCRITICAL[0m Ansible return code was [1;36m2[0m, command was: ansible-playbook --inventory [35m/home/admlocal/.cache/molecule/leantime_ansible/default/[0m[95minventory[0m --skip-tags molecule-notest,notest [35m/home/admlocal/leantime_ansible/molecule/default/[0m[95mconverge.yml[0m
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule converge[4Plintnano tasks/tasks.yml 
[?2004h[?1049h[22;0;0t[1;39r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[37;64H(B[0;7m[ A ler... ](B[m[37;60H(B[0;7m[ 167 linhas lidas ](B[m[H(B[0;7m  GNU nano 4.8                                                tasks/tasks.yml                                                             [1;137H(B[m[38d(B[0;7m^G(B[m Ajuda[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar[52G(B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor    (B[0;7mM-U(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39d(B[0;7m^X(B[m Sair[39;18H(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer[120G(B[0;7mM-6(B[m Copiar txt[37d[2d[39;49m(B[m---[3d- name: Atualiza a cache (equivalente a apt update)[4;6Hapt:[5dupdate_cache: true[6;8Hcache_valid_time: 3600[8;4H- name: "Atualiza o sistema operativo"[9;6Hapt:[10dupgrade: safe[12;4H- name: "Instalar as dependencias necess√°ria ao programa leantime"[13;6Hapt:[14dpkg:[15;8H- mc[16;8H- screen[17;8H- git[18;8H- apache2[19;8H- mysql-server[20;8H- php[21;8H- php-mysql[22;8H- php-ldap[23;8H- php-cli[24;8H- php-soap[25;8H- php-json[26;8H- graphviz[27;8H- php-xml[28;8H- php-gd[29;8H- php-zip[30;8H- libapache2-mod-php[31;8H- php-dev[32;8H- libmcrypt-dev[33;8H- gcc[34;8H- make[35;8H- autoconf[36;8H- libc-dev[2d[?12l[?25h[?25l[7G[1K - autoconf[3;4H    - libc-dev[K[4;6H  - pkg-config[5;8H- pwgen[K[6;8H- curl[K[7;8H- unzip[8;4H    - zip[K[9;6H  - php-mbstring[10;8H- expect[K[11;8H- net-tools[12;4H    - python3-mysqldb[K[13;6H  - python3-apt[14;8H- python3-pycurl[15d[K[16d[36m   # Fonte de inspira√ß√£o: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html[17;4H[39m(B[m- name: "Instala o servi√ßo apache2 no arranque do sistema"[18;6Hservice:[K[19;8Hname: apache2[K[20;8Hstate: started[21;8Henabled: true[22d[K[23d[36m   # Fonte: https://www.mydailytutorials.com/using-ansible-find-module-search-filesfolder[24;4H[39m(B[m- name: "Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2"[25;6Hfind:[K[26;8Hpaths: /etc[27;8Hpatterns: "php.ini"[28;8Hrecurse: true[29;6Hregister: caminho_php_ini[30d[K[31d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html[32;4H[39m(B[m- name: "Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile."[33;6Hansible.builtin.lineinfile:[34;8Hpath: "{{ caminho_php_ini.files[0].path }}"[35;8Hregexp: "{{ item.regexp  }}"[36;8Hline: "{{ item.line }}"[2d[?12l[?25h[?25l[8Gregexp: "{{ item.regexp  }}"[3;8Hline: "{{ item.line }}"[4;6Hwith_items:[K[5;10Hregexp: "^file_uploads"[6;8H  line: "file_uploads = 1"[7;10Hregexp: "^upload_max_filesize"[8;8H  line: "upload_max_filesize = 1G"[9;10Hregexp: "^max_file_uploads"[10;8H  line: "max_file_uploads = 20"[11;10Hregexp: "^post_max_size"[12;8H  line: "post_max_size = 2G"[13;10Hregexp: "^memory_limit"[14;8H  line: "memory_limit = 2G"[15;8H- regexp: "^max_input_time"[16;9H[1K line: "max_input_time = 3600"[K[17d[K[18d[36m   # Fonte: https://docs.ansible.com/ansible/2.7/modules/file_module.html[19;4H[39m(B[m- name: Cria a directoria tempor√°ria leantime e a directoria de apache leantime[20;6Hfile:[K[21;8Hpath: "{{ item.path }}"[22;8Hstate: directory[23;7H[1K mode: 0755[K[24;4H    owner: www-data[K[25;6H  group: www-data[26;6Hwith_items:[K[27;8H- path: "/tmp/leantime"[28;8H- path: "/var/www/leantime"[29d[K[30d[36m   # Fonte: Ansible for DevOps - Server and configuration management for humans de Jeff Geerling, p√°gina 98[31d[39m(B[m   - name: "Cria a base de dados de mysql para o leantime"[K[32;4H  mysql_db: "db=leantime_database state=present"[K[33d[K[34;4H- name: "Cria o utilizador para a base de dados leantime"[35;6Hmysql_user:[K[36;8Hnam[18Glogin_leantime }}"[2d[?12l[?25h[?25l[6Gmysql_user:[K[3;8Hnam[18Glogin_leantime }}"[4;6H  password: "{{ password_leantime }}"[5;8Hpriv: "leantime_database.*:ALL"[6;8Hhost: localhost[K[7;8Hstate: present[K[8d[K[9;4H- name: "Faz o download do software leantime a partir do reposit√≥rio git"[10;6Hget_url:[K[11;8Hurl: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zip[12;8Hdest: /tmp/leantime[K[13;8Hmode: 0755[K[14d[K[15d[36m   # O ficheiro Leantime-versao.zip necessita de ser descomprimido[16;4H[39m(B[m- name: Descomprime o software leantime[17;6Hunarchive:[18;7H[1K src: "/tmp/leantime/Leantime-{{ versao_leantime }}.zip"[K[19;4H    dest: "/var/www/leantime"[K[20;6H  owner: www-data[21;8Hgroup: www-data[K[22;8Hmode: 0755[K[23;8Hremote_src: true[24d[K[25d[36m   # Ap√≥s a descompress√£o, se o ficheiro configuration.php n√£o existir, este necessita de ser[26d   # criado a partir do ficheiro configuration.sample.php[27d   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html[28;4H[39m(B[m- name: Copia o ficheiro de configura√ß√£o configuration.sample.php[29;6Hansible.builtin.copy:[30;7H[1K src: /var/www/leantime/config/configuration.sample.php[K[31;4H    dest: /var/www/leantime/config/configuration.php[K[32;6H  owner: www-data[K[33;8Hgroup: www-data[34;4H    mode: '0755'[K[35;6H  remote_src: true[36;8Hforce: false[K[2d[?12l[?25h[?25l[6G  remote_src: true[3;8Hforce: false[K[4d[K[5d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[6;4H[39m(B[m- name: Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.[7;6Hansible.builtin.replace:[8;8Hpath: /var/www/leantime/config/configuration.php[9;4H    regexp: "{{ item.regexp  }}"[K[10;6H  replace: "{{ item.line }}"[11;6Hwith_items:[K[12;8H- regexp: 'dbUser=""'[13;8H  line: 'dbUser="{{ login_leantime }}"'[14;8H- regexp: 'dbDatabase=""'[15;9H[1K line: 'dbDatabase="leantime_database"'[K[16;4H    - regexp: 'dbPassword=""'[K[17;6H    line: 'dbPassword="{{ password_leantime }}"'[18d[K[19d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html[20;4H[39m(B[m- name: Copia o template do site para a p√°sta /etc/apache2/sites-available[21;6Hansible.builtin.template:[22;8Hsrc: leantime.template.j2[23;8Hdest: /etc/apache2/sites-available/leantime.conf[24;8Howner: root[25;7H[1K group: www-data[K[26;7H[1K mode: 0755[K[27d[K[28d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html[29;4H[39m(B[m- name: "Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled"[30;6Hansible.builtin.file:[K[31;8Hsrc: /etc/apache2/sites-available/leantime.conf[K[32;8Hdest: /etc/apache2/sites-enabled[33;8Howner: root[K[34;8Hgroup: root[K[35;8Hmode: '0777'[K[36;8Hstate: link[K[2d[?12l[?25h[?25l[8Gmode: '0777'[K[3;8Hstate: link[K[5d[K[6d[K[7d[K[8d[K[9d[K[10d[K[11d[K[12d[K[13d[K[14d[K[15d[K[16d[K[17d[K[19d[K[20d[K[21d[K[22d[K[23d[K[24d[K[25d[K[26d[K[28d[K[29d[K[30d[K[31d[K[32d[K[33d[K[34d[K[35d[K[36d[K[2d[?12l[?25h[?25l[4d[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hgroup: root[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Howner: root[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hdest: /etc/apache2/sites-enabled[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hsrc: /etc/apache2/sites-available/leantime.conf[?12l[?25h[?25l7[2;36r8M[1;39r[2;6Hansible.builtin.file:[?12l[?25h[?25l7[2;36r8M[1;39r[2;4H- name: "Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled"[?12l[?25h[?25l7[2;36r8M[1;39r[2;1H[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html[39m(B[m[?12l[?25h[?25l7[2;36r8M[1;39r[2;1H[?12l[?25h[?25l[3d[?12l[?25h[?25l[4d[?12l[?25h[?25l[5d[?12l[?25h[?25l[5;27H[?12l[?25h[?25l[37d[K[5;26H[?12l[?25h[?25l[6d[?12l[?25h[?25l[6;55H[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[1;127H(B[0;7mModificado(B[m[7;37r[7;1HM[1;39r[6;42H[K[7dleantime.conf[?12l[?25h[?25l[7;37r[37;1H
[1;39r[7;1H[?12l[?25h[?25l[6;42H[?12l[?25h[?25l7[7;37r8[7dM[1;39r[6;42Hleantime.conf[7d[?12l[?25h[?25l[7;37r[37;1H
[1;39r[6;55H[?12l[?25h[?25l[7;40H[?12l[?25h[?25l/[?12l[?25h[?25l7[8;37r8[8dM[1;39r[7;41Hleantime.conf[8d[?12l[?25h[?25l[8;37r[37;1H
[1;39r[7;54H[?12l[?25h[?25l[38;18H         [38;35H(B[0;7mM-D(B[m Formato DOS[19X[38;69H(B[0;7mM-A(B[m Anexar[20X[38;105H(B[0;7mB(B[m Seguran√ßa[K[39;2H(B[0;7mC(B[m Cancelar[18G           [35G(B[0;7mM-M(B[m Formato Mac[19X[39;69H(B[0;7mM-P(B[m Prepor[24X[39;103H(B[0;7m^T(B[m P/ ficheiros[K[37d(B[0;7mNome do ficheiro onde escrever: tasks/tasks.yml                                                                                           [37;1H(B[m[37;48H[?12l[?25h[?25l[37;60H[1K (B[0;7m[ A escrever... ](B[m[K[1;127H(B[0;7m          (B[m[37;58H(B[0;7m[ 167 linhas escritas ](B[m[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar      (B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor[105G(B[0;7mU(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39;2H(B[0;7mX(B[m Sair    [18G(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer      (B[0;7mM-6(B[m Copiar txt[37d[7;54H[?12l[?25h[?25l[37d[J[39d[?12l[?25h[39;1H[?1049l[23;0;0t[?1l>[?2004l]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano tasks/tasks.yml [4Pmolecule converge
[34mINFO    [0m default scenario test matrix: dependency, create, prepare, converge
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mdependency[0m
[31mWARNING [0m Skipping, missing the requirements file.
[31mWARNING [0m Skipping, missing the requirements file.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mcreate[0m
[31mWARNING [0m Skipping, instances already created.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mprepare[0m
[31mWARNING [0m Skipping, instances already prepared.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mconverge[0m

PLAY [Converge] **************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Include leantime_ansible] **********************************************************************************************************

TASK [leantime_ansible : Atualiza a cache (equivalente a apt update)] ********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Atualiza o sistema operativo] ***********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instalar as dependencias necess√°ria ao programa leantime] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instala o servi√ßo apache2 no arranque do sistema] ***************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2] *************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ***************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [leantime_ansible : Cria a directoria tempor√°ria leantime e a directoria de apache leantime] ****************************************
[32mok: [ubuntu-20.04] => (item={'path': '/tmp/leantime'})[0m
[32mok: [ubuntu-20.04] => (item={'path': '/var/www/leantime'})[0m

TASK [leantime_ansible : Cria a base de dados de mysql para o leantime] ******************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria o utilizador para a base de dados leantime] ****************************************************************
[1;35m[WARNING]: Module did not set no_log for update_password[0m
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Faz o download do software leantime a partir do reposit√≥rio git] ************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Descomprime o software leantime] ********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Copia o ficheiro de configura√ß√£o configuration.sample.php] ******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.] ***
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbUser=""', 'line': 'dbUser="leantimeDBadmin"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbDatabase=""', 'line': 'dbDatabase="leantime_database"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbPassword=""', 'line': 'dbPassword="#S3gr3d0S3cr3t0#"'})[0m

TASK [leantime_ansible : Copia o template do site para a p√°sta /etc/apache2/sites-available] *********************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled] ************************
[33mchanged: [ubuntu-20.04][0m

PLAY RECAP *******************************************************************************************************************************
[33mubuntu-20.04[0m               : [32mok=16  [0m [33mchanged=1   [0m unreachable=0    failed=0    skipped=0    rescued=0    ignored=0


]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule converge[K[K[K[K[K[K[K[Kidempotence
[34mINFO    [0m default scenario test matrix: idempotence
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32midempotence[0m

PLAY [Converge] **************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Include leantime_ansible] **********************************************************************************************************

TASK [leantime_ansible : Atualiza a cache (equivalente a apt update)] ********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Atualiza o sistema operativo] ***********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instalar as dependencias necess√°ria ao programa leantime] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instala o servi√ßo apache2 no arranque do sistema] ***************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2] *************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ***************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [leantime_ansible : Cria a directoria tempor√°ria leantime e a directoria de apache leantime] ****************************************
[32mok: [ubuntu-20.04] => (item={'path': '/tmp/leantime'})[0m
[32mok: [ubuntu-20.04] => (item={'path': '/var/www/leantime'})[0m

TASK [leantime_ansible : Cria a base de dados de mysql para o leantime] ******************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria o utilizador para a base de dados leantime] ****************************************************************
[1;35m[WARNING]: Module did not set no_log for update_password[0m
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Faz o download do software leantime a partir do reposit√≥rio git] ************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Descomprime o software leantime] ********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Copia o ficheiro de configura√ß√£o configuration.sample.php] ******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.] ***
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbUser=""', 'line': 'dbUser="leantimeDBadmin"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbDatabase=""', 'line': 'dbDatabase="leantime_database"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbPassword=""', 'line': 'dbPassword="#S3gr3d0S3cr3t0#"'})[0m

TASK [leantime_ansible : Copia o template do site para a p√°sta /etc/apache2/sites-available] *********************************************
[33mchanged: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled] ************************
[33mchanged: [ubuntu-20.04][0m

PLAY RECAP *******************************************************************************************************************************
[33mubuntu-20.04[0m               : [32mok=16  [0m [33mchanged=2   [0m unreachable=0    failed=0    skipped=0    rescued=0    ignored=0


[1;31mCRITICAL[0m Idempotence test failed because of the following tasks:
*  => leantime_ansible : Copia o template do site para a p√°sta [35m/etc/apache2/[0m[95msites-available[0m
*  => leantime_ansible : Cria um link simb√≥lico para o ficheiro leantime.conf na pasta [35m/etc/apache/[0m[95msites-enabled[0m
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano tasks/
[?2004h[?1049h[22;0;0t[1;39r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[37;58H(B[0;1m[37m[41m[ "tasks/" √© uma pasta ][39;49m(B[m[H(B[0;7m  GNU nano 4.8                                                  Novo buffer                                                               [1;137H(B[m[38d(B[0;7m^G(B[m Ajuda[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar[52G(B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor    (B[0;7mM-U(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39d(B[0;7m^X(B[m Sair[39;18H(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer[120G(B[0;7mM-6(B[m Copiar txt[37d[2d[39;49m(B[m[?12l[?25h[?25l[?12l[?25h[?25l[37d[J[39d[?12l[?25h[39;1H[?1049l[23;0;0t[?1l>[?2004l]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano tasks/tasks.yml 
[?2004h[?1049h[22;0;0t[1;39r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[37;64H(B[0;7m[ A ler... ](B[m[37;60H(B[0;7m[ 167 linhas lidas ](B[m[H(B[0;7m  GNU nano 4.8                                                tasks/tasks.yml                                                             [1;137H(B[m[38d(B[0;7m^G(B[m Ajuda[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar[52G(B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor    (B[0;7mM-U(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39d(B[0;7m^X(B[m Sair[39;18H(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer[120G(B[0;7mM-6(B[m Copiar txt[37d[2d[39;49m(B[m---[3d- name: Atualiza a cache (equivalente a apt update)[4;6Hapt:[5dupdate_cache: true[6;8Hcache_valid_time: 3600[8;4H- name: "Atualiza o sistema operativo"[9;6Hapt:[10dupgrade: safe[12;4H- name: "Instalar as dependencias necess√°ria ao programa leantime"[13;6Hapt:[14dpkg:[15;8H- mc[16;8H- screen[17;8H- git[18;8H- apache2[19;8H- mysql-server[20;8H- php[21;8H- php-mysql[22;8H- php-ldap[23;8H- php-cli[24;8H- php-soap[25;8H- php-json[26;8H- graphviz[27;8H- php-xml[28;8H- php-gd[29;8H- php-zip[30;8H- libapache2-mod-php[31;8H- php-dev[32;8H- libmcrypt-dev[33;8H- gcc[34;8H- make[35;8H- autoconf[36;8H- libc-dev[2d[?12l[?25h[?25l[7G[1K - autoconf[3;4H    - libc-dev[K[4;6H  - pkg-config[5;8H- pwgen[K[6;8H- curl[K[7;8H- unzip[8;4H    - zip[K[9;6H  - php-mbstring[10;8H- expect[K[11;8H- net-tools[12;4H    - python3-mysqldb[K[13;6H  - python3-apt[14;8H- python3-pycurl[15d[K[16d[36m   # Fonte de inspira√ß√£o: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html[17;4H[39m(B[m- name: "Instala o servi√ßo apache2 no arranque do sistema"[18;6Hservice:[K[19;8Hname: apache2[K[20;8Hstate: started[21;8Henabled: true[22d[K[23d[36m   # Fonte: https://www.mydailytutorials.com/using-ansible-find-module-search-filesfolder[24;4H[39m(B[m- name: "Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2"[25;6Hfind:[K[26;8Hpaths: /etc[27;8Hpatterns: "php.ini"[28;8Hrecurse: true[29;6Hregister: caminho_php_ini[30d[K[31d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html[32;4H[39m(B[m- name: "Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile."[33;6Hansible.builtin.lineinfile:[34;8Hpath: "{{ caminho_php_ini.files[0].path }}"[35;8Hregexp: "{{ item.regexp  }}"[36;8Hline: "{{ item.line }}"[2d[?12l[?25h[?25l[8Gregexp: "{{ item.regexp  }}"[3;8Hline: "{{ item.line }}"[4;6Hwith_items:[K[5;10Hregexp: "^file_uploads"[6;8H  line: "file_uploads = 1"[7;10Hregexp: "^upload_max_filesize"[8;8H  line: "upload_max_filesize = 1G"[9;10Hregexp: "^max_file_uploads"[10;8H  line: "max_file_uploads = 20"[11;10Hregexp: "^post_max_size"[12;8H  line: "post_max_size = 2G"[13;10Hregexp: "^memory_limit"[14;8H  line: "memory_limit = 2G"[15;8H- regexp: "^max_input_time"[16;9H[1K line: "max_input_time = 3600"[K[17d[K[18d[36m   # Fonte: https://docs.ansible.com/ansible/2.7/modules/file_module.html[19;4H[39m(B[m- name: Cria a directoria tempor√°ria leantime e a directoria de apache leantime[20;6Hfile:[K[21;8Hpath: "{{ item.path }}"[22;8Hstate: directory[23;7H[1K mode: 0755[K[24;4H    owner: www-data[K[25;6H  group: www-data[26;6Hwith_items:[K[27;8H- path: "/tmp/leantime"[28;8H- path: "/var/www/leantime"[29d[K[30d[36m   # Fonte: Ansible for DevOps - Server and configuration management for humans de Jeff Geerling, p√°gina 98[31d[39m(B[m   - name: "Cria a base de dados de mysql para o leantime"[K[32;4H  mysql_db: "db=leantime_database state=present"[K[33d[K[34;4H- name: "Cria o utilizador para a base de dados leantime"[35;6Hmysql_user:[K[36;8Hnam[18Glogin_leantime }}"[2d[?12l[?25h[?25l[6Gmysql_user:[K[3;8Hnam[18Glogin_leantime }}"[4;6H  password: "{{ password_leantime }}"[5;8Hpriv: "leantime_database.*:ALL"[6;8Hhost: localhost[K[7;8Hstate: present[K[8d[K[9;4H- name: "Faz o download do software leantime a partir do reposit√≥rio git"[10;6Hget_url:[K[11;8Hurl: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zip[12;8Hdest: /tmp/leantime[K[13;8Hmode: 0755[K[14d[K[15d[36m   # O ficheiro Leantime-versao.zip necessita de ser descomprimido[16;4H[39m(B[m- name: Descomprime o software leantime[17;6Hunarchive:[18;7H[1K src: "/tmp/leantime/Leantime-{{ versao_leantime }}.zip"[K[19;4H    dest: "/var/www/leantime"[K[20;6H  owner: www-data[21;8Hgroup: www-data[K[22;8Hmode: 0755[K[23;8Hremote_src: true[24d[K[25d[36m   # Ap√≥s a descompress√£o, se o ficheiro configuration.php n√£o existir, este necessita de ser[26d   # criado a partir do ficheiro configuration.sample.php[27d   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html[28;4H[39m(B[m- name: Copia o ficheiro de configura√ß√£o configuration.sample.php[29;6Hansible.builtin.copy:[30;7H[1K src: /var/www/leantime/config/configuration.sample.php[K[31;4H    dest: /var/www/leantime/config/configuration.php[K[32;6H  owner: www-data[K[33;8Hgroup: www-data[34;4H    mode: '0755'[K[35;6H  remote_src: true[36;8Hforce: false[K[2d[?12l[?25h[?25l[6G  remote_src: true[3;8Hforce: false[K[4d[K[5d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[6;4H[39m(B[m- name: Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.[7;6Hansible.builtin.replace:[8;8Hpath: /var/www/leantime/config/configuration.php[9;4H    regexp: "{{ item.regexp  }}"[K[10;6H  replace: "{{ item.line }}"[11;6Hwith_items:[K[12;8H- regexp: 'dbUser=""'[13;8H  line: 'dbUser="{{ login_leantime }}"'[14;8H- regexp: 'dbDatabase=""'[15;9H[1K line: 'dbDatabase="leantime_database"'[K[16;4H    - regexp: 'dbPassword=""'[K[17;6H    line: 'dbPassword="{{ password_leantime }}"'[18d[K[19d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html[20;4H[39m(B[m- name: Copia o template do site para a p√°sta /etc/apache2/sites-available[21;6Hansible.builtin.template:[22;8Hsrc: leantime.template.j2[23;8Hdest: /etc/apache2/sites-available/leantime.conf[24;8Howner: root[25;7H[1K group: www-data[K[26;7H[1K mode: 0755[K[27d[K[28d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html[29;4H[39m(B[m- name: "Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled"[30;6Hansible.builtin.file:[K[31;8Hsrc: /etc/apache2/sites-available/leantime.conf[K[32;8Hdest: /etc/apache2/sites-enabled/leantime.conf[33;8Howner: root[K[34;8Hgroup: root[K[35;8Hmode: '0777'[K[36;8Hstate: link[K[2d[?12l[?25h[?25l[8Gmode: '0777'[K[3;8Hstate: link[K[5d[K[6d[K[7d[K[8d[K[9d[K[10d[K[11d[K[12d[K[13d[K[14d[K[15d[K[16d[K[17d[K[19d[K[20d[K[21d[K[22d[K[23d[K[24d[K[25d[K[26d[K[28d[K[29d[K[30d[K[31d[K[32d[K[33d[K[34d[K[35d[K[36d[K[2d[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hgroup: root[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Howner: root[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hdest: /etc/apache2/sites-enabled/leantime.conf[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hsrc: /etc/apache2/sites-available/leantime.conf[?12l[?25h[?25l7[2;36r8M[1;39r[2;6Hansible.builtin.file:[?12l[?25h[?25l7[2;36r8M[1;39r[2;4H- name: "Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled"[?12l[?25h[?25l7[2;36r8M[1;39r[2;1H[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html[39m(B[m[?12l[?25h[?25l7[2;36r8M[1;39r[2;1H[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hmode: 0755[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hgroup: www-data[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Howner: root[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hdest: /etc/apache2/sites-available/leantime.conf[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hsrc: leantime.template.j2[?12l[?25h[?25l7[2;36r8M[1;39r[2;6Hansible.builtin.template:[?12l[?25h[?25l7[2;36r8M[1;39r[2;4H- name: Copia o template do site para a p√°sta /etc/apache2/sites-available[?12l[?25h[?25l7[2;36r8M[1;39r[2;1H[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html[39m(B[m[?12l[?25h[?25l7[2;36r8M[1;39r[2;1H[?12l[?25h[?25l7[2;36r8M[1;39r[2;10Hline: 'dbPassword="{{ password_leantime }}"'[?12l[?25h[?25l7[2;36r8M[1;39r[2;8H- regexp: 'dbPassword=""'[?12l[?25h[?25l7[2;36r8M[1;39r[2;10Hline: 'dbDatabase="leantime_database"'[?12l[?25h[?25l7[2;37r8M[1;39r[2;8H- regexp: 'dbDatabase=""'[?12l[?25h[?25l7[2;37r8M[1;39r[2;10Hline: 'dbUser="{{ login_leantime }}"'[?12l[?25h[?25l7[2;37r8M[1;39r[2;8H- regexp: 'dbUser=""'[?12l[?25h[?25l7[2;37r8M[1;39r[2;6Hwith_items:[?12l[?25h[?25l7[2;37r8M[1;39r[2;8Hreplace: "{{ item.line }}"[?12l[?25h[?25l7[2;37r8M[1;39r[2;8Hregexp: "{{ item.regexp  }}"[?12l[?25h[?25l7[2;37r8M[1;39r[2;8Hpath: /var/www/leantime/config/configuration.php[?12l[?25h[?25l7[2;37r8M[1;39r[2;6Hansible.builtin.replace:[?12l[?25h[?25l7[2;37r8M[1;39r[2;4H- name: Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[39m(B[m[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[?12l[?25h[?25l7[2;37r8M[1;39r[2;8Hforce: false[?12l[?25h[?25l7[2;37r8M[1;39r[2;8Hremote_src: true[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hmode: '0755'[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hgroup: www-data[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Howner: www-data[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hdest: /var/www/leantime/config/configuration.php[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hsrc: /var/www/leantime/config/configuration.sample.php[?12l[?25h[?25l7[2;36r8M[1;39r[2;6Hansible.builtin.copy:[?12l[?25h[?25l7[2;36r8M[1;39r[2;4H- name: Copia o ficheiro de configura√ß√£o configuration.sample.php[?12l[?25h[?25l7[2;36r8M[1;39r[2;1H[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html[39m(B[m[?12l[?25h[?25l[3d[?12l[?25h[?25l[4d[?12l[?25h[?25l[5d[?12l[?25h[?25l[6d[?12l[?25h[?25l[7d[?12l[?25h[?25l[8d[?12l[?25h[?25l[9d[?12l[?25h[?25l[10d[?12l[?25h[?25l[11d[?12l[?25h[?25l[1;127H(B[0;7mModificado(B[m[11;37r[37;1H
[1;39r[36;4H- name: "Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled"[11d[?12l[?25h[?25l7[11;36r8M[1;39r[11;8Hforce: false[12d[?12l[?25h[?25l[13d[?12l[?25h[?25l[14d[?12l[?25h[?25l[15d[?12l[?25h[?25l[16d[?12l[?25h[?25l[17d[?12l[?25h[?25l[18d[?12l[?25h[?25l[19d[?12l[?25h[?25l[20d[?12l[?25h[?25l[21d[?12l[?25h[?25l[22d[?12l[?25h[?25l[23d[?12l[?25h[?25l[24d[?12l[?25h[?25l[25d[?12l[?25h[?25l[26d[?12l[?25h[?25l[27d[?12l[?25h[?25l[28d[?12l[?25h[?25l[29d[?12l[?25h[?25l[30d[?12l[?25h[?25l[31d[?12l[?25h[?25l[32d[?12l[?25h[?25l[33d[?12l[?25h[?25l[34d[?12l[?25h[?25l[35d[?12l[?25h[?25l[36d[?12l[?25h[?25l7[2;37r8[37d
[1;39r[36;4H- name: "Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled"[?12l[?25h[?25l7[2;37r8[37d
[1;39r[36;6Hansible.builtin.file:[?12l[?25h[?25l7[2;37r8[37d
[1;39r[36;8Hsrc: /etc/apache2/sites-available/leantime.conf[?12l[?25h[?25l7[2;37r8[37d
[1;39r[36;8Hdest: /etc/apache2/sites-enabled/leantime.conf[?12l[?25h[?25l7[2;37r8[37d
[1;39r[36;8Howner: root[?12l[?25h[?25l7[2;37r8[37d
[1;39r[36;8Hgroup: root[?12l[?25h[?25l7[2;37r8[37d
[1;39r[36;8Hmode: '0777'[?12l[?25h[?25l7[2;37r8[37d
[1;39r[36;8Hstate: link[?12l[?25h[?25l7[2;37r8[37d
[1;39r[36;1H[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[25d[?12l[?25h[?25l[26d[?12l[?25h[?25l7[26;37r8M[1;39r[26;8Hforce: false[27d[?12l[?25h[?25l[38;18H         [38;35H(B[0;7mM-D(B[m Formato DOS[19X[38;69H(B[0;7mM-A(B[m Anexar[20X[38;105H(B[0;7mB(B[m Seguran√ßa[K[39;2H(B[0;7mC(B[m Cancelar[18G           [35G(B[0;7mM-M(B[m Formato Mac[19X[39;69H(B[0;7mM-P(B[m Prepor[24X[39;103H(B[0;7m^T(B[m P/ ficheiros[K[37d(B[0;7mNome do ficheiro onde escrever: tasks/tasks.yml                                                                                           [37;1H(B[m[37;48H[?12l[?25h[?25l[37;60H[1K (B[0;7m[ A escrever... ](B[m[K[1;127H(B[0;7m          (B[m[37;58H(B[0;7m[ 168 linhas escritas ](B[m[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar      (B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor[105G(B[0;7mU(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39;2H(B[0;7mX(B[m Sair    [18G(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer      (B[0;7mM-6(B[m Copiar txt[37d[27d[?12l[?25h[?25l[37d[J[39d[?12l[?25h[39;1H[?1049l[23;0;0t[?1l>[?2004l]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano tasks/tasks.yml [Kmolecule idempotence[3Pconverge
[34mINFO    [0m default scenario test matrix: dependency, create, prepare, converge
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mdependency[0m
[31mWARNING [0m Skipping, missing the requirements file.
[31mWARNING [0m Skipping, missing the requirements file.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mcreate[0m
[31mWARNING [0m Skipping, instances already created.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mprepare[0m
[31mWARNING [0m Skipping, instances already prepared.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mconverge[0m

PLAY [Converge] **************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Include leantime_ansible] **********************************************************************************************************

TASK [leantime_ansible : Atualiza a cache (equivalente a apt update)] ********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Atualiza o sistema operativo] ***********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instalar as dependencias necess√°ria ao programa leantime] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instala o servi√ßo apache2 no arranque do sistema] ***************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2] *************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ***************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [leantime_ansible : Cria a directoria tempor√°ria leantime e a directoria de apache leantime] ****************************************
[32mok: [ubuntu-20.04] => (item={'path': '/tmp/leantime'})[0m
[32mok: [ubuntu-20.04] => (item={'path': '/var/www/leantime'})[0m

TASK [leantime_ansible : Cria a base de dados de mysql para o leantime] ******************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria o utilizador para a base de dados leantime] ****************************************************************
[1;35m[WARNING]: Module did not set no_log for update_password[0m
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Faz o download do software leantime a partir do reposit√≥rio git] ************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Descomprime o software leantime] ********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Copia o ficheiro de configura√ß√£o configuration.sample.php] ******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.] ***
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbUser=""', 'line': 'dbUser="leantimeDBadmin"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbDatabase=""', 'line': 'dbDatabase="leantime_database"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbPassword=""', 'line': 'dbPassword="#S3gr3d0S3cr3t0#"'})[0m

TASK [leantime_ansible : Copia o template do site para a p√°sta /etc/apache2/sites-available] *********************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled] ************************
[32mok: [ubuntu-20.04][0m

PLAY RECAP *******************************************************************************************************************************
[32mubuntu-20.04[0m               : [32mok=16  [0m changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0


]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule converge[K[K[K[K[K[K[K[Kidempotence
[34mINFO    [0m default scenario test matrix: idempotence
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32midempotence[0m

PLAY [Converge] **************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Include leantime_ansible] **********************************************************************************************************

TASK [leantime_ansible : Atualiza a cache (equivalente a apt update)] ********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Atualiza o sistema operativo] ***********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instalar as dependencias necess√°ria ao programa leantime] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instala o servi√ßo apache2 no arranque do sistema] ***************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2] *************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ***************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [leantime_ansible : Cria a directoria tempor√°ria leantime e a directoria de apache leantime] ****************************************
[32mok: [ubuntu-20.04] => (item={'path': '/tmp/leantime'})[0m
[32mok: [ubuntu-20.04] => (item={'path': '/var/www/leantime'})[0m

TASK [leantime_ansible : Cria a base de dados de mysql para o leantime] ******************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria o utilizador para a base de dados leantime] ****************************************************************
[1;35m[WARNING]: Module did not set no_log for update_password[0m
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Faz o download do software leantime a partir do reposit√≥rio git] ************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Descomprime o software leantime] ********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Copia o ficheiro de configura√ß√£o configuration.sample.php] ******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.] ***
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbUser=""', 'line': 'dbUser="leantimeDBadmin"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbDatabase=""', 'line': 'dbDatabase="leantime_database"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbPassword=""', 'line': 'dbPassword="#S3gr3d0S3cr3t0#"'})[0m

TASK [leantime_ansible : Copia o template do site para a p√°sta /etc/apache2/sites-available] *********************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled] ************************
[32mok: [ubuntu-20.04][0m

PLAY RECAP *******************************************************************************************************************************
[32mubuntu-20.04[0m               : [32mok=16  [0m changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0


[34mINFO    [0m Idempotence completed successfully.
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule verify
[34mINFO    [0m default scenario test matrix: verify
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mverify[0m
[34mINFO    [0m Running Ansible Verifier

PLAY [Infraestrutura conduzida por testes] ***********************************************************************************************

TASK [Vari√°veis] *************************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Simula√ß√£o: Atualizar a cache do sistema] *******************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [teste: a cache encontra-se actualizada?] *******************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: A cache est√° atualizada"[0m
[32m}[0m

TASK [Atualizar o sistema operativo (equivalente a apt upgrade)] *************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [teste: o sistema operativo encontra-se atualizado?] ********************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O sistema operativo est√° atualizado"[0m
[32m}[0m

TASK [Teste: a cache encontra-se atualizada?] ********************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: A cache est√° atualizada"[0m
[32m}[0m

TASK [Simula√ß√£o: testa se as aplica√ß√µes dependencia do software leantime se encontram instaladas] ****************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: as dependencias encontra-se instaladas?] ************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: As dependencias estavam instaladas"[0m
[32m}[0m

TASK [Simula√ß√£o: Testar se o servi√ßo apache2 se encontra instalado, iniciado e ativo no arranque] ****************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O servi√ßo apache2 encontra-se ativo no arranque no sistema, e est√° iniciado?] ***********************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O servi√ßo apache2 est√° correctamente instalado e inicia com o arranque do sistema"[0m
[32m}[0m

TASK [Rotina Auxiliar> Procura o caminho do ficheiro php.ini do servidor apache2] ********************************************************
[32mok: [ubuntu-20.04][0m

TASK [Simula√ß√£o: Ativa a op√ß√£o file_uploads no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ****************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [Teste: As linhas do php.ini encontram-se alteradas ?] ******************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O ficheiro php.ini foi alterado com sucesso"[0m
[32m}[0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre a pastas /var/www/leantime] **********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: A pasta /var/www/leantime existe e tem as permiss√µes certas?] ***************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: Permiss√µes correctas no site leantime"[0m
[32m}[0m

TASK [Simula√ß√£o: Verifica se √© necess√°rio criar a base de dados leantime_database] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: A base de dados leantime_database existe ?] *********************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: A base de dados leantime_database j√° se encontra criada"[0m
[32m}[0m

TASK [Simula√ß√£o e Teste: Verifica se o endere√ßo git para a vers√£o de leantime existe] ****************************************************
[32mok: [ubuntu-20.04][0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /var/www/leantime/config/configuration.php] *******************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O ficheiro /var/www/leantime/config/configuration.php existe e tem as permiss√µes certas?] ***********************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: Permiss√µes correctas e ficheiro configuration.php existente"[0m
[32m}[0m

TASK [Simula√ß√£o: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace.] ******************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O dbUser foi alterado?] *****************************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"[0m
[32m}[0m

TASK [Simula√ß√£o: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace.] **************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: a vari√°vel dbDatabase foi alterada?] ****************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"[0m
[32m}[0m

TASK [Simula√ß√£o: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace.] **************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O dbPassword foi alterado?] *************************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"[0m
[32m}[0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-available/leantime.conf] *******************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permiss√µes certas?] ***********************************
[31mfatal: [ubuntu-20.04]: FAILED! => {[0m
[31m    "assertion": "ficheiro.stat.mode == \"0755\"",[0m
[31m    "changed": false,[0m
[31m    "evaluated_to": false,[0m
[31m    "msg": "ERRO: Permiss√µes incorrectas"[0m
[31m}[0m

PLAY RECAP *******************************************************************************************************************************
[31mubuntu-20.04[0m               : [32mok=27  [0m changed=0    unreachable=0    [31mfailed=1   [0m skipped=0    rescued=0    ignored=0


[1;31mCRITICAL[0m Ansible return code was [1;36m2[0m, command was: ansible-playbook --inventory [35m/home/admlocal/.cache/molecule/leantime_ansible/default/[0m[95minventory[0m --skip-tags molecule-notest,notest [35m/home/admlocal/leantime_ansible/molecule/default/[0m[95mverify.yml[0m
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule verifyidempotence[3Pconvergenano tasks/tasks.yml 
[?2004h[?1049h[22;0;0t[1;39r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[37;64H(B[0;7m[ A ler... ](B[m[37;60H(B[0;7m[ 168 linhas lidas ](B[m[H(B[0;7m  GNU nano 4.8                                                tasks/tasks.yml                                                             [1;137H(B[m[38d(B[0;7m^G(B[m Ajuda[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar[52G(B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor    (B[0;7mM-U(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39d(B[0;7m^X(B[m Sair[39;18H(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer[120G(B[0;7mM-6(B[m Copiar txt[37d[2d[39;49m(B[m---[3d- name: Atualiza a cache (equivalente a apt update)[4;6Hapt:[5dupdate_cache: true[6;8Hcache_valid_time: 3600[8;4H- name: "Atualiza o sistema operativo"[9;6Hapt:[10dupgrade: safe[12;4H- name: "Instalar as dependencias necess√°ria ao programa leantime"[13;6Hapt:[14dpkg:[15;8H- mc[16;8H- screen[17;8H- git[18;8H- apache2[19;8H- mysql-server[20;8H- php[21;8H- php-mysql[22;8H- php-ldap[23;8H- php-cli[24;8H- php-soap[25;8H- php-json[26;8H- graphviz[27;8H- php-xml[28;8H- php-gd[29;8H- php-zip[30;8H- libapache2-mod-php[31;8H- php-dev[32;8H- libmcrypt-dev[33;8H- gcc[34;8H- make[35;8H- autoconf[36;8H- libc-dev[2d[?12l[?25h[?25l[7G[1K - autoconf[3;4H    - libc-dev[K[4;6H  - pkg-config[5;8H- pwgen[K[6;8H- curl[K[7;8H- unzip[8;4H    - zip[K[9;6H  - php-mbstring[10;8H- expect[K[11;8H- net-tools[12;4H    - python3-mysqldb[K[13;6H  - python3-apt[14;8H- python3-pycurl[15d[K[16d[36m   # Fonte de inspira√ß√£o: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html[17;4H[39m(B[m- name: "Instala o servi√ßo apache2 no arranque do sistema"[18;6Hservice:[K[19;8Hname: apache2[K[20;8Hstate: started[21;8Henabled: true[22d[K[23d[36m   # Fonte: https://www.mydailytutorials.com/using-ansible-find-module-search-filesfolder[24;4H[39m(B[m- name: "Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2"[25;6Hfind:[K[26;8Hpaths: /etc[27;8Hpatterns: "php.ini"[28;8Hrecurse: true[29;6Hregister: caminho_php_ini[30d[K[31d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html[32;4H[39m(B[m- name: "Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile."[33;6Hansible.builtin.lineinfile:[34;8Hpath: "{{ caminho_php_ini.files[0].path }}"[35;8Hregexp: "{{ item.regexp  }}"[36;8Hline: "{{ item.line }}"[2d[?12l[?25h[?25l[8Gregexp: "{{ item.regexp  }}"[3;8Hline: "{{ item.line }}"[4;6Hwith_items:[K[5;10Hregexp: "^file_uploads"[6;8H  line: "file_uploads = 1"[7;10Hregexp: "^upload_max_filesize"[8;8H  line: "upload_max_filesize = 1G"[9;10Hregexp: "^max_file_uploads"[10;8H  line: "max_file_uploads = 20"[11;10Hregexp: "^post_max_size"[12;8H  line: "post_max_size = 2G"[13;10Hregexp: "^memory_limit"[14;8H  line: "memory_limit = 2G"[15;8H- regexp: "^max_input_time"[16;9H[1K line: "max_input_time = 3600"[K[17d[K[18d[36m   # Fonte: https://docs.ansible.com/ansible/2.7/modules/file_module.html[19;4H[39m(B[m- name: Cria a directoria tempor√°ria leantime e a directoria de apache leantime[20;6Hfile:[K[21;8Hpath: "{{ item.path }}"[22;8Hstate: directory[23;7H[1K mode: 0755[K[24;4H    owner: www-data[K[25;6H  group: www-data[26;6Hwith_items:[K[27;8H- path: "/tmp/leantime"[28;8H- path: "/var/www/leantime"[29d[K[30d[36m   # Fonte: Ansible for DevOps - Server and configuration management for humans de Jeff Geerling, p√°gina 98[31d[39m(B[m   - name: "Cria a base de dados de mysql para o leantime"[K[32;4H  mysql_db: "db=leantime_database state=present"[K[33d[K[34;4H- name: "Cria o utilizador para a base de dados leantime"[35;6Hmysql_user:[K[36;8Hnam[18Glogin_leantime }}"[2d[?12l[?25h[?25l[6Gmysql_user:[K[3;8Hnam[18Glogin_leantime }}"[4;6H  password: "{{ password_leantime }}"[5;8Hpriv: "leantime_database.*:ALL"[6;8Hhost: localhost[K[7;8Hstate: present[K[8d[K[9;4H- name: "Faz o download do software leantime a partir do reposit√≥rio git"[10;6Hget_url:[K[11;8Hurl: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zip[12;8Hdest: /tmp/leantime[K[13;8Hmode: 0755[K[14d[K[15d[36m   # O ficheiro Leantime-versao.zip necessita de ser descomprimido[16;4H[39m(B[m- name: Descomprime o software leantime[17;6Hunarchive:[18;7H[1K src: "/tmp/leantime/Leantime-{{ versao_leantime }}.zip"[K[19;4H    dest: "/var/www/leantime"[K[20;6H  owner: www-data[21;8Hgroup: www-data[K[22;8Hmode: 0755[K[23;8Hremote_src: true[24d[K[25d[36m   # Ap√≥s a descompress√£o, se o ficheiro configuration.php n√£o existir, este necessita de ser[26d   # criado a partir do ficheiro configuration.sample.php[27d   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html[28;4H[39m(B[m- name: Copia o ficheiro de configura√ß√£o configuration.sample.php[29;6Hansible.builtin.copy:[30;7H[1K src: /var/www/leantime/config/configuration.sample.php[K[31;4H    dest: /var/www/leantime/config/configuration.php[K[32;6H  owner: www-data[K[33;8Hgroup: www-data[34;4H    mode: '0755'[K[35;6H  remote_src: true[36;8Hforce: false[K[2d[?12l[?25h[?25l[6G  remote_src: true[3;8Hforce: false[K[4d[K[5d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[6;4H[39m(B[m- name: Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.[7;6Hansible.builtin.replace:[8;8Hpath: /var/www/leantime/config/configuration.php[9;4H    regexp: "{{ item.regexp  }}"[K[10;6H  replace: "{{ item.line }}"[11;6Hwith_items:[K[12;8H- regexp: 'dbUser=""'[13;8H  line: 'dbUser="{{ login_leantime }}"'[14;8H- regexp: 'dbDatabase=""'[15;9H[1K line: 'dbDatabase="leantime_database"'[K[16;4H    - regexp: 'dbPassword=""'[K[17;6H    line: 'dbPassword="{{ password_leantime }}"'[18d[K[19d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html[20;4H[39m(B[m- name: Copia o template do site para a p√°sta /etc/apache2/sites-available[21;6Hansible.builtin.template:[22;8Hsrc: leantime.template.j2[23;8Hdest: /etc/apache2/sites-available/leantime.conf[24;8Howner: root[25;7H[1K group: www-data[K[26;7H[1K mode: 0755[K[27;7H[1K force: false[K[28d[K[29d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html[30;4H[39m(B[m- name: "Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled"[31;6Hansible.builtin.file:[K[32;8Hsrc: /etc/apache2/sites-available/leantime.conf[33;8Hdest: /etc/apache2/sites-enabled/leantime.conf[34;8Howner: root[K[35;8Hgroup: root[K[36;8Hmode: '0777'[2d[?12l[?25h[?25l[8Ggroup: root[K[3;8Hmode: '0777'[4;8Hstate: link[5d[K[6d[K[7d[K[8d[K[9d[K[10d[K[11d[K[12d[K[13d[K[14d[K[15d[K[16d[K[17d[K[19d[K[20d[K[21d[K[22d[K[23d[K[24d[K[25d[K[26d[K[27d[K[29d[K[30d[K[31d[K[32d[K[33d[K[34d[K[35d[K[36d[K[2d[?12l[?25h[?25l[5d[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[3;20H[?12l[?25h[?25l[?12l[?25h[?25l[1;127H(B[0;7mModificado(B[m[3;18H'[K[?12l[?25h[?25l'[K[?12l[?25h[?25l5'[?12l[?25h[?25l55'[?12l[?25h[?25l[4d[?12l[?25h[?25l[38;18H         [38;35H(B[0;7mM-D(B[m Formato DOS[19X[38;69H(B[0;7mM-A(B[m Anexar[20X[38;105H(B[0;7mB(B[m Seguran√ßa[K[39;2H(B[0;7mC(B[m Cancelar[18G           [35G(B[0;7mM-M(B[m Formato Mac[19X[39;69H(B[0;7mM-P(B[m Prepor[24X[39;103H(B[0;7m^T(B[m P/ ficheiros[K[37d(B[0;7mNome do ficheiro onde escrever: tasks/tasks.yml                                                                                           [37;1H(B[m[37;48H[?12l[?25h[?25l[37;60H[1K (B[0;7m[ A escrever... ](B[m[K[1;127H(B[0;7m          (B[m[37;58H(B[0;7m[ 168 linhas escritas ](B[m[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar      (B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor[105G(B[0;7mU(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39;2H(B[0;7mX(B[m Sair    [18G(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer      (B[0;7mM-6(B[m Copiar txt[37d[4;19H[?12l[?25h[?25l[37d[J[39d[?12l[?25h[39;1H[?1049l[23;0;0t[?1l>[?2004l]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano tasks/tasks.yml [6Pmolecule verifyidempotence[3Pconverge
[34mINFO    [0m default scenario test matrix: dependency, create, prepare, converge
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mdependency[0m
[31mWARNING [0m Skipping, missing the requirements file.
[31mWARNING [0m Skipping, missing the requirements file.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mcreate[0m
[31mWARNING [0m Skipping, instances already created.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mprepare[0m
[31mWARNING [0m Skipping, instances already prepared.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mconverge[0m

PLAY [Converge] **************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Include leantime_ansible] **********************************************************************************************************

TASK [leantime_ansible : Atualiza a cache (equivalente a apt update)] ********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Atualiza o sistema operativo] ***********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instalar as dependencias necess√°ria ao programa leantime] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instala o servi√ßo apache2 no arranque do sistema] ***************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2] *************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ***************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [leantime_ansible : Cria a directoria tempor√°ria leantime e a directoria de apache leantime] ****************************************
[32mok: [ubuntu-20.04] => (item={'path': '/tmp/leantime'})[0m
[32mok: [ubuntu-20.04] => (item={'path': '/var/www/leantime'})[0m

TASK [leantime_ansible : Cria a base de dados de mysql para o leantime] ******************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria o utilizador para a base de dados leantime] ****************************************************************
[1;35m[WARNING]: Module did not set no_log for update_password[0m
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Faz o download do software leantime a partir do reposit√≥rio git] ************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Descomprime o software leantime] ********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Copia o ficheiro de configura√ß√£o configuration.sample.php] ******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.] ***
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbUser=""', 'line': 'dbUser="leantimeDBadmin"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbDatabase=""', 'line': 'dbDatabase="leantime_database"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbPassword=""', 'line': 'dbPassword="#S3gr3d0S3cr3t0#"'})[0m

TASK [leantime_ansible : Copia o template do site para a p√°sta /etc/apache2/sites-available] *********************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled] ************************
[33mchanged: [ubuntu-20.04][0m

PLAY RECAP *******************************************************************************************************************************
[33mubuntu-20.04[0m               : [32mok=16  [0m [33mchanged=1   [0m unreachable=0    failed=0    skipped=0    rescued=0    ignored=0


]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule converge[K[K[K[K[K[K[K[Kidempotene[K[Kce
Usage: molecule [OPTIONS] COMMAND [ARGS]...
Try "molecule --help" for help.

Error: No such command "idempotece".
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule idempotecence
[34mINFO    [0m default scenario test matrix: idempotence
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32midempotence[0m

PLAY [Converge] **************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Include leantime_ansible] **********************************************************************************************************

TASK [leantime_ansible : Atualiza a cache (equivalente a apt update)] ********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Atualiza o sistema operativo] ***********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instalar as dependencias necess√°ria ao programa leantime] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instala o servi√ßo apache2 no arranque do sistema] ***************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2] *************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ***************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [leantime_ansible : Cria a directoria tempor√°ria leantime e a directoria de apache leantime] ****************************************
[32mok: [ubuntu-20.04] => (item={'path': '/tmp/leantime'})[0m
[32mok: [ubuntu-20.04] => (item={'path': '/var/www/leantime'})[0m

TASK [leantime_ansible : Cria a base de dados de mysql para o leantime] ******************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria o utilizador para a base de dados leantime] ****************************************************************
[1;35m[WARNING]: Module did not set no_log for update_password[0m
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Faz o download do software leantime a partir do reposit√≥rio git] ************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Descomprime o software leantime] ********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Copia o ficheiro de configura√ß√£o configuration.sample.php] ******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.] ***
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbUser=""', 'line': 'dbUser="leantimeDBadmin"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbDatabase=""', 'line': 'dbDatabase="leantime_database"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbPassword=""', 'line': 'dbPassword="#S3gr3d0S3cr3t0#"'})[0m

TASK [leantime_ansible : Copia o template do site para a p√°sta /etc/apache2/sites-available] *********************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled] ************************
[32mok: [ubuntu-20.04][0m

PLAY RECAP *******************************************************************************************************************************
[32mubuntu-20.04[0m               : [32mok=16  [0m changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0


[34mINFO    [0m Idempotence completed successfully.
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule idempotence[K[K[K[K[K[K[K[K[K[K[Kverify
[34mINFO    [0m default scenario test matrix: verify
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mverify[0m
[34mINFO    [0m Running Ansible Verifier

PLAY [Infraestrutura conduzida por testes] ***********************************************************************************************

TASK [Vari√°veis] *************************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Simula√ß√£o: Atualizar a cache do sistema] *******************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [teste: a cache encontra-se actualizada?] *******************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: A cache est√° atualizada"[0m
[32m}[0m

TASK [Atualizar o sistema operativo (equivalente a apt upgrade)] *************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [teste: o sistema operativo encontra-se atualizado?] ********************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O sistema operativo est√° atualizado"[0m
[32m}[0m

TASK [Teste: a cache encontra-se atualizada?] ********************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: A cache est√° atualizada"[0m
[32m}[0m

TASK [Simula√ß√£o: testa se as aplica√ß√µes dependencia do software leantime se encontram instaladas] ****************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: as dependencias encontra-se instaladas?] ************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: As dependencias estavam instaladas"[0m
[32m}[0m

TASK [Simula√ß√£o: Testar se o servi√ßo apache2 se encontra instalado, iniciado e ativo no arranque] ****************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O servi√ßo apache2 encontra-se ativo no arranque no sistema, e est√° iniciado?] ***********************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O servi√ßo apache2 est√° correctamente instalado e inicia com o arranque do sistema"[0m
[32m}[0m

TASK [Rotina Auxiliar> Procura o caminho do ficheiro php.ini do servidor apache2] ********************************************************
[32mok: [ubuntu-20.04][0m

TASK [Simula√ß√£o: Ativa a op√ß√£o file_uploads no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ****************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [Teste: As linhas do php.ini encontram-se alteradas ?] ******************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O ficheiro php.ini foi alterado com sucesso"[0m
[32m}[0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre a pastas /var/www/leantime] **********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: A pasta /var/www/leantime existe e tem as permiss√µes certas?] ***************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: Permiss√µes correctas no site leantime"[0m
[32m}[0m

TASK [Simula√ß√£o: Verifica se √© necess√°rio criar a base de dados leantime_database] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: A base de dados leantime_database existe ?] *********************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: A base de dados leantime_database j√° se encontra criada"[0m
[32m}[0m

TASK [Simula√ß√£o e Teste: Verifica se o endere√ßo git para a vers√£o de leantime existe] ****************************************************
[32mok: [ubuntu-20.04][0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /var/www/leantime/config/configuration.php] *******************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O ficheiro /var/www/leantime/config/configuration.php existe e tem as permiss√µes certas?] ***********************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: Permiss√µes correctas e ficheiro configuration.php existente"[0m
[32m}[0m

TASK [Simula√ß√£o: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace.] ******************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O dbUser foi alterado?] *****************************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"[0m
[32m}[0m

TASK [Simula√ß√£o: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace.] **************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: a vari√°vel dbDatabase foi alterada?] ****************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"[0m
[32m}[0m

TASK [Simula√ß√£o: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace.] **************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O dbPassword foi alterado?] *************************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"[0m
[32m}[0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-available/leantime.conf] *******************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permiss√µes certas?] ***********************************
[31mfatal: [ubuntu-20.04]: FAILED! => {[0m
[31m    "assertion": "ficheiro.stat.gr_name == \"www-data\"",[0m
[31m    "changed": false,[0m
[31m    "evaluated_to": false,[0m
[31m    "msg": "ERRO: Permiss√µes incorrectas"[0m
[31m}[0m

PLAY RECAP *******************************************************************************************************************************
[31mubuntu-20.04[0m               : [32mok=27  [0m changed=0    unreachable=0    [31mfailed=1   [0m skipped=0    rescued=0    ignored=0


[1;31mCRITICAL[0m Ansible return code was [1;36m2[0m, command was: ansible-playbook --inventory [35m/home/admlocal/.cache/molecule/leantime_ansible/default/[0m[95minventory[0m --skip-tags molecule-notest,notest [35m/home/admlocal/leantime_ansible/molecule/default/[0m[95mverify.yml[0m
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano molecule/default/verify.yml 
[?2004h[?1049h[22;0;0t[1;39r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[37;64H(B[0;7m[ A ler... ](B[m[37;60H(B[0;7m[ 302 linhas lidas ](B[m[H(B[0;7m  GNU nano 4.8                                          molecule/default/verify.yml                                                       [1;137H(B[m[38d(B[0;7m^G(B[m Ajuda[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar[52G(B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor    (B[0;7mM-U(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39d(B[0;7m^X(B[m Sair[39;18H(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer[120G(B[0;7mM-6(B[m Copiar txt[37d[2d[39;49m(B[m---[3d[36m# Tutorial de inspira√ß√£o para a infraestrutura conduzida por teste no site[4d# https://www.adictosaltrabajo.com/2020/05/08/ansible-testing-using-molecule-with-ansible-as-verifier/[6d[39m(B[m- name: "Infraestrutura conduzida por testes"[7;3Hhosts: all[8;3Hgather_facts: false[9;3Hbecome: true[11;3Htasks:[12;3H- name: Vari√°veis[13;5Hinclude_vars:[14;7Hfile: ../../vars/main.yml[16;3H- name: "Simula√ß√£o: Atualizar a cache do sistema"[17;5Hapt:[18dupdate_cache: true[19;7Hcache_valid_time: 3600[20;5Hcheck_mode: true[21;5Hregister: estado[23;3H- name: "teste: a cache encontra-se actualizada?"[24;5Hassert:[25;7Hthat:[26;7H- not estado.changed[27;7Hsuccess_msg: "SUCESSO: A cache est√° atualizada"[28;7Hfail_msg: "ERRO: Existem actualiza√ß√µes pendentes"[30;3H- name: "Atualizar o sistema operativo (equivalente a apt upgrade)"[31;5Hapt:[32dupgrade: safe[33;5Hcheck_mode: true[34;5Hregister: estado[36;3H- name: "teste: o sistema operativo encontra-se atualizado?"[2d[?12l[?25h[?25l[K[3d  - name: "teste: o sistema operativo encontra-se atualizado?"[K[4d    assert:[K[5;7Hthat:[6;6H[1K - not estado.changed[K[7;3H    success_msg: "SUCESSO: O sistema operativo est√° atualizado"[8;3H    fail_msg: "ERRO: Existem actualiza√ß√µes pendentes"[9d[K[10d  - name: "Teste: a cache encontra-se atualizada?"[11;3H  assert:[12;3H    that:[K[13;5H  - not estado.changed[14;7Hsuccess_msg: "SUCESSO: A cache est√° atualizada"[15;7Hfail_msg: "ERRO: Existem atualiza√ß√µes pendentes"[16d[K[17d  - name: "Simula√ß√£o: testa se as aplica√ß√µes dependencia do software leantime se encontram instaladas"[18;5Hapt:[K[19dpkg:[K[20;5H  - mc[K[21;5H  - screen[K[22;7H- git[23;3H    - apache2[K[24;5H  - mysql-server[25;7H- php[26;9Hphp-mysql[K[27;7H- php-ldap[K[28;7H- php-cli[K[29;7H- php-soap[30;3H    - php-json[K[31;5H  - graphviz[32;7H- php-xml[K[33;5H  - php-gd[K[34;5H  - php-zip[K[35;7H- libapache2-mod-php[36;3H    - php-dev[K[2d[?12l[?25h[?25l[7G- libapache2-mod-php[3;3H    - php-dev[K[4;5H  - libmcrypt-dev[5;7H- gcc[6;9Hmake[K[7;7H- autoconf[K[8;7H- libc-dev[K[9;7H- pkg-config[10;3H    - pwgen[K[11;5H  - curl[12;7H- unzip[13;9Hzip[K[14;7H- php-mbstring[K[15;7H- expect[K[16;7H- net-tools[17;3H    - python3-mysqldb[K[18;5H  - python3-apt[19;7H- python3-pycurl[20;5Hcheck_mode: true[21;5Hregister: estado[22d[K[23d  - name: "Teste: as dependencias encontra-se instaladas?"[24;5Hassert:[K[25;7Hthat:[26;9Hnot estado.changed[27;7Hsuccess_msg: "SUCESSO: As dependencias estavam instaladas"[28;7Hfail_msg: "ERRO: Faltam instalar algumas dependencias. O software pode estar parcialmente instalado"[29d[K[30d[36m  # Fonte de inspira√ß√£o: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html[31;3H[39m(B[m- name: "Simula√ß√£o: Testar se o servi√ßo apache2 se encontra instalado, iniciado e ativo no arranque"[32;5Hservice:[K[33;7Hname: apache2[34;7Hstate: started[35;7Henabled: true[K[36;5Hcheck_mode: true[2d[?12l[?25h[?25l[2;36r[36;1H[17S[1;39r[2;7Henabled: true[K[6dO servi√ßo apache2 encontra-se ativo no arranque no sistema, e est√° iniciado?"[10;30HO servi√ßo apache2 est√° correctamente instalado e inicia com o arranque do sistema"[11;24HO servi√ßo apache2 n√£o se encontra correcta[25P[13;10H[36m: https://www.mydailytutorials.com/using-[58G-find-module-search-filesfolder[39m(B[m[K[14;12HRotina Auxiliar> Procura o caminho do ficheiro php.ini do servidor apache2"[K[15;5Hfind:[K[16;7Hpaths: /etc[K[17;7Hpatterns: "php.ini"[18;7Hrecurse[19;5Hregister: caminho_php_ini[21d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html[22;3H[39m(B[m- name: "Simula√ß√£o: Ativa a op√ß√£o file_uploads no ficheiro php.ini, utilizando o m√≥dulo lineinfile."[23;5Hansible.builtin.lineinfile:[24;7Hpath: "{{ caminho_php_ini.files[0].path }}"[25;7Hregexp: "{{ item.regexp  }}"[26;7Hline: "{{ item.line }}"[27;5Hwith_items:[28;7H- regexp: "^file_uploads"[29;9Hline: "file_uploads = 1"[30;7H- regexp: "^upload_max_filesize"[31;9Hline: "upload_max_filesize = 1G"[32;7H- regexp: "^max_file_uploads"[33;9Hline: "max_file_uploads = 20"[34;7H- regexp: "^post_max_size"[35;9Hline: "post_max_size = 2G"[36;7H- regexp: "^memory_limit"[2d[?12l[?25h[?25l7[2;17r8[4T[1;39r[2;9Hline: "post_max_size = 2G"[3;7H- regexp: "^memory_limit"[4;9Hline: "memory_limit = 2G"[5;7H- regexp: "^max_input_time"[6;7H  line: "max_input_time = 3600"[10;19HAs linhas do php.ini encontram-se alteradas ?"[K[14;32Hficheiro php.ini foi alterado com sucesso"[K[15;24HAlgumas altera√ß√µes ao ficheiro php.ini n√£o tiveram sucesso"[17;5H[36mO site deve existir na pasta /var/www/leantime. Este teste visa determinar se a pasta[18d  # existe e se temas permiss√µes certas[19d  # Fonte de inspira√ß√£o: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[20;3H[39m(B[m- name: "Simula√ß√£o: Obtem informa√ß√£o sobre a pastas /var/www/leantime"[21d    stat:[K[22;3H    path: "/var/www/leantime"[K[23;5Hregister: pasta[K[24d[K[25d  - name: "Teste: A pasta /var/www/leantime existe e tem as permiss√µes certas?"[26;5Hassert:[K[27;5H  that:[K[28;7H  - pasta.stat.exists[K[29;9H- pasta.stat.isdir[K[30;7H  - pasta.stat.mode == "0755"[K[31;9H- pasta.stat.pw_name == "www-data"[32;7H  - pasta.stat.gr_name == "www-data"[33;7Hsuccess_msg: "SUCESSO: Permiss√µes correctas no site leantime"[34;7Hfail_msg: "ERRO: Permiss√µes incorrectas no site leantime ou site n√£o existente"[35d[K[36d[36m  # Outro dos requesitos √© a exist√™ncia de uma base de dados para o site.[2d[39m(B[m[?12l[?25h[?25l[14;36r[14;1H[8T[1;39r[2;1H[K[3d[36m  # Outro dos requesitos √© a exist√™ncia de uma base de dados para o site.[4d  # Esta base de dados deve ser criada, logo tem de ser testada para determinar se ela existe ou n√£o.[5d  # Fonte de inspira√ß√£o: https://serverfault.com/questions/173978/from-a-shell-script-how-can-i-check-whether-a-mysql-database-exists[6;3H[39m(B[m- name: "Simula√ß√£o: Verifica se √© necess√°rio criar a base de dados leantime_database"[7;5Hshell: "mysql -u root -e 'use leantime_database'"[8;15Hresult[9;5Hfailed_when: false[10;3H  changed_when: false[K[11d[K[12d  - name: "Teste: A base de dados leantime_database existe ?"[13;5Hassert:[K[14;7Hthat:[15;7H- result.rc == 0[16;7Hsuccess_msg: "SUCESSO: A base de dados leantime_database j√° se encontra criada"[17;7Hfail_msg: "ERRO: N√£o existe a base de dados leantime_database"[19d[36m  # Teste: O download do software leantime deve ser poss√≠vel, a partir do site do leantime[20;3H[39m(B[m- name: "Simula√ß√£o e Teste: Verifica se o endere√ßo git para a vers√£o de leantime existe"[21;5Huri:[22durl: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zip[23;5Hregister: resultado[K[25;5H[36mTeste: D[25;25Ho ficheiro configuration.php no site do leantime. A exist√™ncia deste ficheiro[26;5H       com as permiss√µes certas indica que o processo de unzip correu bem[27;5HDocumenta√ß√£o oficial em: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[28;46H[39m(B[mo ficheiro /var/www/leantime/config/configuration.php"[30;31H/config/configuration.php"[31;15Hficheiro[33;19HO ficheiro /var/www/leantime/config/configuration.php existe e tem as permiss√µes certas?"[36;11Hficheiro.stat.exists[2d[?12l[?25h[?25l[7Gthat:[3;8H[1K - ficheiro.stat.exists[K[4;8H[1K - ficheiro.stat.isreg[K[5;8H[1K - ficheiro.stat.mode == "0755"[K[6;8H[1K - ficheiro.stat.pw_name == "www-data"[K[7;5H    - ficheiro.stat.gr_name == "www-data"[K[8;5H  success_msg: "SUCESSO: Permiss√µes correctas e ficheiro configuration.php existente"[9;5H  fail_msg: "ERRO: Permiss√µes incorrectas ou ficheiro configuration.php n√£o existente"[10d[K[11d[36m  # Teste: O ficheiro /var/www/leantime/config/configuration.php necessita de ser alterado.[12d  # As vari√°veis dbuser, dbDatabase, e dbPassword necessitam de estar configuradas.[13d  # Por simula√ß√£o o sistema vai determinar se estas est√£o configuradas com o valor esperado.[14d  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[15;3H[39m(B[m- name: "Simula√ß√£o: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace."[16;5Hansible.builtin.replace:[K[17;7Hpath: /var/www/leantime/config/configuration.php[K[18;7Hregexp: 'dbUser=""'[19;6H[1K replace: 'dbUser="{{ login_leantime }}"'[K[20;3H  check_mode: yes[K[21;5Hregister: conf[22;5Hfailed_when: false[K[23d[K[24d  - name: "Teste: O dbUser foi alterado?"[25d    assert:[K[26;6H[1K that:[K[27;6H[1K - conf is not changed[K[28;3H    - conf is not failed[K[29;5H  success_msg: "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"[30;7Hfail_msg: "ERRO: O dbUser n√£o foi alterado no ficheiro configuration.php"[31d[K[33d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[39m(B[m[K[34;3H- name: "Simula√ß√£o: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace."[35;5Hansible.builtin.replace:[36;7Hpath: /var/www/leantime/config/configuration.php[2d[?12l[?25h[?25l    ansible.builtin.replace:[3;7Hpath: /var/www/leantime/config/configuration.php[4;7Hregexp: 'dbDatabase=""'[5;7Hreplace: 'dbDatabase="leantime_database"'[6;5Hcheck_mode: yes[K[7;5Hregister: conf[K[8;5Hfailed_when: false[K[9d[K[10d  - name: "Teste: a vari√°vel dbDatabase foi alterada?"[11d    assert:[K[12;6H[1K that:[K[13;6H[1K - conf is not changed[K[14;6H[1K - conf is not failed[K[15;3H    success_msg: "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"[K[16;5H  fail_msg: "ERRO: O dbDatabase n√£o foi alterado no ficheiro configuration.php"[17d[K[18d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[19;3H[39m(B[m- name: "Simula√ß√£o: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace."[20;5Hansible.builtin.replace:[21;5H  path: /var/www/leantime/config/configuration.php[22;5H  regexp: 'dbPassword=""'[23;7Hreplace: 'dbPassword="{{ password_leantime }}"'[24;3H  check_mode: yes[K[25;5Hregister: conf[26;5Hfailed_when: false[27d[K[28d  - name: "Teste: O dbPassword foi alterado?"[29;5Hassert:[K[30;7Hthat:[K[31;7H- conf is not changed[32;7H- conf is not failed[33;6H[1K success_msg: "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"[K[34;3H    fail_msg: "ERRO: O dbPassword n√£o foi alterado no ficheiro configuration.php"[K[35d[K[36d[36m  # A configura√ß√£o do site leantime necessita que seja criado um site atrav√©s de um ficheiro de[2d[39m(B[m[?12l[?25h[?25l[K[3d[36m  # A configura√ß√£o do site leantime necessita que seja criado um site atrav√©s de um ficheiro de[4d  # configura√ß√£o, dentro das pasta do apache2. Deve existir um ficheiro de configura√ß√£o do[5d  # leantime em (/etc/apache2/sites-available[39m(B[m[K[6d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[7;3H[39m(B[m- name: "Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-available/leantime.conf"[8;5Hstat:[K[9;7Hpath: "/etc/apache2/sites-available/leantime.conf"[10;3H  register: ficheiro[K[11d[K[12d  - name: "Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permiss√µes certas?"[13;5Hassert:[K[14;7Hthat:[K[15;7H  - ficheiro.stat.exists[K[16;7H  - ficheiro.stat.isreg[K[17;9H- ficheiro.stat.mode == "0755"[18;8H[1K - ficheiro.stat.pw_name == "root"[K[19;8H[1K - ficheiro.stat.gr_name == "www-data"[K[20;5H  success_msg: "SUCESSO: Permiss√µes correctas"[21;7Hfail_msg: "ERRO: Permiss√µes incorrectas"[K[22d[K[23d[36m  # O site deve estar ativo no apache. Este teste vai verificar se o site se encontra ativo[24d  # https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[25;3H[39m(B[m- name: "Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf"[26;5Hstat:[K[27;7Hpath: "/etc/apache2/sites-enabled/leantime.conf"[28;3H  register: ficheiro[K[29d[K[30d  - name: "Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permiss√µes certas?"[31;5Hassert:[K[32;7Hthat:[K[33;7H  - ficheiro.stat.exists[K[34;7H  - ficheiro.stat.islnk[K[35;9H- ficheiro.stat.mode == "0777"[36;8H[1K - ficheiro.stat.pw_name == "root"[K[2d[?12l[?25h[?25l[2;36r[36;1H[15S[1;39r[2;36H77[4droot"[K[8d[K[9d[K[10d[K[11d[K[12d[K[13d[K[15d[K[16d[K[17d[K[18d[K[19d[K[20d[K[21d[K[2d[?12l[?25h[?25l[7d[?12l[?25h[?25l[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l7[2;36r8M[1;39r[2;9H- ficheiro.stat.islnk[?12l[?25h[?25l7[2;36r8M[1;39r[2;9H- ficheiro.stat.exists[?12l[?25h[?25l7[2;36r8M[1;39r[2;7Hthat:[?12l[?25h[?25l7[2;36r8M[1;39r[2;5Hassert:[?12l[?25h[?25l7[2;36r8M[1;39r[2;3H- name: "Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permiss√µes certas?"[?12l[?25h[?25l7[2;36r8M[1;39r[2;1H[?12l[?25h[?25l[37d[J[39d[?12l[?25h[39;1H[?1049l[23;0;0t[?1l>[?2004l]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano molecule/default/verify.yml 
[?2004h[?1049h[22;0;0t[1;39r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[37;64H(B[0;7m[ A ler... ](B[m[37;60H(B[0;7m[ 302 linhas lidas ](B[m[H(B[0;7m  GNU nano 4.8                                          molecule/default/verify.yml                                                       [1;137H(B[m[38d(B[0;7m^G(B[m Ajuda[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar[52G(B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor    (B[0;7mM-U(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39d(B[0;7m^X(B[m Sair[39;18H(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer[120G(B[0;7mM-6(B[m Copiar txt[37d[2d[39;49m(B[m---[3d[36m# Tutorial de inspira√ß√£o para a infraestrutura conduzida por teste no site[4d# https://www.adictosaltrabajo.com/2020/05/08/ansible-testing-using-molecule-with-ansible-as-verifier/[6d[39m(B[m- name: "Infraestrutura conduzida por testes"[7;3Hhosts: all[8;3Hgather_facts: false[9;3Hbecome: true[11;3Htasks:[12;3H- name: Vari√°veis[13;5Hinclude_vars:[14;7Hfile: ../../vars/main.yml[16;3H- name: "Simula√ß√£o: Atualizar a cache do sistema"[17;5Hapt:[18dupdate_cache: true[19;7Hcache_valid_time: 3600[20;5Hcheck_mode: true[21;5Hregister: estado[23;3H- name: "teste: a cache encontra-se actualizada?"[24;5Hassert:[25;7Hthat:[26;7H- not estado.changed[27;7Hsuccess_msg: "SUCESSO: A cache est√° atualizada"[28;7Hfail_msg: "ERRO: Existem actualiza√ß√µes pendentes"[30;3H- name: "Atualizar o sistema operativo (equivalente a apt upgrade)"[31;5Hapt:[32dupgrade: safe[33;5Hcheck_mode: true[34;5Hregister: estado[36;3H- name: "teste: o sistema operativo encontra-se atualizado?"[2d[?12l[?25h[?25l[K[3d  - name: "teste: o sistema operativo encontra-se atualizado?"[K[4d    assert:[K[5;7Hthat:[6;6H[1K - not estado.changed[K[7;3H    success_msg: "SUCESSO: O sistema operativo est√° atualizado"[8;3H    fail_msg: "ERRO: Existem actualiza√ß√µes pendentes"[9d[K[10d  - name: "Teste: a cache encontra-se atualizada?"[11;3H  assert:[12;3H    that:[K[13;5H  - not estado.changed[14;7Hsuccess_msg: "SUCESSO: A cache est√° atualizada"[15;7Hfail_msg: "ERRO: Existem atualiza√ß√µes pendentes"[16d[K[17d  - name: "Simula√ß√£o: testa se as aplica√ß√µes dependencia do software leantime se encontram instaladas"[18;5Hapt:[K[19dpkg:[K[20;5H  - mc[K[21;5H  - screen[K[22;7H- git[23;3H    - apache2[K[24;5H  - mysql-server[25;7H- php[26;9Hphp-mysql[K[27;7H- php-ldap[K[28;7H- php-cli[K[29;7H- php-soap[30;3H    - php-json[K[31;5H  - graphviz[32;7H- php-xml[K[33;5H  - php-gd[K[34;5H  - php-zip[K[35;7H- libapache2-mod-php[36;3H    - php-dev[K[2d[?12l[?25h[?25l[7G- libapache2-mod-php[3;3H    - php-dev[K[4;5H  - libmcrypt-dev[5;7H- gcc[6;9Hmake[K[7;7H- autoconf[K[8;7H- libc-dev[K[9;7H- pkg-config[10;3H    - pwgen[K[11;5H  - curl[12;7H- unzip[13;9Hzip[K[14;7H- php-mbstring[K[15;7H- expect[K[16;7H- net-tools[17;3H    - python3-mysqldb[K[18;5H  - python3-apt[19;7H- python3-pycurl[20;5Hcheck_mode: true[21;5Hregister: estado[22d[K[23d  - name: "Teste: as dependencias encontra-se instaladas?"[24;5Hassert:[K[25;7Hthat:[26;9Hnot estado.changed[27;7Hsuccess_msg: "SUCESSO: As dependencias estavam instaladas"[28;7Hfail_msg: "ERRO: Faltam instalar algumas dependencias. O software pode estar parcialmente instalado"[29d[K[30d[36m  # Fonte de inspira√ß√£o: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html[31;3H[39m(B[m- name: "Simula√ß√£o: Testar se o servi√ßo apache2 se encontra instalado, iniciado e ativo no arranque"[32;5Hservice:[K[33;7Hname: apache2[34;7Hstate: started[35;7Henabled: true[K[36;5Hcheck_mode: true[2d[?12l[?25h[?25l[2;36r[36;1H[17S[1;39r[2;7Henabled: true[K[6dO servi√ßo apache2 encontra-se ativo no arranque no sistema, e est√° iniciado?"[10;30HO servi√ßo apache2 est√° correctamente instalado e inicia com o arranque do sistema"[11;24HO servi√ßo apache2 n√£o se encontra correcta[25P[13;10H[36m: https://www.mydailytutorials.com/using-[58G-find-module-search-filesfolder[39m(B[m[K[14;12HRotina Auxiliar> Procura o caminho do ficheiro php.ini do servidor apache2"[K[15;5Hfind:[K[16;7Hpaths: /etc[K[17;7Hpatterns: "php.ini"[18;7Hrecurse[19;5Hregister: caminho_php_ini[21d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html[22;3H[39m(B[m- name: "Simula√ß√£o: Ativa a op√ß√£o file_uploads no ficheiro php.ini, utilizando o m√≥dulo lineinfile."[23;5Hansible.builtin.lineinfile:[24;7Hpath: "{{ caminho_php_ini.files[0].path }}"[25;7Hregexp: "{{ item.regexp  }}"[26;7Hline: "{{ item.line }}"[27;5Hwith_items:[28;7H- regexp: "^file_uploads"[29;9Hline: "file_uploads = 1"[30;7H- regexp: "^upload_max_filesize"[31;9Hline: "upload_max_filesize = 1G"[32;7H- regexp: "^max_file_uploads"[33;9Hline: "max_file_uploads = 20"[34;7H- regexp: "^post_max_size"[35;9Hline: "post_max_size = 2G"[36;7H- regexp: "^memory_limit"[2d[?12l[?25h[?25l7[2;17r8[4T[1;39r[2;9Hline: "post_max_size = 2G"[3;7H- regexp: "^memory_limit"[4;9Hline: "memory_limit = 2G"[5;7H- regexp: "^max_input_time"[6;7H  line: "max_input_time = 3600"[10;19HAs linhas do php.ini encontram-se alteradas ?"[K[14;32Hficheiro php.ini foi alterado com sucesso"[K[15;24HAlgumas altera√ß√µes ao ficheiro php.ini n√£o tiveram sucesso"[17;5H[36mO site deve existir na pasta /var/www/leantime. Este teste visa determinar se a pasta[18d  # existe e se temas permiss√µes certas[19d  # Fonte de inspira√ß√£o: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[20;3H[39m(B[m- name: "Simula√ß√£o: Obtem informa√ß√£o sobre a pastas /var/www/leantime"[21d    stat:[K[22;3H    path: "/var/www/leantime"[K[23;5Hregister: pasta[K[24d[K[25d  - name: "Teste: A pasta /var/www/leantime existe e tem as permiss√µes certas?"[26;5Hassert:[K[27;5H  that:[K[28;7H  - pasta.stat.exists[K[29;9H- pasta.stat.isdir[K[30;7H  - pasta.stat.mode == "0755"[K[31;9H- pasta.stat.pw_name == "www-data"[32;7H  - pasta.stat.gr_name == "www-data"[33;7Hsuccess_msg: "SUCESSO: Permiss√µes correctas no site leantime"[34;7Hfail_msg: "ERRO: Permiss√µes incorrectas no site leantime ou site n√£o existente"[35d[K[36d[36m  # Outro dos requesitos √© a exist√™ncia de uma base de dados para o site.[2d[39m(B[m[?12l[?25h[?25l[14;36r[14;1H[8T[1;39r[2;1H[K[3d[36m  # Outro dos requesitos √© a exist√™ncia de uma base de dados para o site.[4d  # Esta base de dados deve ser criada, logo tem de ser testada para determinar se ela existe ou n√£o.[5d  # Fonte de inspira√ß√£o: https://serverfault.com/questions/173978/from-a-shell-script-how-can-i-check-whether-a-mysql-database-exists[6;3H[39m(B[m- name: "Simula√ß√£o: Verifica se √© necess√°rio criar a base de dados leantime_database"[7;5Hshell: "mysql -u root -e 'use leantime_database'"[8;15Hresult[9;5Hfailed_when: false[10;3H  changed_when: false[K[11d[K[12d  - name: "Teste: A base de dados leantime_database existe ?"[13;5Hassert:[K[14;7Hthat:[15;7H- result.rc == 0[16;7Hsuccess_msg: "SUCESSO: A base de dados leantime_database j√° se encontra criada"[17;7Hfail_msg: "ERRO: N√£o existe a base de dados leantime_database"[19d[36m  # Teste: O download do software leantime deve ser poss√≠vel, a partir do site do leantime[20;3H[39m(B[m- name: "Simula√ß√£o e Teste: Verifica se o endere√ßo git para a vers√£o de leantime existe"[21;5Huri:[22durl: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zip[23;5Hregister: resultado[K[25;5H[36mTeste: D[25;25Ho ficheiro configuration.php no site do leantime. A exist√™ncia deste ficheiro[26;5H       com as permiss√µes certas indica que o processo de unzip correu bem[27;5HDocumenta√ß√£o oficial em: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[28;46H[39m(B[mo ficheiro /var/www/leantime/config/configuration.php"[30;31H/config/configuration.php"[31;15Hficheiro[33;19HO ficheiro /var/www/leantime/config/configuration.php existe e tem as permiss√µes certas?"[36;11Hficheiro.stat.exists[2d[?12l[?25h[?25l[7Gthat:[3;8H[1K - ficheiro.stat.exists[K[4;8H[1K - ficheiro.stat.isreg[K[5;8H[1K - ficheiro.stat.mode == "0755"[K[6;8H[1K - ficheiro.stat.pw_name == "www-data"[K[7;5H    - ficheiro.stat.gr_name == "www-data"[K[8;5H  success_msg: "SUCESSO: Permiss√µes correctas e ficheiro configuration.php existente"[9;5H  fail_msg: "ERRO: Permiss√µes incorrectas ou ficheiro configuration.php n√£o existente"[10d[K[11d[36m  # Teste: O ficheiro /var/www/leantime/config/configuration.php necessita de ser alterado.[12d  # As vari√°veis dbuser, dbDatabase, e dbPassword necessitam de estar configuradas.[13d  # Por simula√ß√£o o sistema vai determinar se estas est√£o configuradas com o valor esperado.[14d  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[15;3H[39m(B[m- name: "Simula√ß√£o: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace."[16;5Hansible.builtin.replace:[K[17;7Hpath: /var/www/leantime/config/configuration.php[K[18;7Hregexp: 'dbUser=""'[19;6H[1K replace: 'dbUser="{{ login_leantime }}"'[K[20;3H  check_mode: yes[K[21;5Hregister: conf[22;5Hfailed_when: false[K[23d[K[24d  - name: "Teste: O dbUser foi alterado?"[25d    assert:[K[26;6H[1K that:[K[27;6H[1K - conf is not changed[K[28;3H    - conf is not failed[K[29;5H  success_msg: "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"[30;7Hfail_msg: "ERRO: O dbUser n√£o foi alterado no ficheiro configuration.php"[31d[K[33d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[39m(B[m[K[34;3H- name: "Simula√ß√£o: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace."[35;5Hansible.builtin.replace:[36;7Hpath: /var/www/leantime/config/configuration.php[2d[?12l[?25h[?25l    ansible.builtin.replace:[3;7Hpath: /var/www/leantime/config/configuration.php[4;7Hregexp: 'dbDatabase=""'[5;7Hreplace: 'dbDatabase="leantime_database"'[6;5Hcheck_mode: yes[K[7;5Hregister: conf[K[8;5Hfailed_when: false[K[9d[K[10d  - name: "Teste: a vari√°vel dbDatabase foi alterada?"[11d    assert:[K[12;6H[1K that:[K[13;6H[1K - conf is not changed[K[14;6H[1K - conf is not failed[K[15;3H    success_msg: "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"[K[16;5H  fail_msg: "ERRO: O dbDatabase n√£o foi alterado no ficheiro configuration.php"[17d[K[18d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[19;3H[39m(B[m- name: "Simula√ß√£o: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace."[20;5Hansible.builtin.replace:[21;5H  path: /var/www/leantime/config/configuration.php[22;5H  regexp: 'dbPassword=""'[23;7Hreplace: 'dbPassword="{{ password_leantime }}"'[24;3H  check_mode: yes[K[25;5Hregister: conf[26;5Hfailed_when: false[27d[K[28d  - name: "Teste: O dbPassword foi alterado?"[29;5Hassert:[K[30;7Hthat:[K[31;7H- conf is not changed[32;7H- conf is not failed[33;6H[1K success_msg: "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"[K[34;3H    fail_msg: "ERRO: O dbPassword n√£o foi alterado no ficheiro configuration.php"[K[35d[K[36d[36m  # A configura√ß√£o do site leantime necessita que seja criado um site atrav√©s de um ficheiro de[2d[39m(B[m[?12l[?25h[?25l[K[3d[36m  # A configura√ß√£o do site leantime necessita que seja criado um site atrav√©s de um ficheiro de[4d  # configura√ß√£o, dentro das pasta do apache2. Deve existir um ficheiro de configura√ß√£o do[5d  # leantime em (/etc/apache2/sites-available[39m(B[m[K[6d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[7;3H[39m(B[m- name: "Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-available/leantime.conf"[8;5Hstat:[K[9;7Hpath: "/etc/apache2/sites-available/leantime.conf"[10;3H  register: ficheiro[K[11d[K[12d  - name: "Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permiss√µes certas?"[13;5Hassert:[K[14;7Hthat:[K[15;7H  - ficheiro.stat.exists[K[16;7H  - ficheiro.stat.isreg[K[17;9H- ficheiro.stat.mode == "0755"[18;8H[1K - ficheiro.stat.pw_name == "root"[K[19;8H[1K - ficheiro.stat.gr_name == "www-data"[K[20;5H  success_msg: "SUCESSO: Permiss√µes correctas"[21;7Hfail_msg: "ERRO: Permiss√µes incorrectas"[K[22d[K[23d[36m  # O site deve estar ativo no apache. Este teste vai verificar se o site se encontra ativo[24d  # https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[25;3H[39m(B[m- name: "Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf"[26;5Hstat:[K[27;7Hpath: "/etc/apache2/sites-enabled/leantime.conf"[28;3H  register: ficheiro[K[29d[K[30d  - name: "Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permiss√µes certas?"[31;5Hassert:[K[32;7Hthat:[K[33;7H  - ficheiro.stat.exists[K[34;7H  - ficheiro.stat.islnk[K[35;9H- ficheiro.stat.mode == "0777"[36;8H[1K - ficheiro.stat.pw_name == "root"[K[2d[?12l[?25h[?25l[2;36r[36;1H[15S[1;39r[2;36H77[4droot"[K[8d[K[9d[K[10d[K[11d[K[12d[K[13d[K[15d[K[16d[K[17d[K[18d[K[19d[K[20d[K[21d[K[2d[?12l[?25h[?25l[7d[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l7[2;36r8M[1;39r[2;9H- ficheiro.stat.islnk[?12l[?25h[?25l7[2;36r8M[1;39r[2;9H- ficheiro.stat.exists[?12l[?25h[?25l7[2;36r8M[1;39r[2;7Hthat:[?12l[?25h[?25l7[2;36r8M[1;39r[2;5Hassert:[?12l[?25h[?25l7[2;36r8M[1;39r[2;3H- name: "Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permiss√µes certas?"[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[?12l[?25h[?25l7[2;37r8M[1;39r[2;5Hregister: ficheiro[?12l[?25h[?25l7[2;37r8M[1;39r[2;7Hpath: "/etc/apache2/sites-enabled/leantime.conf"[?12l[?25h[?25l7[2;37r8M[1;39r[2;5Hstat:[?12l[?25h[?25l7[2;37r8M[1;39r[2;3H- name: "Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf"[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[36m  # https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[39m(B[m[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[36m  # O site deve estar ativo no apache. Este teste vai verificar se o site se encontra ativo[39m(B[m[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[?12l[?25h[?25l7[2;37r8M[1;39r[2;7Hfail_msg: "ERRO: Permiss√µes incorrectas"[?12l[?25h[?25l7[2;37r8M[1;39r[2;7Hsuccess_msg: "SUCESSO: Permiss√µes correctas"[?12l[?25h[?25l7[2;37r8M[1;39r[2;9H- ficheiro.stat.gr_name == "www-data"[?12l[?25h[?25l7[2;37r8M[1;39r[2;9H- ficheiro.stat.pw_name == "root"[?12l[?25h[?25l7[2;37r8M[1;39r[2;9H- ficheiro.stat.mode == "0755"[?12l[?25h[?25l7[2;37r8M[1;39r[2;9H- ficheiro.stat.isreg[?12l[?25h[?25l7[2;37r8M[1;39r[2;9H- ficheiro.stat.exists[?12l[?25h[?25l7[2;37r8M[1;39r[2;7Hthat:[?12l[?25h[?25l7[2;37r8M[1;39r[2;5Hassert:[?12l[?25h[?25l7[2;37r8M[1;39r[2;3H- name: "Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permiss√µes certas?"[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[?12l[?25h[?25l7[2;37r8M[1;39r[2;5Hregister: ficheiro[?12l[?25h[?25l7[2;37r8M[1;39r[2;7Hpath: "/etc/apache2/sites-available/leantime.conf"[?12l[?25h[?25l7[2;37r8M[1;39r[2;5Hstat:[?12l[?25h[?25l7[2;37r8M[1;39r[2;3H- name: "Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-available/leantime.conf"[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[39m(B[m[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[36m  # leantime em (/etc/apache2/sites-available[39m(B[m[?12l[?25h[?25l[3d[?12l[?25h[?25l[4d[?12l[?25h[?25l[5d[?12l[?25h[?25l[6d[?12l[?25h[?25l[7d[?12l[?25h[?25l[8d[?12l[?25h[?25l[9d[?12l[?25h[?25l[10d[?12l[?25h[?25l[11d[?12l[?25h[?25l[12d[?12l[?25h[?25l[13d[?12l[?25h[?25l[14d[?12l[?25h[?25l[15d[?12l[?25h[?25l[15;42H[?12l[?25h[?25l[16d[?12l[?25h[?25lata"[?12l[?25h[?25l[38d[J[39d[?12l[?25h[39;1H[?1049l[23;0;0t[?1l>[?2004l]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule login
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mlogin[0m
Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-72-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue May 25 20:56:10 UTC 2021

  System load:  0.26              Processes:               130
  Usage of /:   7.8% of 38.71GB   Users logged in:         0
  Memory usage: 31%               IPv4 address for enp0s3: 10.0.2.15
  Swap usage:   0%                IPv4 address for enp0s8: 172.28.128.21

 * Super-optimized for small spaces - read how we shrank the memory
   footprint of MicroK8s to make it the smallest full K8s around.

   https://ubuntu.com/blog/microk8s-memory-optimisation




*** System restart required ***
Last login: Tue May 25 20:54:44 2021 from 10.0.2.2
]0;vagrant@ubuntu-20: ~vagrant@ubuntu-20:~$ sudo /i[K[K*i[K[K-i
]0;root@ubuntu-20: ~root@ubuntu-20:~# ls /etc/apache2/sites-available/[C- /etc/apache2/sites-available/a /etc/apache2/sites-available/l /etc/apache2/sites-available/h /etc/apache2/sites-available/[C /etc/apache2/sites-available/
ls-alh: command not found
]0;root@ubuntu-20: ~root@ubuntu-20:~# ls-alh  /etc/apache2/sites-available/[C[C[1@ 
total 24K
drwxr-xr-x 2 root root 4.0K May 25 18:57 [0m[01;34m.[0m
drwxr-xr-x 8 root root 4.0K May 20 21:19 [01;34m..[0m
-rw-r--r-- 1 root root 1.4K Apr 13  2020 000-default.conf
-rw-r--r-- 1 root root 6.2K Apr 13  2020 default-ssl.conf
-rwxr-xr-x 1 root root  320 May 25 18:57 [01;32mleantime.conf[0m
]0;root@ubuntu-20: ~root@ubuntu-20:~# rm lea[Kls -alh  /etc/apache2/sites-available/[1P[1P[1P[1P[1P[1P[1P[1@r[1@m[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cleantime.conf 
]0;root@ubuntu-20: ~root@ubuntu-20:~# rm  /etc/apache2/sites-available/leantime.conf [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[9Pls -alh  /etc/apache2/sites-available/[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1@ [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P/[1P/[1P/[1P/[1P/[1P/[1P/[1P/[1P/e/n/abled/
total 8.0K
drwxr-xr-x 2 root root 4.0K May 25 20:49 [0m[01;34m.[0m
drwxr-xr-x 8 root root 4.0K May 20 21:19 [01;34m..[0m
lrwxrwxrwx 1 root root   35 May 20 21:19 [01;36m000-default.conf[0m -> ../sites-available/000-default.conf
lrwxrwxrwx 1 root root   42 May 25 20:49 [40;31;01mleantime.conf[0m -> [40;31;01m/etc/apache2/sites-available/leantime.conf[0m
]0;root@ubuntu-20: ~root@ubuntu-20:~# ls -alh  /etc/apache2/sites-enabled/[1P[1P[1P[1P[1P[1P[1P[1@r[1@m[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cleantime.conf 
]0;root@ubuntu-20: ~root@ubuntu-20:~# exit
logout
]0;vagrant@ubuntu-20: ~vagrant@ubuntu-20:~$ exit
logout
Connection to 127.0.0.1 closed.
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano tasks/tasks.yml 
[?2004h[?1049h[22;0;0t[1;39r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[37;64H(B[0;7m[ A ler... ](B[m[37;60H(B[0;7m[ 168 linhas lidas ](B[m[H(B[0;7m  GNU nano 4.8                                                tasks/tasks.yml                                                             [1;137H(B[m[38d(B[0;7m^G(B[m Ajuda[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar[52G(B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor    (B[0;7mM-U(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39d(B[0;7m^X(B[m Sair[39;18H(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer[120G(B[0;7mM-6(B[m Copiar txt[37d[2d[39;49m(B[m---[3d- name: Atualiza a cache (equivalente a apt update)[4;6Hapt:[5dupdate_cache: true[6;8Hcache_valid_time: 3600[8;4H- name: "Atualiza o sistema operativo"[9;6Hapt:[10dupgrade: safe[12;4H- name: "Instalar as dependencias necess√°ria ao programa leantime"[13;6Hapt:[14dpkg:[15;8H- mc[16;8H- screen[17;8H- git[18;8H- apache2[19;8H- mysql-server[20;8H- php[21;8H- php-mysql[22;8H- php-ldap[23;8H- php-cli[24;8H- php-soap[25;8H- php-json[26;8H- graphviz[27;8H- php-xml[28;8H- php-gd[29;8H- php-zip[30;8H- libapache2-mod-php[31;8H- php-dev[32;8H- libmcrypt-dev[33;8H- gcc[34;8H- make[35;8H- autoconf[36;8H- libc-dev[2d[?12l[?25h[?25l[7G[1K - autoconf[3;4H    - libc-dev[K[4;6H  - pkg-config[5;8H- pwgen[K[6;8H- curl[K[7;8H- unzip[8;4H    - zip[K[9;6H  - php-mbstring[10;8H- expect[K[11;8H- net-tools[12;4H    - python3-mysqldb[K[13;6H  - python3-apt[14;8H- python3-pycurl[15d[K[16d[36m   # Fonte de inspira√ß√£o: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html[17;4H[39m(B[m- name: "Instala o servi√ßo apache2 no arranque do sistema"[18;6Hservice:[K[19;8Hname: apache2[K[20;8Hstate: started[21;8Henabled: true[22d[K[23d[36m   # Fonte: https://www.mydailytutorials.com/using-ansible-find-module-search-filesfolder[24;4H[39m(B[m- name: "Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2"[25;6Hfind:[K[26;8Hpaths: /etc[27;8Hpatterns: "php.ini"[28;8Hrecurse: true[29;6Hregister: caminho_php_ini[30d[K[31d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html[32;4H[39m(B[m- name: "Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile."[33;6Hansible.builtin.lineinfile:[34;8Hpath: "{{ caminho_php_ini.files[0].path }}"[35;8Hregexp: "{{ item.regexp  }}"[36;8Hline: "{{ item.line }}"[2d[?12l[?25h[?25l[8Gregexp: "{{ item.regexp  }}"[3;8Hline: "{{ item.line }}"[4;6Hwith_items:[K[5;10Hregexp: "^file_uploads"[6;8H  line: "file_uploads = 1"[7;10Hregexp: "^upload_max_filesize"[8;8H  line: "upload_max_filesize = 1G"[9;10Hregexp: "^max_file_uploads"[10;8H  line: "max_file_uploads = 20"[11;10Hregexp: "^post_max_size"[12;8H  line: "post_max_size = 2G"[13;10Hregexp: "^memory_limit"[14;8H  line: "memory_limit = 2G"[15;8H- regexp: "^max_input_time"[16;9H[1K line: "max_input_time = 3600"[K[17d[K[18d[36m   # Fonte: https://docs.ansible.com/ansible/2.7/modules/file_module.html[19;4H[39m(B[m- name: Cria a directoria tempor√°ria leantime e a directoria de apache leantime[20;6Hfile:[K[21;8Hpath: "{{ item.path }}"[22;8Hstate: directory[23;7H[1K mode: 0755[K[24;4H    owner: www-data[K[25;6H  group: www-data[26;6Hwith_items:[K[27;8H- path: "/tmp/leantime"[28;8H- path: "/var/www/leantime"[29d[K[30d[36m   # Fonte: Ansible for DevOps - Server and configuration management for humans de Jeff Geerling, p√°gina 98[31d[39m(B[m   - name: "Cria a base de dados de mysql para o leantime"[K[32;4H  mysql_db: "db=leantime_database state=present"[K[33d[K[34;4H- name: "Cria o utilizador para a base de dados leantime"[35;6Hmysql_user:[K[36;8Hnam[18Glogin_leantime }}"[2d[?12l[?25h[?25l[6Gmysql_user:[K[3;8Hnam[18Glogin_leantime }}"[4;6H  password: "{{ password_leantime }}"[5;8Hpriv: "leantime_database.*:ALL"[6;8Hhost: localhost[K[7;8Hstate: present[K[8d[K[9;4H- name: "Faz o download do software leantime a partir do reposit√≥rio git"[10;6Hget_url:[K[11;8Hurl: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zip[12;8Hdest: /tmp/leantime[K[13;8Hmode: 0755[K[14d[K[15d[36m   # O ficheiro Leantime-versao.zip necessita de ser descomprimido[16;4H[39m(B[m- name: Descomprime o software leantime[17;6Hunarchive:[18;7H[1K src: "/tmp/leantime/Leantime-{{ versao_leantime }}.zip"[K[19;4H    dest: "/var/www/leantime"[K[20;6H  owner: www-data[21;8Hgroup: www-data[K[22;8Hmode: 0755[K[23;8Hremote_src: true[24d[K[25d[36m   # Ap√≥s a descompress√£o, se o ficheiro configuration.php n√£o existir, este necessita de ser[26d   # criado a partir do ficheiro configuration.sample.php[27d   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html[28;4H[39m(B[m- name: Copia o ficheiro de configura√ß√£o configuration.sample.php[29;6Hansible.builtin.copy:[30;7H[1K src: /var/www/leantime/config/configuration.sample.php[K[31;4H    dest: /var/www/leantime/config/configuration.php[K[32;6H  owner: www-data[K[33;8Hgroup: www-data[34;4H    mode: '0755'[K[35;6H  remote_src: true[36;8Hforce: false[K[2d[?12l[?25h[?25l[27;36r[27;1H[2T[1;39r[2;6H  remote_src: true[3;8Hforce: false[K[4d[K[5d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[6;4H[39m(B[m- name: Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.[7;6Hansible.builtin.replace:[8;8Hpath: /var/www/leantime/config/configuration.php[9;4H    regexp: "{{ item.regexp  }}"[K[10;6H  replace: "{{ item.line }}"[11;6Hwith_items:[K[12;8H- regexp: 'dbUser=""'[13;8H  line: 'dbUser="{{ login_leantime }}"'[14;8H- regexp: 'dbDatabase=""'[15;9H[1K line: 'dbDatabase="leantime_database"'[K[16;4H    - regexp: 'dbPassword=""'[K[17;6H    line: 'dbPassword="{{ password_leantime }}"'[18d[K[19d[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html[20;4H[39m(B[m- name: Copia o template do site para a p√°sta /etc/apache2/sites-available[21;6Hansible.builtin.template:[22;8Hsrc: leantime.template.j2[23;8Hdest: /etc/apache2/sites-available/leantime.conf[24;8Howner: root[25;7H[1K group: www-data[K[26;7H[1K mode: 0755[K[27;8Hforce: false[29;81H[36mfile[30;12H[39m(B[m"Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled"[31;22Hfile[32;14Hetc/apache2/sites-available/leantime.conf[K[33;15Hetc/apache2/sites-enabled/leantime.conf[K[34;15Hroot[K[35;15Hroot[K[2d[?12l[?25h[?25l[8Ggroup: root[K[3;8Hmode: '0755'[4;8Hstate: link[5d[K[6d[K[7d[K[8d[K[9d[K[10d[K[11d[K[12d[K[13d[K[14d[K[15d[K[16d[K[17d[K[19d[K[20d[K[21d[K[22d[K[23d[K[24d[K[25d[K[26d[K[27d[K[29d[K[30d[K[31d[K[32d[K[33d[K[34d[K[35d[K[36d[K[2d[?12l[?25h[?25l[5d[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Howner: root[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hdest: /etc/apache2/sites-enabled/leantime.conf[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hsrc: /etc/apache2/sites-available/leantime.conf[?12l[?25h[?25l7[2;36r8M[1;39r[2;6Hansible.builtin.file:[?12l[?25h[?25l7[2;36r8M[1;39r[2;4H- name: "Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled"[?12l[?25h[?25l7[2;36r8M[1;39r[2;1H[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html[39m(B[m[?12l[?25h[?25l7[2;36r8M[1;39r[2;1H[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hforce: false[?12l[?25h[?25l7[2;36r8M[1;39r[2;8Hmode: 0755[?12l[?25h[?25l7[2;37r8M[1;39r[2;8Hgroup: www-data[?12l[?25h[?25l7[2;37r8M[1;39r[2;8Howner: root[?12l[?25h[?25l7[2;37r8M[1;39r[2;8Hdest: /etc/apache2/sites-available/leantime.conf[?12l[?25h[?25l7[2;37r8M[1;39r[2;8Hsrc: leantime.template.j2[?12l[?25h[?25l7[2;37r8M[1;39r[2;6Hansible.builtin.template:[?12l[?25h[?25l7[2;37r8M[1;39r[2;4H- name: Copia o template do site para a p√°sta /etc/apache2/sites-available[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[36m   # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html[39m(B[m[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[?12l[?25h[?25l7[2;37r8M[1;39r[2;10Hline: 'dbPassword="{{ password_leantime }}"'[?12l[?25h[?25l[3d[?12l[?25h[?25l[4d[?12l[?25h[?25l[5d[?12l[?25h[?25l[6d[?12l[?25h[?25l[7d[?12l[?25h[?25l[8d[?12l[?25h[?25l[9d[?12l[?25h[?25l[10d[?12l[?25h[?25l[11d[?12l[?25h[?25l[12d[?12l[?25h[?25l[13d[?12l[?25h[?25l[14d[?12l[?25h[?25l[15d[?12l[?25h[?25l[16d[?12l[?25h[?25l[17d[?12l[?25h[?25l[18d[?12l[?25h[?25l[19d[?12l[?25h[?25l[20d[?12l[?25h[?25l[20;19H[?12l[?25h[?25l[21d[?12l[?25h[?25l[1;127H(B[0;7mModificado(B[m[21;18H'[K[?12l[?25h[?25l'[K[?12l[?25h[?25l77'[?12l[?25h[?25l777'[?12l[?25h[?25l[38;18H         [38;35H(B[0;7mM-D(B[m Formato DOS[19X[38;69H(B[0;7mM-A(B[m Anexar[20X[38;105H(B[0;7mB(B[m Seguran√ßa[K[39;2H(B[0;7mC(B[m Cancelar[18G           [35G(B[0;7mM-M(B[m Formato Mac[19X[39;69H(B[0;7mM-P(B[m Prepor[24X[39;103H(B[0;7m^T(B[m P/ ficheiros[K[37d(B[0;7mNome do ficheiro onde escrever: tasks/tasks.yml                                                                                           [37;1H(B[m[37;48H[?12l[?25h[?25l[37;60H[1K (B[0;7m[ A escrever... ](B[m[K[1;127H(B[0;7m          (B[m[37;58H(B[0;7m[ 168 linhas escritas ](B[m[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar      (B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor[105G(B[0;7mU(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39;2H(B[0;7mX(B[m Sair    [18G(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer      (B[0;7mM-6(B[m Copiar txt[37d[21;19H[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[12;19H[?12l[?25h[?25l[A[?12l[?25h[?25l[A-[?12l[?25h[?25l[A[?12l[?25h[?25l[10d[?12l[?25h[?25l[11d[?12l[?25h[?25l[12ds[?12l[?25h[?25l[13d[?12l[?25h[?25l[14;19H[?12l[?25h[?25l[15d[?12l[?25h[?25l[16d[?12l[?25h[?25l[17d[?12l[?25h[?25l[18d[?12l[?25h[?25l[19d[?12l[?25h[?25l[20d[?12l[?25h[?25l[21d[?12l[?25h[?25l[A[?12l[?25h[?25l[1;127H(B[0;7mModificado[37d(B[m[K[1;137H[20;18H [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25l [?12l[?25h[?25lw[?12l[?25h[?25lw[?12l[?25h[?25lw[?12l[?25h[?25l-[?12l[?25h[?25ld[?12l[?25h[?25la[?12l[?25h[?25lt[?12l[?25h[?25la[?12l[?25h[?25l[38;18H         [38;35H(B[0;7mM-D(B[m Formato DOS[19X[38;69H(B[0;7mM-A(B[m Anexar[20X[38;105H(B[0;7mB(B[m Seguran√ßa[K[39;2H(B[0;7mC(B[m Cancelar[18G           [35G(B[0;7mM-M(B[m Formato Mac[19X[39;69H(B[0;7mM-P(B[m Prepor[24X[39;103H(B[0;7m^T(B[m P/ ficheiros[K[37d(B[0;7mNome do ficheiro onde escrever: tasks/tasks.yml                                                                                           [37;1H(B[m[37;48H[?12l[?25h[?25l[37;60H[1K (B[0;7m[ A escrever... ](B[m[K[1;127H(B[0;7m          (B[m[37;58H(B[0;7m[ 168 linhas escritas ](B[m[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar      (B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor[105G(B[0;7mU(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39;2H(B[0;7mX(B[m Sair    [18G(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer      (B[0;7mM-6(B[m Copiar txt[37d[20;23H[?12l[?25h[?25l[37d[J[39d[?12l[?25h[39;1H[?1049l[23;0;0t[?1l>[?2004l]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano tasks/tasks.yml [7Pmolecule login[K[K[K[K[Kconverge[K[K[K[K[K[K[K[Kverify
[34mINFO    [0m default scenario test matrix: verify
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mverify[0m
[34mINFO    [0m Running Ansible Verifier

PLAY [Infraestrutura conduzida por testes] ***********************************************************************************************

TASK [Vari√°veis] *************************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Simula√ß√£o: Atualizar a cache do sistema] *******************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [teste: a cache encontra-se actualizada?] *******************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: A cache est√° atualizada"[0m
[32m}[0m

TASK [Atualizar o sistema operativo (equivalente a apt upgrade)] *************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [teste: o sistema operativo encontra-se atualizado?] ********************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O sistema operativo est√° atualizado"[0m
[32m}[0m

TASK [Teste: a cache encontra-se atualizada?] ********************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: A cache est√° atualizada"[0m
[32m}[0m

TASK [Simula√ß√£o: testa se as aplica√ß√µes dependencia do software leantime se encontram instaladas] ****************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: as dependencias encontra-se instaladas?] ************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: As dependencias estavam instaladas"[0m
[32m}[0m

TASK [Simula√ß√£o: Testar se o servi√ßo apache2 se encontra instalado, iniciado e ativo no arranque] ****************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O servi√ßo apache2 encontra-se ativo no arranque no sistema, e est√° iniciado?] ***********************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O servi√ßo apache2 est√° correctamente instalado e inicia com o arranque do sistema"[0m
[32m}[0m

TASK [Rotina Auxiliar> Procura o caminho do ficheiro php.ini do servidor apache2] ********************************************************
[32mok: [ubuntu-20.04][0m

TASK [Simula√ß√£o: Ativa a op√ß√£o file_uploads no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ****************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [Teste: As linhas do php.ini encontram-se alteradas ?] ******************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O ficheiro php.ini foi alterado com sucesso"[0m
[32m}[0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre a pastas /var/www/leantime] **********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: A pasta /var/www/leantime existe e tem as permiss√µes certas?] ***************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: Permiss√µes correctas no site leantime"[0m
[32m}[0m

TASK [Simula√ß√£o: Verifica se √© necess√°rio criar a base de dados leantime_database] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: A base de dados leantime_database existe ?] *********************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: A base de dados leantime_database j√° se encontra criada"[0m
[32m}[0m

TASK [Simula√ß√£o e Teste: Verifica se o endere√ßo git para a vers√£o de leantime existe] ****************************************************
[32mok: [ubuntu-20.04][0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /var/www/leantime/config/configuration.php] *******************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O ficheiro /var/www/leantime/config/configuration.php existe e tem as permiss√µes certas?] ***********************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: Permiss√µes correctas e ficheiro configuration.php existente"[0m
[32m}[0m

TASK [Simula√ß√£o: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace.] ******************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O dbUser foi alterado?] *****************************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"[0m
[32m}[0m

TASK [Simula√ß√£o: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace.] **************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: a vari√°vel dbDatabase foi alterada?] ****************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"[0m
[32m}[0m

TASK [Simula√ß√£o: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace.] **************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O dbPassword foi alterado?] *************************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"[0m
[32m}[0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-available/leantime.conf] *******************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permiss√µes certas?] ***********************************
[31mfatal: [ubuntu-20.04]: FAILED! => {[0m
[31m    "assertion": "ficheiro.stat.exists",[0m
[31m    "changed": false,[0m
[31m    "evaluated_to": false,[0m
[31m    "msg": "ERRO: Permiss√µes incorrectas"[0m
[31m}[0m

PLAY RECAP *******************************************************************************************************************************
[31mubuntu-20.04[0m               : [32mok=27  [0m changed=0    unreachable=0    [31mfailed=1   [0m skipped=0    rescued=0    ignored=0


[1;31mCRITICAL[0m Ansible return code was [1;36m2[0m, command was: ansible-playbook --inventory [35m/home/admlocal/.cache/molecule/leantime_ansible/default/[0m[95minventory[0m --skip-tags molecule-notest,notest [35m/home/admlocal/leantime_ansible/molecule/default/[0m[95mverify.yml[0m
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule verify[K[K[K[K[K[Kconverge
[34mINFO    [0m default scenario test matrix: dependency, create, prepare, converge
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mdependency[0m
[31mWARNING [0m Skipping, missing the requirements file.
[31mWARNING [0m Skipping, missing the requirements file.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mcreate[0m
[31mWARNING [0m Skipping, instances already created.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mprepare[0m
[31mWARNING [0m Skipping, instances already prepared.
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mconverge[0m

PLAY [Converge] **************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Include leantime_ansible] **********************************************************************************************************

TASK [leantime_ansible : Atualiza a cache (equivalente a apt update)] ********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Atualiza o sistema operativo] ***********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instalar as dependencias necess√°ria ao programa leantime] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instala o servi√ßo apache2 no arranque do sistema] ***************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2] *************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ***************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [leantime_ansible : Cria a directoria tempor√°ria leantime e a directoria de apache leantime] ****************************************
[32mok: [ubuntu-20.04] => (item={'path': '/tmp/leantime'})[0m
[32mok: [ubuntu-20.04] => (item={'path': '/var/www/leantime'})[0m

TASK [leantime_ansible : Cria a base de dados de mysql para o leantime] ******************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria o utilizador para a base de dados leantime] ****************************************************************
[1;35m[WARNING]: Module did not set no_log for update_password[0m
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Faz o download do software leantime a partir do reposit√≥rio git] ************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Descomprime o software leantime] ********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Copia o ficheiro de configura√ß√£o configuration.sample.php] ******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.] ***
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbUser=""', 'line': 'dbUser="leantimeDBadmin"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbDatabase=""', 'line': 'dbDatabase="leantime_database"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbPassword=""', 'line': 'dbPassword="#S3gr3d0S3cr3t0#"'})[0m

TASK [leantime_ansible : Copia o template do site para a p√°sta /etc/apache2/sites-available] *********************************************
[33mchanged: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled] ************************
[33mchanged: [ubuntu-20.04][0m

PLAY RECAP *******************************************************************************************************************************
[33mubuntu-20.04[0m               : [32mok=16  [0m [33mchanged=2   [0m unreachable=0    failed=0    skipped=0    rescued=0    ignored=0


]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule converge[K[K[K[K[K[K[K[Kidempotence
[34mINFO    [0m default scenario test matrix: idempotence
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32midempotence[0m

PLAY [Converge] **************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Include leantime_ansible] **********************************************************************************************************

TASK [leantime_ansible : Atualiza a cache (equivalente a apt update)] ********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Atualiza o sistema operativo] ***********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instalar as dependencias necess√°ria ao programa leantime] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instala o servi√ßo apache2 no arranque do sistema] ***************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2] *************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ***************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [leantime_ansible : Cria a directoria tempor√°ria leantime e a directoria de apache leantime] ****************************************
[32mok: [ubuntu-20.04] => (item={'path': '/tmp/leantime'})[0m
[32mok: [ubuntu-20.04] => (item={'path': '/var/www/leantime'})[0m

TASK [leantime_ansible : Cria a base de dados de mysql para o leantime] ******************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria o utilizador para a base de dados leantime] ****************************************************************
[1;35m[WARNING]: Module did not set no_log for update_password[0m
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Faz o download do software leantime a partir do reposit√≥rio git] ************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Descomprime o software leantime] ********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Copia o ficheiro de configura√ß√£o configuration.sample.php] ******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.] ***
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbUser=""', 'line': 'dbUser="leantimeDBadmin"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbDatabase=""', 'line': 'dbDatabase="leantime_database"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbPassword=""', 'line': 'dbPassword="#S3gr3d0S3cr3t0#"'})[0m

TASK [leantime_ansible : Copia o template do site para a p√°sta /etc/apache2/sites-available] *********************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled] ************************
[32mok: [ubuntu-20.04][0m

PLAY RECAP *******************************************************************************************************************************
[32mubuntu-20.04[0m               : [32mok=16  [0m changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0


[34mINFO    [0m Idempotence completed successfully.
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule login
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mlogin[0m
Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-72-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue May 25 21:00:06 UTC 2021

  System load:  0.31              Processes:               135
  Usage of /:   7.8% of 38.71GB   Users logged in:         0
  Memory usage: 33%               IPv4 address for enp0s3: 10.0.2.15
  Swap usage:   0%                IPv4 address for enp0s8: 172.28.128.21

 * Super-optimized for small spaces - read how we shrank the memory
   footprint of MicroK8s to make it the smallest full K8s around.

   https://ubuntu.com/blog/microk8s-memory-optimisation




*** System restart required ***
Last login: Tue May 25 20:59:59 2021 from 10.0.2.2
]0;vagrant@ubuntu-20: ~vagrant@ubuntu-20:~$ sudo -i
]0;root@ubuntu-20: ~root@ubuntu-20:~# ls -alh /etc/apache2/sites-available/
total 24K
drwxr-xr-x 2 root root     4.0K May 25 20:59 [0m[01;34m.[0m
drwxr-xr-x 8 root root     4.0K May 20 21:19 [01;34m..[0m
-rw-r--r-- 1 root root     1.4K Apr 13  2020 000-default.conf
-rw-r--r-- 1 root root     6.2K Apr 13  2020 default-ssl.conf
-rwxrwxrwx 1 root www-data  320 May 25 20:59 [01;32mleantime.conf[0m
]0;root@ubuntu-20: ~root@ubuntu-20:~# ls -alh /etc/apache2/sites-available/[1P/[1P/[1P/[1P/[1P/[1P/[1P/[1P/[1P/e/n/a/b/l/e/d/
total 8.0K
drwxr-xr-x 2 root root 4.0K May 25 20:59 [0m[01;34m.[0m
drwxr-xr-x 8 root root 4.0K May 20 21:19 [01;34m..[0m
lrwxrwxrwx 1 root root   35 May 20 21:19 [01;36m000-default.conf[0m -> ../sites-available/000-default.conf
lrwxrwxrwx 1 root root   42 May 25 20:59 [01;36mleantime.conf[0m -> [01;32m/etc/apache2/sites-available/leantime.conf[0m
]0;root@ubuntu-20: ~root@ubuntu-20:~# stat -c "%a %n" &[K/etc/&[Kapache2/sites-available/leantime.conf 
777 /etc/apache2/sites-available/leantime.conf
]0;root@ubuntu-20: ~root@ubuntu-20:~# stat -c "%a %n" /etc/apache2/sites-available/leantime.conf [1P[1P[1P[1P[1P[1P[1P[1P[1P[1@e[1@n[1@a[1@b[1@l[1@e[1@d
777 /etc/apache2/sites-enabled/leantime.conf
]0;root@ubuntu-20: ~root@ubuntu-20:~# exit
logout
]0;vagrant@ubuntu-20: ~vagrant@ubuntu-20:~$ exit
logout
Connection to 127.0.0.1 closed.
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano molecule/default/
[?2004h[?1049h[22;0;0t[1;39r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[37;52H(B[0;1m[37m[41m[ "molecule/default/" √© uma pasta ][39;49m(B[m[H(B[0;7m  GNU nano 4.8                                                  Novo buffer                                                               [1;137H(B[m[38d(B[0;7m^G(B[m Ajuda[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar[52G(B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor    (B[0;7mM-U(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39d(B[0;7m^X(B[m Sair[39;18H(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer[120G(B[0;7mM-6(B[m Copiar txt[37d[2d[39;49m(B[m[?12l[?25h[?25l[1;127H(B[0;7mModificado(B[m[2dv[?12l[?25h[?25l[37d(B[0;7mGravar buffer modificado?                                                                                                                 [38;1H S(B[m Sim[K[39d(B[0;7m N(B[m N√£o [39;17H(B[0;7m^C(B[m Cancelar[K[37d[?12l[?25h[?25l[?12l[?25h[?25l[J[39d[?12l[?25h[39;1H[?1049l[23;0;0t[?1l>[?2004l]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano molecule/default/verify.yml 
[?2004h[?1049h[22;0;0t[1;39r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[37;64H(B[0;7m[ A ler... ](B[m[37;60H(B[0;7m[ 302 linhas lidas ](B[m[H(B[0;7m  GNU nano 4.8                                          molecule/default/verify.yml                                                       [1;137H(B[m[38d(B[0;7m^G(B[m Ajuda[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar[52G(B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor    (B[0;7mM-U(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39d(B[0;7m^X(B[m Sair[39;18H(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer[120G(B[0;7mM-6(B[m Copiar txt[37d[2d[39;49m(B[m---[3d[36m# Tutorial de inspira√ß√£o para a infraestrutura conduzida por teste no site[4d# https://www.adictosaltrabajo.com/2020/05/08/ansible-testing-using-molecule-with-ansible-as-verifier/[6d[39m(B[m- name: "Infraestrutura conduzida por testes"[7;3Hhosts: all[8;3Hgather_facts: false[9;3Hbecome: true[11;3Htasks:[12;3H- name: Vari√°veis[13;5Hinclude_vars:[14;7Hfile: ../../vars/main.yml[16;3H- name: "Simula√ß√£o: Atualizar a cache do sistema"[17;5Hapt:[18dupdate_cache: true[19;7Hcache_valid_time: 3600[20;5Hcheck_mode: true[21;5Hregister: estado[23;3H- name: "teste: a cache encontra-se actualizada?"[24;5Hassert:[25;7Hthat:[26;7H- not estado.changed[27;7Hsuccess_msg: "SUCESSO: A cache est√° atualizada"[28;7Hfail_msg: "ERRO: Existem actualiza√ß√µes pendentes"[30;3H- name: "Atualizar o sistema operativo (equivalente a apt upgrade)"[31;5Hapt:[32dupgrade: safe[33;5Hcheck_mode: true[34;5Hregister: estado[36;3H- name: "teste: o sistema operativo encontra-se atualizado?"[2d[?12l[?25h[?25l[K[3d  - name: "teste: o sistema operativo encontra-se atualizado?"[K[4d    assert:[K[5;7Hthat:[6;6H[1K - not estado.changed[K[7;3H    success_msg: "SUCESSO: O sistema operativo est√° atualizado"[8;3H    fail_msg: "ERRO: Existem actualiza√ß√µes pendentes"[9d[K[10d  - name: "Teste: a cache encontra-se atualizada?"[11;3H  assert:[12;3H    that:[K[13;5H  - not estado.changed[14;7Hsuccess_msg: "SUCESSO: A cache est√° atualizada"[15;7Hfail_msg: "ERRO: Existem atualiza√ß√µes pendentes"[16d[K[17d  - name: "Simula√ß√£o: testa se as aplica√ß√µes dependencia do software leantime se encontram instaladas"[18;5Hapt:[K[19dpkg:[K[20;5H  - mc[K[21;5H  - screen[K[22;7H- git[23;3H    - apache2[K[24;5H  - mysql-server[25;7H- php[26;9Hphp-mysql[K[27;7H- php-ldap[K[28;7H- php-cli[K[29;7H- php-soap[30;3H    - php-json[K[31;5H  - graphviz[32;7H- php-xml[K[33;5H  - php-gd[K[34;5H  - php-zip[K[35;7H- libapache2-mod-php[36;3H    - php-dev[K[2d[?12l[?25h[?25l[7G- libapache2-mod-php[3;3H    - php-dev[K[4;5H  - libmcrypt-dev[5;7H- gcc[6;9Hmake[K[7;7H- autoconf[K[8;7H- libc-dev[K[9;7H- pkg-config[10;3H    - pwgen[K[11;5H  - curl[12;7H- unzip[13;9Hzip[K[14;7H- php-mbstring[K[15;7H- expect[K[16;7H- net-tools[17;3H    - python3-mysqldb[K[18;5H  - python3-apt[19;7H- python3-pycurl[20;5Hcheck_mode: true[21;5Hregister: estado[22d[K[23d  - name: "Teste: as dependencias encontra-se instaladas?"[24;5Hassert:[K[25;7Hthat:[26;9Hnot estado.changed[27;7Hsuccess_msg: "SUCESSO: As dependencias estavam instaladas"[28;7Hfail_msg: "ERRO: Faltam instalar algumas dependencias. O software pode estar parcialmente instalado"[29d[K[30d[36m  # Fonte de inspira√ß√£o: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html[31;3H[39m(B[m- name: "Simula√ß√£o: Testar se o servi√ßo apache2 se encontra instalado, iniciado e ativo no arranque"[32;5Hservice:[K[33;7Hname: apache2[34;7Hstate: started[35;7Henabled: true[K[36;5Hcheck_mode: true[2d[?12l[?25h[?25l[2;36r[36;1H[17S[1;39r[2;7Henabled: true[K[6dO servi√ßo apache2 encontra-se ativo no arranque no sistema, e est√° iniciado?"[10;30HO servi√ßo apache2 est√° correctamente instalado e inicia com o arranque do sistema"[11;24HO servi√ßo apache2 n√£o se encontra correcta[25P[13;10H[36m: https://www.mydailytutorials.com/using-[58G-find-module-search-filesfolder[39m(B[m[K[14;12HRotina Auxiliar> Procura o caminho do ficheiro php.ini do servidor apache2"[K[15;5Hfind:[K[16;7Hpaths: /etc[K[17;7Hpatterns: "php.ini"[18;7Hrecurse[19;5Hregister: caminho_php_ini[21d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html[22;3H[39m(B[m- name: "Simula√ß√£o: Ativa a op√ß√£o file_uploads no ficheiro php.ini, utilizando o m√≥dulo lineinfile."[23;5Hansible.builtin.lineinfile:[24;7Hpath: "{{ caminho_php_ini.files[0].path }}"[25;7Hregexp: "{{ item.regexp  }}"[26;7Hline: "{{ item.line }}"[27;5Hwith_items:[28;7H- regexp: "^file_uploads"[29;9Hline: "file_uploads = 1"[30;7H- regexp: "^upload_max_filesize"[31;9Hline: "upload_max_filesize = 1G"[32;7H- regexp: "^max_file_uploads"[33;9Hline: "max_file_uploads = 20"[34;7H- regexp: "^post_max_size"[35;9Hline: "post_max_size = 2G"[36;7H- regexp: "^memory_limit"[2d[?12l[?25h[?25l7[2;17r8[4T[1;39r[2;9Hline: "post_max_size = 2G"[3;7H- regexp: "^memory_limit"[4;9Hline: "memory_limit = 2G"[5;7H- regexp: "^max_input_time"[6;7H  line: "max_input_time = 3600"[10;19HAs linhas do php.ini encontram-se alteradas ?"[K[14;32Hficheiro php.ini foi alterado com sucesso"[K[15;24HAlgumas altera√ß√µes ao ficheiro php.ini n√£o tiveram sucesso"[17;5H[36mO site deve existir na pasta /var/www/leantime. Este teste visa determinar se a pasta[18d  # existe e se temas permiss√µes certas[19d  # Fonte de inspira√ß√£o: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[20;3H[39m(B[m- name: "Simula√ß√£o: Obtem informa√ß√£o sobre a pastas /var/www/leantime"[21d    stat:[K[22;3H    path: "/var/www/leantime"[K[23;5Hregister: pasta[K[24d[K[25d  - name: "Teste: A pasta /var/www/leantime existe e tem as permiss√µes certas?"[26;5Hassert:[K[27;5H  that:[K[28;7H  - pasta.stat.exists[K[29;9H- pasta.stat.isdir[K[30;7H  - pasta.stat.mode == "0755"[K[31;9H- pasta.stat.pw_name == "www-data"[32;7H  - pasta.stat.gr_name == "www-data"[33;7Hsuccess_msg: "SUCESSO: Permiss√µes correctas no site leantime"[34;7Hfail_msg: "ERRO: Permiss√µes incorrectas no site leantime ou site n√£o existente"[35d[K[36d[36m  # Outro dos requesitos √© a exist√™ncia de uma base de dados para o site.[2d[39m(B[m[?12l[?25h[?25l[14;36r[14;1H[8T[1;39r[2;1H[K[3d[36m  # Outro dos requesitos √© a exist√™ncia de uma base de dados para o site.[4d  # Esta base de dados deve ser criada, logo tem de ser testada para determinar se ela existe ou n√£o.[5d  # Fonte de inspira√ß√£o: https://serverfault.com/questions/173978/from-a-shell-script-how-can-i-check-whether-a-mysql-database-exists[6;3H[39m(B[m- name: "Simula√ß√£o: Verifica se √© necess√°rio criar a base de dados leantime_database"[7;5Hshell: "mysql -u root -e 'use leantime_database'"[8;15Hresult[9;5Hfailed_when: false[10;3H  changed_when: false[K[11d[K[12d  - name: "Teste: A base de dados leantime_database existe ?"[13;5Hassert:[K[14;7Hthat:[15;7H- result.rc == 0[16;7Hsuccess_msg: "SUCESSO: A base de dados leantime_database j√° se encontra criada"[17;7Hfail_msg: "ERRO: N√£o existe a base de dados leantime_database"[19d[36m  # Teste: O download do software leantime deve ser poss√≠vel, a partir do site do leantime[20;3H[39m(B[m- name: "Simula√ß√£o e Teste: Verifica se o endere√ßo git para a vers√£o de leantime existe"[21;5Huri:[22durl: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zip[23;5Hregister: resultado[K[25;5H[36mTeste: D[25;25Ho ficheiro configuration.php no site do leantime. A exist√™ncia deste ficheiro[26;5H       com as permiss√µes certas indica que o processo de unzip correu bem[27;5HDocumenta√ß√£o oficial em: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[28;46H[39m(B[mo ficheiro /var/www/leantime/config/configuration.php"[30;31H/config/configuration.php"[31;15Hficheiro[33;19HO ficheiro /var/www/leantime/config/configuration.php existe e tem as permiss√µes certas?"[36;11Hficheiro.stat.exists[2d[?12l[?25h[?25l[7Gthat:[3;8H[1K - ficheiro.stat.exists[K[4;8H[1K - ficheiro.stat.isreg[K[5;8H[1K - ficheiro.stat.mode == "0755"[K[6;8H[1K - ficheiro.stat.pw_name == "www-data"[K[7;5H    - ficheiro.stat.gr_name == "www-data"[K[8;5H  success_msg: "SUCESSO: Permiss√µes correctas e ficheiro configuration.php existente"[9;5H  fail_msg: "ERRO: Permiss√µes incorrectas ou ficheiro configuration.php n√£o existente"[10d[K[11d[36m  # Teste: O ficheiro /var/www/leantime/config/configuration.php necessita de ser alterado.[12d  # As vari√°veis dbuser, dbDatabase, e dbPassword necessitam de estar configuradas.[13d  # Por simula√ß√£o o sistema vai determinar se estas est√£o configuradas com o valor esperado.[14d  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[15;3H[39m(B[m- name: "Simula√ß√£o: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace."[16;5Hansible.builtin.replace:[K[17;7Hpath: /var/www/leantime/config/configuration.php[K[18;7Hregexp: 'dbUser=""'[19;6H[1K replace: 'dbUser="{{ login_leantime }}"'[K[20;3H  check_mode: yes[K[21;5Hregister: conf[22;5Hfailed_when: false[K[23d[K[24d  - name: "Teste: O dbUser foi alterado?"[25d    assert:[K[26;6H[1K that:[K[27;6H[1K - conf is not changed[K[28;3H    - conf is not failed[K[29;5H  success_msg: "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"[30;7Hfail_msg: "ERRO: O dbUser n√£o foi alterado no ficheiro configuration.php"[31d[K[33d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[39m(B[m[K[34;3H- name: "Simula√ß√£o: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace."[35;5Hansible.builtin.replace:[36;7Hpath: /var/www/leantime/config/configuration.php[2d[?12l[?25h[?25l    ansible.builtin.replace:[3;7Hpath: /var/www/leantime/config/configuration.php[4;7Hregexp: 'dbDatabase=""'[5;7Hreplace: 'dbDatabase="leantime_database"'[6;5Hcheck_mode: yes[K[7;5Hregister: conf[K[8;5Hfailed_when: false[K[9d[K[10d  - name: "Teste: a vari√°vel dbDatabase foi alterada?"[11d    assert:[K[12;6H[1K that:[K[13;6H[1K - conf is not changed[K[14;6H[1K - conf is not failed[K[15;3H    success_msg: "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"[K[16;5H  fail_msg: "ERRO: O dbDatabase n√£o foi alterado no ficheiro configuration.php"[17d[K[18d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html[19;3H[39m(B[m- name: "Simula√ß√£o: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace."[20;5Hansible.builtin.replace:[21;5H  path: /var/www/leantime/config/configuration.php[22;5H  regexp: 'dbPassword=""'[23;7Hreplace: 'dbPassword="{{ password_leantime }}"'[24;3H  check_mode: yes[K[25;5Hregister: conf[26;5Hfailed_when: false[27d[K[28d  - name: "Teste: O dbPassword foi alterado?"[29;5Hassert:[K[30;7Hthat:[K[31;7H- conf is not changed[32;7H- conf is not failed[33;6H[1K success_msg: "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"[K[34;3H    fail_msg: "ERRO: O dbPassword n√£o foi alterado no ficheiro configuration.php"[K[35d[K[36d[36m  # A configura√ß√£o do site leantime necessita que seja criado um site atrav√©s de um ficheiro de[2d[39m(B[m[?12l[?25h[?25l[K[3d[36m  # A configura√ß√£o do site leantime necessita que seja criado um site atrav√©s de um ficheiro de[4d  # configura√ß√£o, dentro das pasta do apache2. Deve existir um ficheiro de configura√ß√£o do[5d  # leantime em (/etc/apache2/sites-available[39m(B[m[K[6d[36m  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[7;3H[39m(B[m- name: "Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-available/leantime.conf"[8;5Hstat:[K[9;7Hpath: "/etc/apache2/sites-available/leantime.conf"[10;3H  register: ficheiro[K[11d[K[12d  - name: "Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permiss√µes certas?"[13;5Hassert:[K[14;7Hthat:[K[15;7H  - ficheiro.stat.exists[K[16;7H  - ficheiro.stat.isreg[K[17;9H- ficheiro.stat.mode == "0755"[18;8H[1K - ficheiro.stat.pw_name == "root"[K[19;8H[1K - ficheiro.stat.gr_name == "www-data"[K[20;5H  success_msg: "SUCESSO: Permiss√µes correctas"[21;7Hfail_msg: "ERRO: Permiss√µes incorrectas"[K[22d[K[23d[36m  # O site deve estar ativo no apache. Este teste vai verificar se o site se encontra ativo[24d  # https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[25;3H[39m(B[m- name: "Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf"[26;5Hstat:[K[27;7Hpath: "/etc/apache2/sites-enabled/leantime.conf"[28;3H  register: ficheiro[K[29d[K[30d  - name: "Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permiss√µes certas?"[31;5Hassert:[K[32;7Hthat:[K[33;7H  - ficheiro.stat.exists[K[34;7H  - ficheiro.stat.islnk[K[35;9H- ficheiro.stat.mode == "0777"[36;8H[1K - ficheiro.stat.pw_name == "root"[K[2d[?12l[?25h[?25l[2;36r[36;1H[15S[1;39r[2;36H77[4droot"[K[8d[K[9d[K[10d[K[11d[K[12d[K[13d[K[15d[K[16d[K[17d[K[18d[K[19d[K[20d[K[21d[K[2d[?12l[?25h[?25l[7d[?12l[?25h[?25l[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l[A[?12l[?25h[?25l7[2;36r8M[1;39r[2;9H- ficheiro.stat.islnk[?12l[?25h[?25l7[2;36r8M[1;39r[2;9H- ficheiro.stat.exists[?12l[?25h[?25l7[2;36r8M[1;39r[2;7Hthat:[?12l[?25h[?25l7[2;36r8M[1;39r[2;5Hassert:[?12l[?25h[?25l7[2;36r8M[1;39r[2;3H- name: "Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permiss√µes certas?"[?12l[?25h[?25l7[2;36r8M[1;39r[2;1H[?12l[?25h[?25l7[2;36r8M[1;39r[2;5Hregister: ficheiro[?12l[?25h[?25l7[2;36r8M[1;39r[2;7Hpath: "/etc/apache2/sites-enabled/leantime.conf"[?12l[?25h[?25l7[2;36r8M[1;39r[2;5Hstat:[?12l[?25h[?25l7[2;37r8M[1;39r[2;3H- name: "Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf"[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[36m  # https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html[39m(B[m[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[36m  # O site deve estar ativo no apache. Este teste vai verificar se o site se encontra ativo[39m(B[m[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[?12l[?25h[?25l7[2;37r8M[1;39r[2;7Hfail_msg: "ERRO: Permiss√µes incorrectas"[?12l[?25h[?25l7[2;37r8M[1;39r[2;7Hsuccess_msg: "SUCESSO: Permiss√µes correctas"[?12l[?25h[?25l7[2;37r8M[1;39r[2;9H- ficheiro.stat.gr_name == "www-data"[?12l[?25h[?25l7[2;37r8M[1;39r[2;9H- ficheiro.stat.pw_name == "root"[?12l[?25h[?25l7[2;37r8M[1;39r[2;9H- ficheiro.stat.mode == "0755"[?12l[?25h[?25l7[2;37r8M[1;39r[2;9H- ficheiro.stat.isreg[?12l[?25h[?25l7[2;37r8M[1;39r[2;9H- ficheiro.stat.exists[?12l[?25h[?25l7[2;37r8M[1;39r[2;7Hthat:[?12l[?25h[?25l7[2;37r8M[1;39r[2;5Hassert:[?12l[?25h[?25l7[2;37r8M[1;39r[2;3H- name: "Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permiss√µes certas?"[?12l[?25h[?25l7[2;37r8M[1;39r[2;1H[?12l[?25h[?25l7[2;37r8M[1;39r[2;5Hregister: ficheiro[?12l[?25h[?25l7[2;37r8M[1;39r[2;7Hpath: "/etc/apache2/sites-available/leantime.conf"[?12l[?25h[?25l[3d[?12l[?25h[?25l[4d[?12l[?25h[?25l[5d[?12l[?25h[?25l[6d[?12l[?25h[?25l[7d[?12l[?25h[?25l[8d[?12l[?25h[?25l[9d[?12l[?25h[?25l[10d[?12l[?25h[?25l[10;39H[?12l[?25h[?25l[?12l[?25h[?25l[1;127H(B[0;7mModificado(B[m[10;37H"[K[?12l[?25h[?25l"[K[?12l[?25h[?25l77"[?12l[?25h[?25l777"[?12l[?25h[?25l[38;18H         [38;35H(B[0;7mM-D(B[m Formato DOS[19X[38;69H(B[0;7mM-A(B[m Anexar[20X[38;105H(B[0;7mB(B[m Seguran√ßa[K[39;2H(B[0;7mC(B[m Cancelar[18G           [35G(B[0;7mM-M(B[m Formato Mac[19X[39;69H(B[0;7mM-P(B[m Prepor[24X[39;103H(B[0;7m^T(B[m P/ ficheiros[K[37d(B[0;7mNome do ficheiro onde escrever: molecule/default/verify.yml                                                                               [37;1H(B[m[37;60H[?12l[?25h[?25l[1K (B[0;7m[ A escrever... ](B[m[K[1;127H(B[0;7m          (B[m[37;58H(B[0;7m[ 302 linhas escritas ](B[m[38;18H(B[0;7m^O(B[m Gravar[38;35H(B[0;7m^W(B[m Procurar      (B[0;7m^K(B[m Cortar txt    (B[0;7m^J(B[m Justificar    (B[0;7m^C(B[m Pos cursor[105G(B[0;7mU(B[m Desfazer     (B[0;7mM-A(B[m Marcar txt[39;2H(B[0;7mX(B[m Sair    [18G(B[0;7m^R(B[m Carregar[35G(B[0;7m^\(B[m Substituir    (B[0;7m^U(B[m Colar txt     (B[0;7m^T(B[m Ortografia    (B[0;7m^_(B[m Ir p/ linha   (B[0;7mM-E(B[m Refazer      (B[0;7mM-6(B[m Copiar txt[37d[10;38H[?12l[?25h[?25l[37d[J[39d[?12l[?25h[39;1H[?1049l[23;0;0t[?1l>[?2004l]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ nano molecule/default/verify.yml [K[8Pmolecule login[K[K[K[K[Kverify
[34mINFO    [0m default scenario test matrix: verify
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32mverify[0m
[34mINFO    [0m Running Ansible Verifier

PLAY [Infraestrutura conduzida por testes] ***********************************************************************************************

TASK [Vari√°veis] *************************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Simula√ß√£o: Atualizar a cache do sistema] *******************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [teste: a cache encontra-se actualizada?] *******************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: A cache est√° atualizada"[0m
[32m}[0m

TASK [Atualizar o sistema operativo (equivalente a apt upgrade)] *************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [teste: o sistema operativo encontra-se atualizado?] ********************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O sistema operativo est√° atualizado"[0m
[32m}[0m

TASK [Teste: a cache encontra-se atualizada?] ********************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: A cache est√° atualizada"[0m
[32m}[0m

TASK [Simula√ß√£o: testa se as aplica√ß√µes dependencia do software leantime se encontram instaladas] ****************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: as dependencias encontra-se instaladas?] ************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: As dependencias estavam instaladas"[0m
[32m}[0m

TASK [Simula√ß√£o: Testar se o servi√ßo apache2 se encontra instalado, iniciado e ativo no arranque] ****************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O servi√ßo apache2 encontra-se ativo no arranque no sistema, e est√° iniciado?] ***********************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O servi√ßo apache2 est√° correctamente instalado e inicia com o arranque do sistema"[0m
[32m}[0m

TASK [Rotina Auxiliar> Procura o caminho do ficheiro php.ini do servidor apache2] ********************************************************
[32mok: [ubuntu-20.04][0m

TASK [Simula√ß√£o: Ativa a op√ß√£o file_uploads no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ****************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [Teste: As linhas do php.ini encontram-se alteradas ?] ******************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O ficheiro php.ini foi alterado com sucesso"[0m
[32m}[0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre a pastas /var/www/leantime] **********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: A pasta /var/www/leantime existe e tem as permiss√µes certas?] ***************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: Permiss√µes correctas no site leantime"[0m
[32m}[0m

TASK [Simula√ß√£o: Verifica se √© necess√°rio criar a base de dados leantime_database] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: A base de dados leantime_database existe ?] *********************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: A base de dados leantime_database j√° se encontra criada"[0m
[32m}[0m

TASK [Simula√ß√£o e Teste: Verifica se o endere√ßo git para a vers√£o de leantime existe] ****************************************************
[32mok: [ubuntu-20.04][0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /var/www/leantime/config/configuration.php] *******************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O ficheiro /var/www/leantime/config/configuration.php existe e tem as permiss√µes certas?] ***********************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: Permiss√µes correctas e ficheiro configuration.php existente"[0m
[32m}[0m

TASK [Simula√ß√£o: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace.] ******************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O dbUser foi alterado?] *****************************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"[0m
[32m}[0m

TASK [Simula√ß√£o: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace.] **************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: a vari√°vel dbDatabase foi alterada?] ****************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"[0m
[32m}[0m

TASK [Simula√ß√£o: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o m√≥dulo replace.] **************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O dbPassword foi alterado?] *************************************************************************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"[0m
[32m}[0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-available/leantime.conf] *******************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permiss√µes certas?] ***********************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: Permiss√µes correctas"[0m
[32m}[0m

TASK [Simula√ß√£o: Obtem informa√ß√£o sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf] *********************************************
[32mok: [ubuntu-20.04][0m

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permiss√µes certas?] *************************************
[32mok: [ubuntu-20.04] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "SUCESSO: Permiss√µes correctas"[0m
[32m}[0m

PLAY RECAP *******************************************************************************************************************************
[32mubuntu-20.04[0m               : [32mok=30  [0m changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0

[34mINFO    [0m Verifier completed successfully.
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ molecule idempotence
[34mINFO    [0m default scenario test matrix: idempotence
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
[34mINFO    [0m Added [33mANSIBLE_ROLES_PATH[0m=~[35m/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m:.[35m/.cache/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mdefault[0m[2;36m > [0m[2;32midempotence[0m

PLAY [Converge] **************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [Include leantime_ansible] **********************************************************************************************************

TASK [leantime_ansible : Atualiza a cache (equivalente a apt update)] ********************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Atualiza o sistema operativo] ***********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instalar as dependencias necess√°ria ao programa leantime] *******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Instala o servi√ßo apache2 no arranque do sistema] ***************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Rotina Auxiliar: Procura o caminho do ficheiro php.ini do servidor apache2] *************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Ativa v√°rias op√ß√µes no ficheiro php.ini, utilizando o m√≥dulo lineinfile.] ***************************************
[32mok: [ubuntu-20.04] => (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})[0m

TASK [leantime_ansible : Cria a directoria tempor√°ria leantime e a directoria de apache leantime] ****************************************
[32mok: [ubuntu-20.04] => (item={'path': '/tmp/leantime'})[0m
[32mok: [ubuntu-20.04] => (item={'path': '/var/www/leantime'})[0m

TASK [leantime_ansible : Cria a base de dados de mysql para o leantime] ******************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria o utilizador para a base de dados leantime] ****************************************************************
[1;35m[WARNING]: Module did not set no_log for update_password[0m
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Faz o download do software leantime a partir do reposit√≥rio git] ************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Descomprime o software leantime] ********************************************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Copia o ficheiro de configura√ß√£o configuration.sample.php] ******************************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Altera as vari√°veis dbuser, dbpassword e dbdatabase no ficheiro configuration.php utilizando o m√≥dulo replace.] ***
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbUser=""', 'line': 'dbUser="leantimeDBadmin"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbDatabase=""', 'line': 'dbDatabase="leantime_database"'})[0m
[32mok: [ubuntu-20.04] => (item={'regexp': 'dbPassword=""', 'line': 'dbPassword="#S3gr3d0S3cr3t0#"'})[0m

TASK [leantime_ansible : Copia o template do site para a p√°sta /etc/apache2/sites-available] *********************************************
[32mok: [ubuntu-20.04][0m

TASK [leantime_ansible : Cria um link simb√≥lico para o ficheiro leantime.conf na pasta /etc/apache/sites-enabled] ************************
[32mok: [ubuntu-20.04][0m

PLAY RECAP *******************************************************************************************************************************
[32mubuntu-20.04[0m               : [32mok=16  [0m changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0


[34mINFO    [0m Idempotence completed successfully.
]0;admlocal@devOps: ~/leantime_ansibleadmlocal@devOps:~/leantime_ansible$ exit
exit
