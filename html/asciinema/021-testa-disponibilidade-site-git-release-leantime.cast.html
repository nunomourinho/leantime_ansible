<!DOCTYPE html>
<html>
<head>
<style type="text/css">
body {background-color: black;}
pre {
	font-weight: normal;
	color: #bbb;
	white-space: -moz-pre-wrap;
	white-space: -o-pre-wrap;
	white-space: -pre-wrap;
	white-space: pre-wrap;
	word-wrap: break-word;
	overflow-wrap: break-word;
}
b {font-weight: normal}
b.BOLD {color: #fff}
b.ITA {font-style: italic}
b.UND {text-decoration: underline}
b.STR {text-decoration: line-through}
b.UNDSTR {text-decoration: underline line-through}
b.BLK {color: #000000}
b.RED {color: #aa0000}
b.GRN {color: #00aa00}
b.YEL {color: #aa5500}
b.BLU {color: #0000aa}
b.MAG {color: #aa00aa}
b.CYN {color: #00aaaa}
b.WHI {color: #aaaaaa}
b.HIK {color: #555555}
b.HIR {color: #ff5555}
b.HIG {color: #55ff55}
b.HIY {color: #ffff55}
b.HIB {color: #5555ff}
b.HIM {color: #ff55ff}
b.HIC {color: #55ffff}
b.HIW {color: #ffffff}
b.BBLK {background-color: #000000}
b.BRED {background-color: #aa0000}
b.BGRN {background-color: #00aa00}
b.BYEL {background-color: #aa5500}
b.BBLU {background-color: #0000aa}
b.BMAG {background-color: #aa00aa}
b.BCYN {background-color: #00aaaa}
b.BWHI {background-color: #aaaaaa}
</style>
</head>
<body>
<pre>admlocal@devOps:~/leantime_ansible$ nano molecule/default/verify.yml 
BB
<hr>
B<b class="BLK BWHI">[ A ler... ]B</b>B<b class="BLK BWHI">[ 177 linhas lidas ]B</b>B<b class="BLK BWHI">  GNU nano 4.8                                          molecule/default/verify.yml                                                       B</b>&crarr;
B<b class="BLK BWHI">^GB</b> AjudaB<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> ProcurarB<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursor    B<b class="BLK BWHI">M-UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txt&crarr;
B<b class="BLK BWHI">^XB</b> SairB<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> RefazerB<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
B---&crarr;
<b class=CYN># Tutorial de inspiração para a infraestrutura conduzida por teste no site</b>&crarr;
# https://www.adictosaltrabajo.com/2020/05/08/ansible-testing-using-molecule-with-ansible-as-verifier/&crarr;
B- name: "Infraestrutura conduzida por testes"hosts: allgather_facts: falsebecome: truetasks:- name: "Simulação: Atualizar a cache do sistema"apt:&#x232B;&#x232B;update_cache: truecache_valid_time: 3600check_mode: trueregister: estado- name: "teste: a cache encontra-se actualizada?"assert:that:- not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem actualizações pendentes"- name: "Atualizar o sistema operativo (equivalente a apt upgrade)"apt:&#x232B;&#x232B;upgrade: safecheck_mode: trueregister: estado- name: "teste: o sistema operativo encontra-se atualizado?"assert:that:- not estado.changedsuccess_msg: "SUCESSO: O sistema operativo está atualizado"&crarr;
 - not estado.changed success_msg: "SUCESSO: O sistema operativo está atualizado" fail_msg: "ERRO: Existem actualizações pendentes"&crarr;
  - name: "Teste: a cache encontra-se atualizada?"  assert:    that:    - not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"    fail_msg: "ERRO: Existem atualizações pendentes"&crarr;
  - name: "Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas"apt:&#x232B;&#x232B;pkg:  - mc  - screen- git    - apache2  - mysql-server- phpphp-mysql- php-ldap- php-cli- php-soap    - php-json  - graphviz- php-xml  - php-gd  - php-zip- libapache2-mod-php    - php-dev  - libmcrypt-dev- gccmake- autoconf&crarr;
- make- autoconf- libc-dev- pkg-config- pwgen- curl- unzip- zip- php-mbstring- expect- net-tools- python3-mysqldb- python3-aptpython3-pycurlcheck_mode: trueregister: estado&#x232B;s dependencias encontra-se instaladas?"s dependencias estavam instaladas"Faltam instalar algumas dependencias. O software pode estar parcialmente instalado"&crarr;
<b class=CYN>  # Fonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html</b>B- name: "Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque"service:name: apache2state: startedenabled: truecheck_mode: trueregister: estado&crarr;
  - name: "Teste: O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?"assert:&crarr;
  - name: "Teste: O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?"assert:that:not estado.changedsuccess_msg: "SUCESSO: O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"fail_msg: "ERRO: O serviço apache2 não se encontra correctamente instalado"&crarr;
<b class=CYN>  # Fonte: https://www.mydailytutorials.com/using-ansible-find-module-search-filesfolder</b>B- name: "Rotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2"find:paths: /etcpatterns: "php.ini"recurse: trueregister: caminho_php_ini&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html</b>B- name: "Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile."  ansible.builtin.lineinfile:  path: "{{ caminho_php_ini.files[0].path }}"regexp: "{{ item.regexp  }}"line: "{{ item.line }}"with_items:- regexp: "^file_uploads"line: "file_uploads = 1" - regexp: "^upload_max_filesize" line: "upload_max_filesize = 1G"  - regexp: "^max_file_uploads"  line: "max_file_uploads = 20"- regexp: "^post_max_size"  line: "post_max_size = 2G"  - regexp: "^memory_limit"    line: "memory_limit = 2G"- regexp: "^max_input_time" line: "max_input_time = 3600"check_mode: true&crarr;
line: "max_input_time = 3600"check_mode: trueregister: estado&#x232B;&#x232B;As linhas do php.ini encontram-se alteradas ?"ficheiro php.ini foi alterado com sucesso"Algumas alterações ao ficheiro php.ini não tiveram sucesso"<b class=CYN>O site deve existir na pasta /var/www/leantime. Este teste visa determinar se a pasta</b>&crarr;
  # existe e se temas permissões certas&crarr;
  # Fonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.htmlB- name: "Simulação: Obtem informação sobre a pastas /var/www/leantime"&crarr;
    stat:    path: "/var/www/leantime"register: pasta&crarr;
  - name: "Teste: A pasta /var/www/leantime existe e tem as permissões certas?"assert:  that:  - pasta.stat.exists- pasta.stat.isdir  - pasta.stat.mode == "0755"- pasta.stat.pw_name == "www-data"  - pasta.stat.gr_name == "www-data"success_msg: "SUCESSO: Permissões correctas no site leantime"fail_msg: "ERRO: Permissões incorrectas no site leantime ou site não existente"&crarr;
<b class=CYN>  # Outro dos requesitos é a existência de uma base de dados para o site.</b>&crarr;
  # Esta base de dados deve ser criada, logo tem de ser testada para determinar se ela existe ou não.&crarr;
  # Fonte de inspiração: https://serverfault.com/questions/173978/from-a-shell-script-how-can-i-check-whether-a-mysql-database-existsB- name: "Simulação: Verifica se é necessário criar a base de dados leantime_database"shell: "mysql -u root -e 'use leantime_database'"&crarr;
  - name: "Simulação: Verifica se é necessário criar a base de dados leantime_database"shell: "mysql -u root -e 'use leantime_database'"resultfailed_when: false  changed_when: false&crarr;
  - name: "Teste: A base de dados leantime_database existe ?"assert:that:- result.rc == 0success_msg: "SUCESSO: A base de dados leantime_database já se encontra criada" fail_msg: "ERRO: Não existe a base de dados leantime_database"&crarr;
B<b class="BLK BWHI">ModificadoB</b>&crarr;
  &crarr;
<b class=CYN>  #</b>B<b class=CYN> </b>B<b class=CYN>T</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>t</b>&crarr;
B<b class=CYN>e</b>B<b class=CYN>:</b>B<b class=CYN> </b>B<b class=CYN>O</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN>w</b>B<b class=CYN>n</b>B<b class=CYN>l</b>B<b class=CYN>o</b>B<b class=CYN>a</b>B<b class=CYN>d</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>o</b>B<b class=CYN>f</b>B<b class=CYN>t</b>B<b class=CYN>w</b>B<b class=CYN>a</b>B<b class=CYN>r</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>l</b>B<b class=CYN>e</b>B<b class=CYN>a</b>B<b class=CYN>n</b>B<b class=CYN>t</b>B<b class=CYN>i</b>B<b class=CYN>m</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>e</b>B<b class=CYN>v</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN>r</b>B<b class=CYN> </b>B<b class=CYN>p</b>B<b class=CYN>o</b>B<b class=CYN>s</b>B<b class=CYN>s</b>B<b class=CYN>í</b>B<b class=CYN>v</b>B<b class=CYN>e</b>B<b class=CYN>l</b>B<b class=CYN>,</b>B<b class=CYN> </b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>p</b>B<b class=CYN>a</b>B<b class=CYN>r</b>B<b class=CYN>t</b>B<b class=CYN>i</b>B<b class=CYN>r</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>i</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>l</b>B<b class=CYN>e</b>B<b class=CYN>a</b>B<b class=CYN>n</b>B<b class=CYN>t</b>B<b class=CYN>i</b>B<b class=CYN>m</b>B<b class=CYN>e</b>B&crarr;
  - name: "Simulação e Teste: Verifica se o endereço git para a versão de leantime existe"&crarr;
    uri:&crarr;
      url: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zip&crarr;
    register: resultado&crarr;
  &crarr;
  &crarr;

&crarr;
 line: "max_input_time = 3600"check_mode: trueestado&crarr;
  - name: "Teste: As linhas do php.ini encontram-se alteradas ?"assert:    that:  - not estado.changedsuccess_msg: "SUCESSO: O ficheiro php.ini foi alterado com sucesso"fail_msg: "ERRO: Algumas alterações ao ficheiro php.ini não tiveram sucesso"&crarr;
<b class=CYN>  # O site deve existir na pasta /var/www/leantime. Este teste visa determinar se a pasta</b>&crarr;
  # existe e se temas permissões certasFonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.htmlB: Obtem informação sobre a pastas /var/www/leantime"stat:path: "/var/www/leantime"pasta- name: "Teste: A pasta /var/www/leantime existe e tem as permissões certas?"assert:that:- pasta.stat.exists- pasta.stat.isdir- pasta.stat.mode == "0755"- pasta.stat.pw_name == "www-data"- pasta.stat.gr_name == "www-data"success_msg: "SUCESSO: Permissões correctas no site leantime"fail_msg: "ERRO: Permissões incorrectas no site leantime ou site não existente"&crarr;
<b class=CYN>  # Outro dos requesitos é a existência de uma base de dados para o site.</b>&crarr;
  # Esta base de dados deve ser criada, logo tem de ser testada para determinar se ela existe ou não.&crarr;
  # Fonte de inspiração: https://serverfault.com/questions/173978/from-a-shell-script-how-can-i-check-whether-a-mysql-database-existsB- name: "Simulação: Verifica se é necessário criar a base de dados leantime_database"shell: "mysql -u root -e 'use leantime_database'"O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?"serviço apache2 está correctamente instalado e inicia com o arranque do sistema"O serviço apache2 não se encontra correctamente instalado"<b class=CYN>Fonte: https://www.mydailytutorials.com/using-ansible-find-module-search-filesfolder</b>B&crarr;
  - name: "Rotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2"find:paths: /etcpatterns: "php.ini"recurse: true&crarr;
    register: caminho_php_ini&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html</b>B- name: "Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile."ansible.builtin.lineinfile:path: "{{ caminho_php_ini.files[0].path }}"    regexp: "{{ item.regexp  }}"  line: "{{ item.line }}"with_items:- regexp: "^file_uploads"line: "file_uploads = 1"- regexp: "^upload_max_filesize"line: "upload_max_filesize = 1G"- regexp: "^max_file_uploads"  line: "max_file_uploads = 20"- regexp: "^post_max_size"line: "post_max_size = 2G" - regexp: "^memory_limit" line: "memory_limit = 2G" - regexp: "^max_input_time" line: "max_input_time = 3600"check_mode: true- make- autoconf- libc-dev- pkg-config- pwgen- curl- unzip- zip- php-mbstring- expect- net-tools- python3-mysqldb- python3-apt- python3-pycurlcheck_mode: trueregister: estado&#x232B;&#x232B;as dependencias encontra-se instaladas?"As dependencias estavam instaladas"Faltam instalar algumas dependencias. O software pode estar parcialmente instalado"<b class=CYN> de inspiração: https://docs.ansible.com//latest/collections/ansible/builtin/service_module.html</b>BSimulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque"service:name: apache2state: startedenabledcheck_mode: trueregister: estado&crarr;
Teste: O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?"assert:not estado.changedsuccess_msg: "SUCESSO: O sistema operativo está atualizado"fail_msg: "ERRO: Existem actualizações pendentes"&crarr;
  - name: "Teste: a cache encontra-se atualizada?"assert:that:not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem atualizações pendentes"&crarr;
  - name: "Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas"apt:&#x232B;&#x232B;pkg:  - mc  - screen- git    - apache2  - mysql-server- phpphp-mysql- php-ldap- php-cli- php-soap - php-json    - graphviz  - php-xml- php-gd- php-zip- libapache2-mod-php  - php-dev  - libmcrypt-dev- gcc    - make  - autoconf&crarr;
---&crarr;
<b class=CYN># Tutorial de inspiração para a infraestrutura conduzida por teste no site</b>&crarr;
# https://www.adictosaltrabajo.com/2020/05/08/ansible-testing-using-molecule-with-ansible-as-verifier/&crarr;
B- name: "Infraestrutura conduzida por testes"hosts: allgather_facts: falsebecome: true&crarr;
  tasks:- name: "Simulação: Atualizar a cache do sistema"  apt:  update_cache: truecache_valid_time: 3600check_mode: trueregister: estado&crarr;
  - name: "teste: a cache encontra-se actualizada?"assert:that:not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem actualizações pendentes"&crarr;
  - name: "Atualizar o sistema operativo (equivalente a apt upgrade)"apt:&#x232B;&#x232B;upgrade: safecheck_mode: trueregister: estado&crarr;
  - name: "teste: o sistema operativo encontra-se atualizado?"assert:that:not estado.changedsuccess_msg: "SUCESSO: O sistema operativo está atualizado"&crarr;
- name: Variáveis&crarr;
    include_vars:&crarr;
      file: ../../vars/main.yml&crarr;

- name: "teste: o sistema operativo encontra-se atualizado?"&crarr;
 - name: Variáveis&crarr;
 &#x232B;  - name: Variáveis&crarr;
  &crarr;
         B<b class="BLK BWHI">M-DB</b> Formato DOSB<b class="BLK BWHI">M-AB</b> AnexarB<b class="BLK BWHI">BB</b> SegurançaB<b class="BLK BWHI">CB</b> Cancelar           B<b class="BLK BWHI">M-MB</b> Formato MacB<b class="BLK BWHI">M-PB</b> PreporB<b class="BLK BWHI">^TB</b> P/ ficheiros&crarr;
B<b class="BLK BWHI">Nome do ficheiro onde escrever: molecule/default/verify.yml                                                                               B</b> B<b class="BLK BWHI">[ A escrever... ]B</b>B<b class="BLK BWHI">          B</b>B<b class="BLK BWHI">[ 189 linhas escritas ]B</b>B<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> Procurar      B<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursorB<b class="BLK BWHI">UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txtB<b class="BLK BWHI">XB</b> Sair    B<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> Refazer      B<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
  - name: "teste: o sistema operativo encontra-se atualizado?"&crarr;
    assert:that: - not estado.changed    success_msg: "SUCESSO: O sistema operativo está atualizado"    fail_msg: "ERRO: Existem actualizações pendentes"&crarr;
  - name: "Teste: a cache encontra-se atualizada?"  assert:    that:  - not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem atualizações pendentes"&crarr;
  - name: "Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas"apt:&#x232B;&#x232B;pkg:  - mc  - screen- git    - apache2  - mysql-server- phpphp-mysql- php-ldap- php-cli- php-soap    - php-json  - graphviz- php-xml  - php-gd  - php-zip- libapache2-mod-php    - php-dev- libapache2-mod-php    - php-dev  - libmcrypt-dev- gccmake- autoconf- libc-dev- pkg-config    - pwgen  - curl- unzipzip- php-mbstring- expect- net-tools    - python3-mysqldb  - python3-apt- python3-pycurlcheck_mode: trueregister: estado&crarr;
  - name: "Teste: as dependencias encontra-se instaladas?"assert:that:not estado.changedsuccess_msg: "SUCESSO: As dependencias estavam instaladas"fail_msg: "ERRO: Faltam instalar algumas dependencias. O software pode estar parcialmente instalado"&crarr;
<b class=CYN>  # Fonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html</b>B- name: "Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque"service:name: apache2state: startedenabled: truecheck_mode: trueenabled: true&#x232B;O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?"O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"O serviço apache2 não se encontra correcta<b class=CYN>: https://www.mydailytutorials.com/using--find-module-search-filesfolder</b>BRotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2"find:paths: /etcpatterns: "php.ini"recurseregister: caminho_php_ini&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html</b>B- name: "Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile."ansible.builtin.lineinfile:path: "{{ caminho_php_ini.files[0].path }}"regexp: "{{ item.regexp  }}"line: "{{ item.line }}"with_items:- regexp: "^file_uploads"line: "file_uploads = 1"- regexp: "^upload_max_filesize"line: "upload_max_filesize = 1G"- regexp: "^max_file_uploads"line: "max_file_uploads = 20"- regexp: "^post_max_size"line: "post_max_size = 2G"- regexp: "^memory_limit"line: "post_max_size = 2G"- regexp: "^memory_limit"line: "memory_limit = 2G"- regexp: "^max_input_time"  line: "max_input_time = 3600"As linhas do php.ini encontram-se alteradas ?"ficheiro php.ini foi alterado com sucesso"Algumas alterações ao ficheiro php.ini não tiveram sucesso"<b class=CYN>O site deve existir na pasta /var/www/leantime. Este teste visa determinar se a pasta</b>&crarr;
  # existe e se temas permissões certas&crarr;
  # Fonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.htmlB- name: "Simulação: Obtem informação sobre a pastas /var/www/leantime"&crarr;
    stat:    path: "/var/www/leantime"register: pasta&crarr;
  - name: "Teste: A pasta /var/www/leantime existe e tem as permissões certas?"assert:  that:  - pasta.stat.exists- pasta.stat.isdir  - pasta.stat.mode == "0755"- pasta.stat.pw_name == "www-data"  - pasta.stat.gr_name == "www-data"success_msg: "SUCESSO: Permissões correctas no site leantime"fail_msg: "ERRO: Permissões incorrectas no site leantime ou site não existente"&crarr;
<b class=CYN>  # Outro dos requesitos é a existência de uma base de dados para o site.</b>B&crarr;
<b class=CYN>  # Outro dos requesitos é a existência de uma base de dados para o site.</b>&crarr;
  # Esta base de dados deve ser criada, logo tem de ser testada para determinar se ela existe ou não.&crarr;
  # Fonte de inspiração: https://serverfault.com/questions/173978/from-a-shell-script-how-can-i-check-whether-a-mysql-database-existsB- name: "Simulação: Verifica se é necessário criar a base de dados leantime_database"shell: "mysql -u root -e 'use leantime_database'"resultfailed_when: false  changed_when: false&crarr;
  - name: "Teste: A base de dados leantime_database existe ?"assert:that:- result.rc == 0success_msg: "SUCESSO: A base de dados leantime_database já se encontra criada" fail_msg: "ERRO: Não existe a base de dados leantime_database"&crarr;
<b class=CYN>Teste: O download do software leantime deve ser possível, a partir do site do leantime</b>B e Teste: Verifica se o endereço git para a versão de leantime existe"uri:&#x232B;&#x232B;url: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zipresultado&crarr;
  &crarr;
&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&crarr;

<hr>
&crarr;
admlocal@devOps:~/leantime_ansible$ nano vas&#x266A;&#x232B;&#x232B;ars/main.yml 
BB
<hr>
B<b class="BLK BWHI">[ A ler... ]B</b>B<b class="BLK BWHI">[ 4 linhas lidas ]B</b>B<b class="BLK BWHI">  GNU nano 4.8                                                 vars/main.yml                                                              B</b>&crarr;
B<b class="BLK BWHI">^GB</b> AjudaB<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> ProcurarB<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursor    B<b class="BLK BWHI">M-UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txt&crarr;
B<b class="BLK BWHI">^XB</b> SairB<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> RefazerB<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
B--- login_leantime: leantimeDBadminpassword_leantime: "#S3gr3d0S3cr3t0#"&crarr;
B<b class="BLK BWHI">ModificadoB</b>&crarr;
    versao?leantime&#x232B;&crarr;
&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;_leantime: v2.1.7&crarr;
         B<b class="BLK BWHI">M-DB</b> Formato DOSB<b class="BLK BWHI">M-AB</b> AnexarB<b class="BLK BWHI">BB</b> SegurançaB<b class="BLK BWHI">CB</b> Cancelar           B<b class="BLK BWHI">M-MB</b> Formato MacB<b class="BLK BWHI">M-PB</b> PreporB<b class="BLK BWHI">^TB</b> P/ ficheiros&crarr;
B<b class="BLK BWHI">Nome do ficheiro onde escrever: vars/main.yml                                                                                             B</b> B<b class="BLK BWHI">[ A escrever... ]B</b>B<b class="BLK BWHI">          B</b>B<b class="BLK BWHI">[ 5 linhas escritas ]B</b>B<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> Procurar      B<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursorB<b class="BLK BWHI">UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txtB<b class="BLK BWHI">XB</b> Sair    B<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> Refazer      B<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;

<hr>
&crarr;
admlocal@devOps:~/leantime_ansible$ molecule lint
<b class=BLU>INFO    </b> default scenario test matrix: dependency, lint
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>dependency</b>
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>lint</b>
COMMAND: set -e
yamllint .
ansible-lint

./molecule/default/verify.yml
  189:1     error    too many blank lines (2 &gt; 0)  (empty-lines)

<b class=HIR>CRITICAL</b> Lint failed with error code <b class=HIC>1</b>
admlocal@devOps:~/leantime_ansible$ molecule lint&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;nano vars/main.yml &#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;molecule/default/verify     &#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;exit&#x232B;&#x232B;&#x232B;&#x232B;nano molecule/default/verify.yml 
BB
<hr>
B<b class="BLK BWHI">[ A ler... ]B</b>B<b class="BLK BWHI">[ 189 linhas lidas ]B</b>B<b class="BLK BWHI">  GNU nano 4.8                                          molecule/default/verify.yml                                                       B</b>&crarr;
B<b class="BLK BWHI">^GB</b> AjudaB<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> ProcurarB<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursor    B<b class="BLK BWHI">M-UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txt&crarr;
B<b class="BLK BWHI">^XB</b> SairB<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> RefazerB<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
B---&crarr;
<b class=CYN># Tutorial de inspiração para a infraestrutura conduzida por teste no site</b>&crarr;
# https://www.adictosaltrabajo.com/2020/05/08/ansible-testing-using-molecule-with-ansible-as-verifier/&crarr;
B- name: "Infraestrutura conduzida por testes"hosts: allgather_facts: falsebecome: truetasks:- name: Variáveisinclude_vars:file: ../../vars/main.yml- name: "Simulação: Atualizar a cache do sistema"apt:&#x232B;&#x232B;update_cache: truecache_valid_time: 3600check_mode: trueregister: estado- name: "teste: a cache encontra-se actualizada?"assert:that:- not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem actualizações pendentes"- name: "Atualizar o sistema operativo (equivalente a apt upgrade)"apt:&#x232B;&#x232B;upgrade: safecheck_mode: trueregister: estado- name: "teste: o sistema operativo encontra-se atualizado?"&crarr;
  - name: "teste: o sistema operativo encontra-se atualizado?"&crarr;
    assert:that: - not estado.changed    success_msg: "SUCESSO: O sistema operativo está atualizado"    fail_msg: "ERRO: Existem actualizações pendentes"&crarr;
  - name: "Teste: a cache encontra-se atualizada?"  assert:    that:  - not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem atualizações pendentes"&crarr;
  - name: "Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas"apt:&#x232B;&#x232B;pkg:  - mc  - screen- git    - apache2  - mysql-server- phpphp-mysql- php-ldap- php-cli- php-soap    - php-json  - graphviz- php-xml  - php-gd  - php-zip- libapache2-mod-php    - php-dev&crarr;
- libapache2-mod-php    - php-dev  - libmcrypt-dev- gccmake- autoconf- libc-dev- pkg-config    - pwgen  - curl- unzipzip- php-mbstring- expect- net-tools    - python3-mysqldb  - python3-apt- python3-pycurlcheck_mode: trueregister: estado&crarr;
  - name: "Teste: as dependencias encontra-se instaladas?"assert:that:not estado.changedsuccess_msg: "SUCESSO: As dependencias estavam instaladas"fail_msg: "ERRO: Faltam instalar algumas dependencias. O software pode estar parcialmente instalado"&crarr;
<b class=CYN>  # Fonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html</b>B- name: "Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque"service:name: apache2state: startedenabled: truecheck_mode: true&crarr;
enabled: true&#x232B;O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?"O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"O serviço apache2 não se encontra correcta<b class=CYN>: https://www.mydailytutorials.com/using--find-module-search-filesfolder</b>BRotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2"find:paths: /etcpatterns: "php.ini"recurseregister: caminho_php_ini&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html</b>B- name: "Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile."ansible.builtin.lineinfile:path: "{{ caminho_php_ini.files[0].path }}"regexp: "{{ item.regexp  }}"line: "{{ item.line }}"with_items:- regexp: "^file_uploads"line: "file_uploads = 1"- regexp: "^upload_max_filesize"line: "upload_max_filesize = 1G"- regexp: "^max_file_uploads"line: "max_file_uploads = 20"- regexp: "^post_max_size"line: "post_max_size = 2G"- regexp: "^memory_limit"&crarr;
line: "post_max_size = 2G"- regexp: "^memory_limit"line: "memory_limit = 2G"- regexp: "^max_input_time"  line: "max_input_time = 3600"As linhas do php.ini encontram-se alteradas ?"ficheiro php.ini foi alterado com sucesso"Algumas alterações ao ficheiro php.ini não tiveram sucesso"<b class=CYN>O site deve existir na pasta /var/www/leantime. Este teste visa determinar se a pasta</b>&crarr;
  # existe e se temas permissões certas&crarr;
  # Fonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.htmlB- name: "Simulação: Obtem informação sobre a pastas /var/www/leantime"&crarr;
    stat:    path: "/var/www/leantime"register: pasta&crarr;
  - name: "Teste: A pasta /var/www/leantime existe e tem as permissões certas?"assert:  that:  - pasta.stat.exists- pasta.stat.isdir  - pasta.stat.mode == "0755"- pasta.stat.pw_name == "www-data"  - pasta.stat.gr_name == "www-data"success_msg: "SUCESSO: Permissões correctas no site leantime"fail_msg: "ERRO: Permissões incorrectas no site leantime ou site não existente"&crarr;
<b class=CYN>  # Outro dos requesitos é a existência de uma base de dados para o site.</b>&crarr;
B<b class=CYN>  # Outro dos requesitos é a existência de uma base de dados para o site.</b>&crarr;
  # Esta base de dados deve ser criada, logo tem de ser testada para determinar se ela existe ou não.&crarr;
  # Fonte de inspiração: https://serverfault.com/questions/173978/from-a-shell-script-how-can-i-check-whether-a-mysql-database-existsB- name: "Simulação: Verifica se é necessário criar a base de dados leantime_database"shell: "mysql -u root -e 'use leantime_database'"resultfailed_when: false  changed_when: false&crarr;
  - name: "Teste: A base de dados leantime_database existe ?"assert:that:- result.rc == 0success_msg: "SUCESSO: A base de dados leantime_database já se encontra criada" fail_msg: "ERRO: Não existe a base de dados leantime_database"&crarr;
<b class=CYN>Teste: O download do software leantime deve ser possível, a partir do site do leantime</b>B e Teste: Verifica se o endereço git para a versão de leantime existe"uri:&#x232B;&#x232B;url: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zipresultado&crarr;
B<b class="BLK BWHI">ModificadoB</b>&crarr;
&crarr;
         B<b class="BLK BWHI">M-DB</b> Formato DOSB<b class="BLK BWHI">M-AB</b> AnexarB<b class="BLK BWHI">BB</b> SegurançaB<b class="BLK BWHI">CB</b> Cancelar           B<b class="BLK BWHI">M-MB</b> Formato MacB<b class="BLK BWHI">M-PB</b> PreporB<b class="BLK BWHI">^TB</b> P/ ficheiros&crarr;
B<b class="BLK BWHI">Nome do ficheiro onde escrever: molecule/default/verify.yml                                                                               B</b> B<b class="BLK BWHI">[ A escrever... ]B</b>B<b class="BLK BWHI">          B</b>B<b class="BLK BWHI">[ 187 linhas escritas ]B</b>B<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> Procurar      B<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursorB<b class="BLK BWHI">UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txtB<b class="BLK BWHI">XB</b> Sair    B<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> Refazer      B<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;

<hr>
&crarr;
admlocal@devOps:~/leantime_ansible$ nano molecule/default/verify.yml &#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;molecule lint
<b class=BLU>INFO    </b> default scenario test matrix: dependency, lint
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>dependency</b>
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>lint</b>
COMMAND: set -e
yamllint .
ansible-lint

Loading custom .yamllint config file, this extends our internal yamllint config.
WARNING  Listing 1 violation(s) that are fatal
<b style="color:#ff5555;">yaml</b><b class=HIK>:</b> <b class=RED>too many blank lines (1 &gt; 0)</b> <b class=HIK style="color:#ff5555;">(empty-lines)</b>
<b class=BLU>.ansible-lint</b>:3

You can skip specific rules or tags by adding them to your configuration file:
<b class=HIK># .ansible-lint</b>
<b style="color:#5555ff;">warn_list</b>:  <b class=HIK># or 'skip_list' to silence them completely</b>
  - yaml  <b class=HIK># Violations reported by yamllint</b>
Finished with <b class=HIC>1</b> failure<b class="BOLD">(</b>s<b class="BOLD">)</b>, <b class=HIC>0</b> warning<b class="BOLD">(</b>s<b class="BOLD">)</b> on <b class=HIC>40</b> files.
<b class=HIR>CRITICAL</b> Lint failed with error code <b class=HIC>2</b>
admlocal@devOps:~/leantime_ansible$ molecule lint&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;nano molecule/default/verify.yml 
BB
<hr>
B<b class="BLK BWHI">[ A ler... ]B</b>B<b class="BLK BWHI">[ 187 linhas lidas ]B</b>B<b class="BLK BWHI">  GNU nano 4.8                                          molecule/default/verify.yml                                                       B</b>&crarr;
B<b class="BLK BWHI">^GB</b> AjudaB<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> ProcurarB<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursor    B<b class="BLK BWHI">M-UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txt&crarr;
B<b class="BLK BWHI">^XB</b> SairB<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> RefazerB<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
B---&crarr;
<b class=CYN># Tutorial de inspiração para a infraestrutura conduzida por teste no site</b>&crarr;
# https://www.adictosaltrabajo.com/2020/05/08/ansible-testing-using-molecule-with-ansible-as-verifier/&crarr;
B- name: "Infraestrutura conduzida por testes"hosts: allgather_facts: falsebecome: truetasks:- name: Variáveisinclude_vars:file: ../../vars/main.yml- name: "Simulação: Atualizar a cache do sistema"apt:&#x232B;&#x232B;update_cache: truecache_valid_time: 3600check_mode: trueregister: estado- name: "teste: a cache encontra-se actualizada?"assert:that:- not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem actualizações pendentes"- name: "Atualizar o sistema operativo (equivalente a apt upgrade)"apt:&#x232B;&#x232B;upgrade: safecheck_mode: trueregister: estado- name: "teste: o sistema operativo encontra-se atualizado?"&crarr;
         In. parágB<b class="BLK BWHI">^YB</b> Prim.linhaB<b class="BLK BWHI">^TB</b> Ir para txtB<b class="BLK BWHI">CB</b> Cancelar           B<b class="BLK BWHI">OB</b> Fim parágB<b class="BLK BWHI">VB</b> Últ. linha&crarr;
B<b class="BLK BWHI">Insira nº da linha, nº da coluna:                                                                                                         B</b>B<b class="BLK BWHI">1</b>&crarr;
BB<b class="BLK BWHI">8</b>&crarr;
BB<b class="BLK BWHI">9</b>&crarr;
B&crarr;
B<b class="BLK BWHI">^OB</b> GravarProcurar      B<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursor    B<b class="BLK BWHI">M-UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txtB<b class="BLK BWHI">XB</b> Sair    B<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txtB<b class="BLK BWHI">TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> RefazerB<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
shell: "mysql -u root -e 'use leantime_database'"register: resultfailed_when: falsechanged_when: falseTA base de dados leantime_database existe ?"result.rc == 0base de dados leantime_database já se encontra criada"Não existe a base de dados leantime_database"&crarr;
<b class=CYN>  # Teste: O download do software leantime deve ser possível, a partir do site do leantime</b>B- name: "Simulação e Teste: Verifica se o endereço git para a versão de leantime existe"uri:  url: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zipresultado&crarr;
&crarr;
&crarr;
&crarr;
         B<b class="BLK BWHI">M-DB</b> Formato DOSB<b class="BLK BWHI">M-AB</b> AnexarB<b class="BLK BWHI">BB</b> SegurançaB<b class="BLK BWHI">CB</b> Cancelar           B<b class="BLK BWHI">M-MB</b> Formato MacB<b class="BLK BWHI">M-PB</b> PreporB<b class="BLK BWHI">^TB</b> P/ ficheiros&crarr;
B<b class="BLK BWHI">Nome do ficheiro onde escrever: molecule/default/verify.yml                                                                               B</b> B<b class="BLK BWHI">[ A escrever... ]B</b>B<b class="BLK BWHI">[ 187 linhas escritas ]B</b>B<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> Procurar      B<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursorB<b class="BLK BWHI">UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txtB<b class="BLK BWHI">XB</b> Sair    B<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> Refazer      B<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
&crarr;

<hr>
&crarr;
admlocal@devOps:~/leantime_ansible$ nano molecule/default/verify.yml &#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;molecule lint
<b class=BLU>INFO    </b> default scenario test matrix: dependency, lint
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>dependency</b>
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>lint</b>
COMMAND: set -e
yamllint .
ansible-lint

Loading custom .yamllint config file, this extends our internal yamllint config.
WARNING  Listing 1 violation(s) that are fatal
<b style="color:#ff5555;">yaml</b><b class=HIK>:</b> <b class=RED>too many blank lines (1 &gt; 0)</b> <b class=HIK style="color:#ff5555;">(empty-lines)</b>
<b class=BLU>.ansible-lint</b>:3

You can skip specific rules or tags by adding them to your configuration file:
<b class=HIK># .ansible-lint</b>
<b style="color:#5555ff;">warn_list</b>:  <b class=HIK># or 'skip_list' to silence them completely</b>
  - yaml  <b class=HIK># Violations reported by yamllint</b>
Finished with <b class=HIC>1</b> failure<b class="BOLD">(</b>s<b class="BOLD">)</b>, <b class=HIC>0</b> warning<b class="BOLD">(</b>s<b class="BOLD">)</b> on <b class=HIC>40</b> files.
<b class=HIR>CRITICAL</b> Lint failed with error code <b class=HIC>2</b>
admlocal@devOps:~/leantime_ansible$ nano .ansible-lint 
BB
<hr>
B<b class="BLK BWHI">[ A ler... ]B</b>B<b class="BLK BWHI">[ 3 linhas lidas ]B</b>B<b class="BLK BWHI">  GNU nano 4.8                                                 .ansible-lint                                                              B</b>&crarr;
B<b class="BLK BWHI">^GB</b> AjudaB<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> ProcurarB<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursor    B<b class="BLK BWHI">M-UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txt&crarr;
B<b class="BLK BWHI">^XB</b> SairB<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> RefazerB<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
Bskip_list:  # or 'skip_list' to silence them completely- command-instead-of-shell&crarr;
B<b class="BLK BWHI">ModificadoB</b>&crarr;
&crarr;
&#x232B;&crarr;
&crarr;
&crarr;
         B<b class="BLK BWHI">M-DB</b> Formato DOSB<b class="BLK BWHI">M-AB</b> AnexarB<b class="BLK BWHI">BB</b> SegurançaB<b class="BLK BWHI">CB</b> Cancelar           B<b class="BLK BWHI">M-MB</b> Formato MacB<b class="BLK BWHI">M-PB</b> PreporB<b class="BLK BWHI">^TB</b> P/ ficheiros&crarr;
B<b class="BLK BWHI">Nome do ficheiro onde escrever: .ansible-lint                                                                                             B</b> B<b class="BLK BWHI">[ A escrever... ]B</b>B<b class="BLK BWHI">          B</b>B<b class="BLK BWHI">[ 2 linhas escritas ]B</b>B<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> Procurar      B<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursorB<b class="BLK BWHI">UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txtB<b class="BLK BWHI">XB</b> Sair    B<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> Refazer      B<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;

<hr>
&crarr;
admlocal@devOps:~/leantime_ansible$ nano .ansible-lint &#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;molecule lint
<b class=BLU>INFO    </b> default scenario test matrix: dependency, lint
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>dependency</b>
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>lint</b>
COMMAND: set -e
yamllint .
ansible-lint

Loading custom .yamllint config file, this extends our internal yamllint config.
admlocal@devOps:~/leantime_ansible$ molecule verify
<b class=BLU>INFO    </b> default scenario test matrix: verify
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>verify</b>
<b class=BLU>INFO    </b> Running Ansible Verifier

PLAY [Infraestrutura conduzida por testes] ***********************************************************************************************

TASK [Variáveis] *************************************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Atualizar a cache do sistema] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [teste: a cache encontra-se actualizada?] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Atualizar o sistema operativo (equivalente a apt upgrade)] *************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [teste: o sistema operativo encontra-se atualizado?] ********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O sistema operativo está atualizado"</b>
<b class=GRN>}</b>

TASK [Teste: a cache encontra-se atualizada?] ********************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas] ****************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: as dependencias encontra-se instaladas?] ************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: As dependencias estavam instaladas"</b>
<b class=GRN>}</b>

TASK [Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque] ****************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?] ***********************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"</b>
<b class=GRN>}</b>

TASK [Rotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2] ********************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile.] ****************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})</b>

TASK [Teste: As linhas do php.ini encontram-se alteradas ?] ******************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O ficheiro php.ini foi alterado com sucesso"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre a pastas /var/www/leantime] **********************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: A pasta /var/www/leantime existe e tem as permissões certas?] ***************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas no site leantime"</b>
<b class=GRN>}</b>

TASK [Simulação: Verifica se é necessário criar a base de dados leantime_database] *******************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: A base de dados leantime_database existe ?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A base de dados leantime_database já se encontra criada"</b>
<b class=GRN>}</b>

TASK [Simulação e Teste: Verifica se o endereço git para a versão de leantime existe] ****************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

PLAY RECAP *******************************************************************************************************************************
<b class=GRN>ubuntu-20.04</b>               : <b class=GRN>ok=18  </b> changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0

<b class=BLU>INFO    </b> Verifier completed successfully.
admlocal@devOps:~/leantime_ansible$ exit
exit
</pre>
</body>
</html>
