<!DOCTYPE html>
<html>
<head>
<style type="text/css">
body {background-color: black;}
pre {
	font-weight: normal;
	color: #bbb;
	white-space: -moz-pre-wrap;
	white-space: -o-pre-wrap;
	white-space: -pre-wrap;
	white-space: pre-wrap;
	word-wrap: break-word;
	overflow-wrap: break-word;
}
b {font-weight: normal}
b.BOLD {color: #fff}
b.ITA {font-style: italic}
b.UND {text-decoration: underline}
b.STR {text-decoration: line-through}
b.UNDSTR {text-decoration: underline line-through}
b.BLK {color: #000000}
b.RED {color: #aa0000}
b.GRN {color: #00aa00}
b.YEL {color: #aa5500}
b.BLU {color: #0000aa}
b.MAG {color: #aa00aa}
b.CYN {color: #00aaaa}
b.WHI {color: #aaaaaa}
b.HIK {color: #555555}
b.HIR {color: #ff5555}
b.HIG {color: #55ff55}
b.HIY {color: #ffff55}
b.HIB {color: #5555ff}
b.HIM {color: #ff55ff}
b.HIC {color: #55ffff}
b.HIW {color: #ffffff}
b.BBLK {background-color: #000000}
b.BRED {background-color: #aa0000}
b.BGRN {background-color: #00aa00}
b.BYEL {background-color: #aa5500}
b.BBLU {background-color: #0000aa}
b.BMAG {background-color: #aa00aa}
b.BCYN {background-color: #00aaaa}
b.BWHI {background-color: #aaaaaa}
</style>
</head>
<body>
<pre>admlocal@devOps:~/leantime_ansible$ nano ver&#x232B;&#x232B;&#x232B;molecule/default/verify.yml 
BB
<hr>
B<b class="BLK BWHI">[ A ler... ]B</b>B<b class="BLK BWHI">[ 334 linhas lidas ]B</b>B<b class="BLK BWHI">  GNU nano 4.8                                          molecule/default/verify.yml                                                       B</b>&crarr;
B<b class="BLK BWHI">^GB</b> AjudaB<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> ProcurarB<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursor    B<b class="BLK BWHI">M-UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txt&crarr;
B<b class="BLK BWHI">^XB</b> SairB<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> RefazerB<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
B---&crarr;
<b class=CYN># Tutorial de inspiração para a infraestrutura conduzida por teste no site</b>&crarr;
# https://www.adictosaltrabajo.com/2020/05/08/ansible-testing-using-molecule-with-ansible-as-verifier/&crarr;
B- name: "Infraestrutura conduzida por testes"hosts: allgather_facts: falsebecome: truetasks:- name: Variáveisinclude_vars:file: ../../vars/main.yml- name: "Simulação: Atualizar a cache do sistema"apt:&#x232B;&#x232B;update_cache: truecache_valid_time: 3600check_mode: trueregister: estado- name: "teste: a cache encontra-se actualizada?"assert:that:- not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem actualizações pendentes"- name: "Atualizar o sistema operativo (equivalente a apt upgrade)"apt:&#x232B;&#x232B;upgrade: safecheck_mode: trueregister: estado- name: "teste: o sistema operativo encontra-se atualizado?"&crarr;
  - name: "teste: o sistema operativo encontra-se atualizado?"&crarr;
    assert:that: - not estado.changed    success_msg: "SUCESSO: O sistema operativo está atualizado"    fail_msg: "ERRO: Existem actualizações pendentes"&crarr;
  - name: "Teste: a cache encontra-se atualizada?"  assert:    that:  - not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem atualizações pendentes"&crarr;
  - name: "Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas"apt:&#x232B;&#x232B;pkg:  - mc  - screen- git    - apache2  - mysql-server- phpphp-mysql- php-ldap- php-cli- php-soap    - php-json  - graphviz- php-xml  - php-gd  - php-zip- libapache2-mod-php    - php-dev&crarr;
- libapache2-mod-php    - php-dev  - libmcrypt-dev- gccmake- autoconf- libc-dev- pkg-config    - pwgen  - curl- unzipzip- php-mbstring- expect- net-tools    - python3-mysqldb  - python3-apt- python3-pycurlcheck_mode: trueregister: estado&crarr;
  - name: "Teste: as dependencias encontra-se instaladas?"assert:that:not estado.changedsuccess_msg: "SUCESSO: As dependencias estavam instaladas"fail_msg: "ERRO: Faltam instalar algumas dependencias. O software pode estar parcialmente instalado"&crarr;
<b class=CYN>  # Fonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html</b>B- name: "Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque"service:name: apache2state: startedenabled: truecheck_mode: true&crarr;
enabled: true&#x232B;O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?"O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"O serviço apache2 não se encontra correcta<b class=CYN>: https://www.mydailytutorials.com/using--find-module-search-filesfolder</b>BRotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2"find:paths: /etcpatterns: "php.ini"recurseregister: caminho_php_ini&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html</b>B- name: "Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile."ansible.builtin.lineinfile:path: "{{ caminho_php_ini.files[0].path }}"regexp: "{{ item.regexp  }}"line: "{{ item.line }}"with_items:- regexp: "^file_uploads"line: "file_uploads = 1"- regexp: "^upload_max_filesize"line: "upload_max_filesize = 1G"- regexp: "^max_file_uploads"line: "max_file_uploads = 20"- regexp: "^post_max_size"line: "post_max_size = 2G"- regexp: "^memory_limit"&crarr;
line: "post_max_size = 2G"- regexp: "^memory_limit"line: "memory_limit = 2G"- regexp: "^max_input_time"  line: "max_input_time = 3600"As linhas do php.ini encontram-se alteradas ?"ficheiro php.ini foi alterado com sucesso"Algumas alterações ao ficheiro php.ini não tiveram sucesso"<b class=CYN>O site deve existir na pasta /var/www/leantime. Este teste visa determinar se a pasta</b>&crarr;
  # existe e se temas permissões certas&crarr;
  # Fonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.htmlB- name: "Simulação: Obtem informação sobre a pastas /var/www/leantime"&crarr;
    stat:    path: "/var/www/leantime"register: pasta&crarr;
  - name: "Teste: A pasta /var/www/leantime existe e tem as permissões certas?"assert:  that:  - pasta.stat.exists- pasta.stat.isdir  - pasta.stat.mode == "0755"- pasta.stat.pw_name == "www-data"  - pasta.stat.gr_name == "www-data"success_msg: "SUCESSO: Permissões correctas no site leantime"fail_msg: "ERRO: Permissões incorrectas no site leantime ou site não existente"&crarr;
<b class=CYN>  # Outro dos requesitos é a existência de uma base de dados para o site.</b>&crarr;
B<b class=CYN>  # Outro dos requesitos é a existência de uma base de dados para o site.</b>&crarr;
  # Esta base de dados deve ser criada, logo tem de ser testada para determinar se ela existe ou não.&crarr;
  # Fonte de inspiração: https://serverfault.com/questions/173978/from-a-shell-script-how-can-i-check-whether-a-mysql-database-existsB- name: "Simulação: Verifica se é necessário criar a base de dados leantime_database"shell: "mysql -u root -e 'use leantime_database'"resultfailed_when: false  changed_when: false&crarr;
  - name: "Teste: A base de dados leantime_database existe ?"assert:that:- result.rc == 0success_msg: "SUCESSO: A base de dados leantime_database já se encontra criada"fail_msg: "ERRO: Não existe a base de dados leantime_database"&crarr;
<b class=CYN>  # Teste: O download do software leantime deve ser possível, a partir do site do leantime</b>B- name: "Simulação e Teste: Verifica se o endereço git para a versão de leantime existe"uri:&#x232B;&#x232B;url: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zipregister: resultado<b class=CYN>Teste: Do ficheiro configuration.php no site do leantime. A existência deste ficheiro       com as permissões certas indica que o processo de unzip correu bemDocumentação oficial em: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html</b>Bo ficheiro /var/www/leantime/config/configuration.php"/config/configuration.php"ficheiroO ficheiro /var/www/leantime/config/configuration.php existe e tem as permissões certas?"ficheiro.stat.exists&crarr;
that: - ficheiro.stat.exists - ficheiro.stat.isreg - ficheiro.stat.mode == "0755" - ficheiro.stat.pw_name == "www-data"    - ficheiro.stat.gr_name == "www-data"  success_msg: "SUCESSO: Permissões correctas e ficheiro configuration.php existente"  fail_msg: "ERRO: Permissões incorrectas ou ficheiro configuration.php não existente"&crarr;
<b class=CYN>  # Teste: O ficheiro /var/www/leantime/config/configuration.php necessita de ser alterado.</b>&crarr;
  # As variáveis dbuser, dbDatabase, e dbPassword necessitam de estar configuradas.&crarr;
  # Por simulação o sistema vai determinar se estas estão configuradas com o valor esperado.&crarr;
  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.htmlB- name: "Simulação: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o módulo replace."ansible.builtin.replace:path: /var/www/leantime/config/configuration.phpregexp: 'dbUser=""' replace: 'dbUser="{{ login_leantime }}"'  check_mode: yesregister: conffailed_when: false&crarr;
  - name: "Teste: O dbUser foi alterado?"&crarr;
    assert: that: - conf is not changed    - conf is not failed  success_msg: "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"fail_msg: "ERRO: O dbUser não foi alterado no ficheiro configuration.php"&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html</b>B- name: "Simulação: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o módulo replace."ansible.builtin.replace:path: /var/www/leantime/config/configuration.php&crarr;
    ansible.builtin.replace:path: /var/www/leantime/config/configuration.phpregexp: 'dbDatabase=""'replace: 'dbDatabase="leantime_database"'check_mode: yesregister: conffailed_when: false&crarr;
  - name: "Teste: a variável dbDatabase foi alterada?"&crarr;
    assert: that: - conf is not changed - conf is not failed    success_msg: "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"  fail_msg: "ERRO: O dbDatabase não foi alterado no ficheiro configuration.php"&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html</b>B- name: "Simulação: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o módulo replace."ansible.builtin.replace:  path: /var/www/leantime/config/configuration.php  regexp: 'dbPassword=""'replace: 'dbPassword="{{ password_leantime }}"'  check_mode: yesregister: conffailed_when: false&crarr;
  - name: "Teste: O dbPassword foi alterado?"assert:that:- conf is not changed- conf is not failed success_msg: "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"    fail_msg: "ERRO: O dbPassword não foi alterado no ficheiro configuration.php"&crarr;
<b class=CYN>  # A configuração do site leantime necessita que seja criado um site através de um ficheiro de</b>&crarr;
B<b class=CYN>  # A configuração do site leantime necessita que seja criado um site através de um ficheiro de</b>&crarr;
  # configuração, dentro das pasta do apache2. Deve existir um ficheiro de configuração do&crarr;
  # leantime em (/etc/apache2/sites-availableB&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html</b>B- name: "Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-available/leantime.conf"stat:path: "/etc/apache2/sites-available/leantime.conf"  register: ficheiro&crarr;
  - name: "Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permissões certas?"assert:that:  - ficheiro.stat.exists  - ficheiro.stat.isreg- ficheiro.stat.mode == "0777" - ficheiro.stat.pw_name == "root" - ficheiro.stat.gr_name == "www-data"  success_msg: "SUCESSO: Permissões correctas"fail_msg: "ERRO: Permissões incorrectas"&crarr;
<b class=CYN>  # O site deve estar ativo no apache. Este teste vai verificar se o site se encontra ativo</b>&crarr;
  # https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.htmlB- name: "Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf"stat:path: "/etc/apache2/sites-enabled/leantime.conf"  register: ficheiro&crarr;
  - name: "Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permissões certas?"assert:that:  - ficheiro.stat.exists  - ficheiro.stat.islnk- ficheiro.stat.mode == "0777" - ficheiro.stat.pw_name == "root"&crarr;
- ficheiro.stat.mode == "0777" - ficheiro.stat.pw_name == "root" - ficheiro.stat.gr_name == "root" success_msg: "SUCESSO: Permissões correctas" fail_msg: "ERRO: Permissões incorrectas"&crarr;
<b class=CYN>  # https//docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html</b>B- name: "Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/000-default.conf"stat:path: "/etc/apache2/sites-enabled/000-default.conf"  register: ficheiro&crarr;
  - name: "Teste: O ficheiro /etc/apache2/sites-enabled/000-default.conf NÃO existe?"assert:that:&#x232B;not ficheiro.stat.exists&crarr;
  - name: "Simulação: Activa o módulo mod_rewrite no apache"apache2_module:name: rewritestate: present&crarr;
    check_mode: true&crarr;
    register: estado&crarr;
  - name: "Simulação: Activa o módulo mod_rewrite no apache"apache2_module:  name: rewritestate: present  check_mode: trueregister: estado&crarr;
  - name: "Teste: o mod_rewrite do apache encontra-se ativo?"assert:that:- not estado.changed&crarr;
that:- not estado.changedsuccess_msg: "SUCESSO: mod_rewrite encontra-se instalado e ativo"fail_msg: "ERRO: mod_rewrite não instalado ou não ativo!"&crarr;
B<b class="BLK BWHI">ModificadoB</b>&crarr;
 &#x232B;  &crarr;
<b class=CYN>  #</b>B<b class=CYN> </b>B<b class=CYN>T</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN>:</b>B<b class=CYN> </b>B<b class=CYN>V</b>B<b class=CYN>e</b>B<b class=CYN>r</b>B<b class=CYN>i</b>B<b class=CYN>f</b>B<b class=CYN>i</b>B<b class=CYN>c</b>B<b class=CYN>a</b>B<b class=CYN>r</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>i</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN>m</b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>e</b>B<b class=CYN>n</b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>n</b>B<b class=CYN>t</b>B<b class=CYN>r</b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>e</b>B<b class=CYN>v</b>B<b class=CYN>i</b>B<b class=CYN>d</b>B<b class=CYN>a</b>B<b class=CYN>m</b>B<b class=CYN>e</b>B<b class=CYN>n</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>i</b>B<b class=CYN>n</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>a</b>B<b class=CYN>l</b>B<b class=CYN>a</b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>n</b>B<b class=CYN>f</b>B<b class=CYN>i</b>B<b class=CYN>g</b>B<b class=CYN>u</b>B<b class=CYN>r</b>B<b class=CYN>a</b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN>.</b>B&crarr;
  &crarr;
<b class=CYN>  #</b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN>S</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>b</b>B<b class=CYN>a</b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>a</b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN>s</b>B<b class=CYN> </b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>i</b>B<b class=CYN>v</b>B<b class=CYN>e</b>B<b class=CYN>r</b>B<b class=CYN> </b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>r</b>B<b class=CYN>re</b>B<b class=CYN>c</b>B<b class=CYN>t</b>B<b class=CYN>a</b>B<b class=CYN>m</b>B<b class=CYN>e</b>B<b class=CYN>n</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>n</b>B<b class=CYN>f</b>B<b class=CYN>i</b>B<b class=CYN>g</b>B<b class=CYN>u</b>B<b class=CYN>r</b>B<b class=CYN>a</b>B<b class=CYN>d</b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>a</b>B<b class=CYN>d</b>B<b class=CYN>m</b>B<b class=CYN>i</b>B<b class=CYN>n</b>B<b class=CYN>i</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>r</b>B<b class=CYN>a</b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN>r</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>o</b>B&crarr;
  &crarr;
<b class=CYN>  #</b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>i</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN>m</b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>i</b>B<b class=CYN>v</b>B<b class=CYN>e</b>B<b class=CYN>r</b>B<b class=CYN> </b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>n</b>B<b class=CYN>f</b>B<b class=CYN>i</b>B<b class=CYN>g</b>B<b class=CYN>u</b>B<b class=CYN>r</b>B<b class=CYN>a</b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN>,</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>e</b>B<b class=CYN>v</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN>r</b>B<b class=CYN> </b>B<b class=CYN>p</b>B<b class=CYN>o</b>B<b class=CYN>s</b>B<b class=CYN>s</b>B<b class=CYN>í</b>B<b class=CYN>v</b>B<b class=CYN>e</b>B<b class=CYN>l</b>B<b class=CYN> </b>B<b class=CYN>f</b>B<b class=CYN>a</b>B<b class=CYN>z</b>B<b class=CYN>e</b>B<b class=CYN>r</b>B<b class=CYN> </b>B<b class=CYN>l</b>B<b class=CYN>o</b>B<b class=CYN>g</b>B<b class=CYN>i</b>B<b class=CYN>n</b>B<b class=CYN> </b>B<b class=CYN>a</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>i</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN>m</b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN>m</b>B<b class=CYN> </b>B<b class=CYN>p</b>B<b class=CYN>r</b>B<b class=CYN>o</b>B<b class=CYN>b</b>B<b class=CYN>l</b>B<b class=CYN>e</b>B<b class=CYN>m</b>B<b class=CYN>a</b>B<b class=CYN>s</b>B<b class=CYN>.</b>B&crarr;
  &crarr;
<b class=CYN>  #</b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN> </b>B<b class=CYN>E</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN>m</b>B<b class=CYN> </b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>m</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>o</b>B<b class=CYN>b</b>B<b class=CYN>j</b>B<b class=CYN>e</b>B<b class=CYN>t</b>B<b class=CYN>i</b>B<b class=CYN>v</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>v</b>B<b class=CYN>e</b>B<b class=CYN>r</b>B<b class=CYN>i</b>B<b class=CYN>f</b>B<b class=CYN>i</b>B<b class=CYN>c</b>B<b class=CYN>a</b>B<b class=CYN>r</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>é</b>B<b class=CYN> </b>B<b class=CYN>p</b>B<b class=CYN>o</b>B<b class=CYN>s</b>B<b class=CYN>s</b>B<b class=CYN>í</b>B<b class=CYN>v</b>B<b class=CYN>e</b>B<b class=CYN>l</b>B<b class=CYN> </b>B<b class=CYN>f</b>B<b class=CYN>a</b>B<b class=CYN>z</b>B<b class=CYN>e</b>B<b class=CYN>r</b>B<b class=CYN> </b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>l</b>B<b class=CYN>o</b>B<b class=CYN>g</b>B<b class=CYN>i</b>B<b class=CYN>n</b>B&crarr;
  &crarr;
<b class=CYN>  #</b>B<b class=CYN> </b>B<b class=CYN>A</b>B<b class=CYN>t</b>B<b class=CYN>r</b>B<b class=CYN>a</b>B<b class=CYN>v</b>B<b class=CYN>é</b>B<b class=CYN>s</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>B</b>B<b class=CYN>u</b>B<b class=CYN>r</b>B<b class=CYN>b</b>B<b class=CYN>S</b>B<b class=CYN>u</b>B<b class=CYN>i</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>(</b>B<b class=CYN>h</b>B<b class=CYN>t</b>B<b class=CYN>t</b>B<b class=CYN>p</b>B<b class=CYN>s</b>B<b class=CYN>:</b>B<b class=CYN>/</b>B<b class=CYN>/</b>B<b class=CYN>p</b>B<b class=CYN>o</b>B<b class=CYN>r</b>B<b class=CYN>t</b>B<b class=CYN>s</b>B<b class=CYN>w</b>B<b class=CYN>i</b>B<b class=CYN>g</b>B<b class=CYN>g</b>B<b class=CYN>e</b>B<b class=CYN>r</b>B<b class=CYN>.</b>B<b class=CYN>n</b>B<b class=CYN>e</b>B<b class=CYN>t</b>B<b class=CYN>/</b>B<b class=CYN>b</b>B<b class=CYN>u</b>B<b class=CYN>r</b>B<b class=CYN>p</b>B<b class=CYN>)</b>B<b class=CYN>,</b>B<b class=CYN> </b>B<b class=CYN>a</b>B<b class=CYN>p</b>B<b class=CYN>r</b>B<b class=CYN>e</b>B<b class=CYN>n</b>B<b class=CYN>d</b>B<b class=CYN>i</b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>n</b>B<b class=CYN>a</b>B<b class=CYN>s</b>B<b class=CYN> </b>B<b class=CYN>a</b>B<b class=CYN>u</b>B<b class=CYN>l</b>B<b class=CYN>a</b>B<b class=CYN>s</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>T</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>P</b>B<b class=CYN>e</b>B<b class=CYN>n</b>B<b class=CYN>e</b>B<b class=CYN>t</b>B<b class=CYN>r</b>B<b class=CYN>a</b>B<b class=CYN>ç</b>B<b class=CYN>ã</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>D</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN>n</b>B<b class=CYN>v</b>B<b class=CYN>o</b>B<b class=CYN>l</b>B<b class=CYN>v</b>B<b class=CYN>i</b>B<b class=CYN>m</b>B<b class=CYN>e</b>B<b class=CYN>n</b>B<b class=CYN>t</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>E</b>B<b class=CYN>x</b>B<b class=CYN>p</b>B<b class=CYN>l</b>B<b class=CYN>o</b>B<b class=CYN>i</b>B<b class=CYN>t</b>B<b class=CYN>s</b>B&crarr;
  &crarr;
<b class=CYN>  #</b>B<b class=CYN> </b>B<b class=CYN>f</b>B<b class=CYN>o</b>B<b class=CYN>i</b>B<b class=CYN> </b>B<b class=CYN>r</b>B<b class=CYN>e</b>B<b class=CYN>a</b>B<b class=CYN>l</b>B<b class=CYN>i</b>B<b class=CYN>z</b>B<b class=CYN>a</b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>u</b>B<b class=CYN>m</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>e</b>B<b class=CYN>b</b>B<b class=CYN>u</b>B<b class=CYN>g</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>s</b>B<b class=CYN>ã</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>l</b>B<b class=CYN>o</b>B<b class=CYN>g</b>B<b class=CYN>i</b>B<b class=CYN>n</b>B<b class=CYN>.</b>B<b class=CYN> </b>B<b class=CYN>C</b>B<b class=CYN>o</b>B<b class=CYN>m</b>B<b class=CYN> </b>B<b class=CYN>b</b>B<b class=CYN>a</b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>n</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>s</b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>s</b>B<b class=CYN>ã</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>f</b>B<b class=CYN>a</b>B<b class=CYN>se</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>L</b>B<b class=CYN>o</b>B<b class=CYN>g</b>B<b class=CYN>i</b>B<b class=CYN>n</b>B<b class=CYN> </b>B<b class=CYN>en</b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>n</b>B<b class=CYN>tr</b>B<b class=CYN>a</b>B<b class=CYN>-</b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>a</b>B<b class=CYN>q</b>B<b class=CYN>u</b>B<b class=CYN>i</b>B<b class=CYN> </b>B<b class=CYN>r</b>B<b class=CYN>e</b>B<b class=CYN>p</b>B<b class=CYN>l</b>B<b class=CYN>i</b>B<b class=CYN>c</b>B<b class=CYN>a</b>B<b class=CYN>d</b>B<b class=CYN>a</b>B<b class=CYN>.</b>B&crarr;
  &crarr;
<b class=CYN>  #</b>B<b class=CYN> </b>B<b class=CYN>è</b>B<b class=CYN> </b>B<b class=CYN>n</b>B<b class=CYN>e</b>B<b class=CYN>c</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>s</b>B<b class=CYN>á</b>B<b class=CYN>r</b>B<b class=CYN>io</b>B<b class=CYN> </b>B<b class=CYN>g</b>B<b class=CYN>r</b>B<b class=CYN>a</b>B<b class=CYN>v</b>B<b class=CYN>a</b>B<b class=CYN>r</b>B<b class=CYN> </b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>c</b>B<b class=CYN>k</b>B<b class=CYN>i</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>s</b>B<b class=CYN>ã</b>B<b class=CYN>o</b>B<b class=CYN>.</b>B<b class=CYN> </b>B<b class=CYN>A</b>B<b class=CYN> </b>B<b class=CYN>p</b>B<b class=CYN>á</b>B<b class=CYN>g</b>B<b class=CYN>i</b>B<b class=CYN>n</b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>o</b>B<b class=CYN>f</b>B<b class=CYN>i</b>B<b class=CYN>c</b>B<b class=CYN>i</b>B<b class=CYN>a</b>B<b class=CYN>l</b>B<b class=CYN> </b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>A</b>B<b class=CYN>n</b>B<b class=CYN>s</b>B<b class=CYN>i</b>B<b class=CYN>b</b>B<b class=CYN>l</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>n</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN>m</b>B<b class=CYN> </b>B<b class=CYN>u</b>B<b class=CYN>m</b>B<b class=CYN> </b>B<b class=CYN>e</b>B<b class=CYN>r</b>B<b class=CYN>r</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>q</b>B<b class=CYN>u</b>B<b class=CYN>e</b>B<b class=CYN> </b>B<b class=CYN>é</b>B<b class=CYN> </b>B<b class=CYN>r</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>o</b>B<b class=CYN>l</b>B<b class=CYN>v</b>B<b class=CYN>i</b>B<b class=CYN>d</b>B<b class=CYN>o</b>B<b class=CYN> </b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>m</b>B<b class=CYN> </b>B<b class=CYN>a</b>B<b class=CYN> </b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN>g</b>B<b class=CYN>u</b>B<b class=CYN>i</b>B<b class=CYN>n</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN>.</b>B<b class=CYN>.</b>B<b class=CYN>.</b>B&crarr;
  &crarr;
<b class=CYN>  #</b>B<b class=CYN> </b>B<b class=CYN>F</b>B<b class=CYN>o</b>B<b class=CYN>n</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN>:</b>B<b class=CYN> </b>B<b class=CYN>h</b>B<b class=CYN>t</b>B<b class=CYN>t</b>B<b class=CYN>p</b>B<b class=CYN>s</b>B<b class=CYN>:</b>B<b class=CYN>/</b>B<b class=CYN>/</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>a</b>B<b class=CYN>c</b>B<b class=CYN>k</b>B<b class=CYN>o</b>B<b class=CYN>v</b>B<b class=CYN>e</b>B<b class=CYN>r</b>B<b class=CYN>f</b>B<b class=CYN>l</b>B<b class=CYN>o</b>B<b class=CYN>w</b>B<b class=CYN>.</b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>m</b>B<b class=CYN>/</b>B<b class=CYN>q</b>B<b class=CYN>u</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>t</b>B<b class=CYN>i</b>B<b class=CYN>o</b>B<b class=CYN>n</b>B<b class=CYN>s</b>B<b class=CYN>/</b>B<b class=CYN>6</b>B<b class=CYN>3</b>B<b class=CYN>7</b>B<b class=CYN>9</b>B<b class=CYN>1</b>B<b class=CYN>6</b>B<b class=CYN>8</b>B<b class=CYN>9</b>B<b class=CYN>/</b>B<b class=CYN>a</b>B<b class=CYN>n</b>B<b class=CYN>s</b>B<b class=CYN>i</b>B<b class=CYN>b</b>B<b class=CYN>l</b>B<b class=CYN>e</b>B<b class=CYN>-</b>B<b class=CYN>l</b>B<b class=CYN>o</b>B<b class=CYN>o</b>B<b class=CYN>s</b>B<b class=CYN>e</b>B<b class=CYN>s</b>B<b class=CYN>-</b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>o</b>B<b class=CYN>k</b>B<b class=CYN>i</b>B<b class=CYN>e</b>B<b class=CYN>-</b>B<b class=CYN>c</b>B<b class=CYN>o</b>B<b class=CYN>n</b>B<b class=CYN>t</b>B<b class=CYN>e</b>B<b class=CYN>n</b>B<b class=CYN>t</b>B&crarr;
  - name: "Simulação: Tenta fazer login na aplicação com o utilizador criado"&crarr;
    uri:&crarr;
      url: http://localhost&crarr;
      method: POST&crarr;
      body: "username={{ login_website  }}&amp;password={{ password_website  }}&amp;redirectUrl:=/&amp;login=Login"&crarr;
      status_code: 200&crarr;
      follow_redirects: true&crarr;
    register: paginalogin&crarr;
  - name: "Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso"&crarr;
    uri:&crarr;
      url: http://localhost/calendar/showMyCalendar&crarr;
      method: GET&crarr;
      headers:&crarr;
        Cookie: "{{ paginalogin.set_cookie }}"&crarr;
      return_content: yes&crarr;
    register: paginaweb&crarr;
  - name: "Teste: Existe o texto editCompanySettings na página?"&crarr;
    assert:&crarr;
      that:&crarr;
      - "'password' not in paginaweb.content"&crarr;

      - "'editCompanySettings' in paginaweb.content"&crarr;

      success_msg: "SUCESSO: Login com sucesso. Utilizador e palavra passe iniciais correctamente criados"&crarr;

      fail_msg: "ERRO: Não foi possivel fazer login! O utilizador ou palavra passe não foram criados com sucesso!"&crarr;
esGET&crarr;
rue&#x232B;&#x232B;&crarr;
                   &#x232B;<b class=CYN>pSuite (https://portswigger.net/burp), aprendido nas aulas de Testes de Penetração e Desenvolvimento de Exploits</b>B
         B<b class="BLK BWHI">M-DB</b> Formato DOSB<b class="BLK BWHI">M-AB</b> AnexarB<b class="BLK BWHI">BB</b> SegurançaB<b class="BLK BWHI">CB</b> Cancelar           B<b class="BLK BWHI">M-MB</b> Formato MacB<b class="BLK BWHI">M-PB</b> PreporB<b class="BLK BWHI">^TB</b> P/ ficheiros&crarr;
B<b class="BLK BWHI">Nome do ficheiro onde escrever: molecule/default/verify.yml                                                                               B</b> B<b class="BLK BWHI">[ A escrever... ]B</b>B<b class="BLK BWHI">          B</b>B<b class="BLK BWHI">[ 368 linhas escritas ]B</b>B<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> Procurar      B<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursorB<b class="BLK BWHI">UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txtB<b class="BLK BWHI">XB</b> Sair    B<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> Refazer      B<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;

<hr>
&crarr;
admlocal@devOps:~/leantime_ansible$ molecule lint
<b class=BLU>INFO    </b> default scenario test matrix: dependency, lint
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>dependency</b>
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>lint</b>
COMMAND: set -e
yamllint .
ansible-lint

Loading custom .yamllint config file, this extends our internal yamllint config.
admlocal@devOps:~/leantime_ansible$ molecule verify
<b class=BLU>INFO    </b> default scenario test matrix: verify
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>verify</b>
<b class=BLU>INFO    </b> Running Ansible Verifier

PLAY [Infraestrutura conduzida por testes] ***********************************************************************************************

TASK [Variáveis] *************************************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Atualizar a cache do sistema] *******************************************************************************************
<b class=YEL>changed: [ubuntu-20.04]</b>

TASK [teste: a cache encontra-se actualizada?] *******************************************************************************************
<b class=RED>fatal: [ubuntu-20.04]: FAILED! =&gt; {</b>
<b class=RED>    "assertion": "not estado.changed",</b>
<b class=RED>    "changed": false,</b>
<b class=RED>    "evaluated_to": false,</b>
<b class=RED>    "msg": "ERRO: Existem actualizações pendentes"</b>
<b class=RED>}</b>

PLAY RECAP *******************************************************************************************************************************
<b class=RED>ubuntu-20.04</b>               : <b class=GRN>ok=2   </b> <b class=YEL>changed=1   </b> unreachable=0    <b class=RED>failed=1   </b> skipped=0    rescued=0    ignored=0


<b class=HIR>CRITICAL</b> Ansible return code was <b class=HIC>2</b>, command was: ansible-playbook --inventory <b class=MAG>/home/admlocal/.cache/molecule/leantime_ansible/default/</b><b style="color:#ff55ff;">inventory</b> --skip-tags molecule-notest,notest <b class=MAG>/home/admlocal/leantime_ansible/molecule/default/</b><b style="color:#ff55ff;">verify.yml</b>
admlocal@devOps:~/leantime_ansible$ molecule verify
<b class=BLU>INFO    </b> default scenario test matrix: verify
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>verify</b>
<b class=BLU>INFO    </b> Running Ansible Verifier

PLAY [Infraestrutura conduzida por testes] ***********************************************************************************************

TASK [Variáveis] *************************************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Atualizar a cache do sistema] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [teste: a cache encontra-se actualizada?] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Atualizar o sistema operativo (equivalente a apt upgrade)] *************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [teste: o sistema operativo encontra-se atualizado?] ********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O sistema operativo está atualizado"</b>
<b class=GRN>}</b>

TASK [Teste: a cache encontra-se atualizada?] ********************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas] ****************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: as dependencias encontra-se instaladas?] ************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: As dependencias estavam instaladas"</b>
<b class=GRN>}</b>

TASK [Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque] ****************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?] ***********************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"</b>
<b class=GRN>}</b>

TASK [Rotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2] ********************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile.] ****************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})</b>

TASK [Teste: As linhas do php.ini encontram-se alteradas ?] ******************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O ficheiro php.ini foi alterado com sucesso"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre a pastas /var/www/leantime] **********************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: A pasta /var/www/leantime existe e tem as permissões certas?] ***************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas no site leantime"</b>
<b class=GRN>}</b>

TASK [Simulação: Verifica se é necessário criar a base de dados leantime_database] *******************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: A base de dados leantime_database existe ?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A base de dados leantime_database já se encontra criada"</b>
<b class=GRN>}</b>

TASK [Simulação e Teste: Verifica se o endereço git para a versão de leantime existe] ****************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Obtem informação sobre o ficheiro /var/www/leantime/config/configuration.php] *******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /var/www/leantime/config/configuration.php existe e tem as permissões certas?] ***********************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas e ficheiro configuration.php existente"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o módulo replace.] ******************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O dbUser foi alterado?] *****************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o módulo replace.] **************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: a variável dbDatabase foi alterada?] ****************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o módulo replace.] **************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O dbPassword foi alterado?] *************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-available/leantime.conf] *******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permissões certas?] ***********************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf] *********************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permissões certas?] *************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/000-default.conf] ******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/000-default.conf NÃO existe?] *********************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "All assertions passed"</b>
<b class=GRN>}</b>

TASK [Simulação: Activa o módulo mod_rewrite no apache] **********************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Activa o módulo mod_rewrite no apache] **********************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: o mod_rewrite do apache encontra-se ativo?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: mod_rewrite encontra-se instalado e ativo"</b>
<b class=GRN>}</b>

TASK [Simulação: Tenta fazer login na aplicação com o utilizador criado] *****************************************************************
<b class=RED>fatal: [ubuntu-20.04]: FAILED! =&gt; {"msg": "The task includes an option with an undefined variable. The error was: 'login_website' is undefined\n\nThe error appears to be in '/home/admlocal/leantime_ansible/molecule/default/verify.yml': line 344, column 5, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n  # Fonte: https://stackoverflow.com/questions/63791689/ansible-looses-cookie-content\n  - name: \"Simulação: Tenta fazer login na aplicação com o utilizador criado\"\n    ^ here\nThis one looks easy to fix. It seems that there is a value started\nwith a quote, and the YAML parser is expecting to see the line ended\nwith the same kind of quote. For instance:\n\n    when: \"ok\" in result.stdout\n\nCould be written as:\n\n   when: '\"ok\" in result.stdout'\n\nOr equivalently:\n\n   when: \"'ok' in result.stdout\"\n"}</b>

PLAY RECAP *******************************************************************************************************************************
<b class=RED>ubuntu-20.04</b>               : <b class=GRN>ok=35  </b> changed=0    unreachable=0    <b class=RED>failed=1   </b> skipped=0    rescued=0    ignored=0


<b class=HIR>CRITICAL</b> Ansible return code was <b class=HIC>2</b>, command was: ansible-playbook --inventory <b class=MAG>/home/admlocal/.cache/molecule/leantime_ansible/default/</b><b style="color:#ff55ff;">inventory</b> --skip-tags molecule-notest,notest <b class=MAG>/home/admlocal/leantime_ansible/molecule/default/</b><b style="color:#ff55ff;">verify.yml</b>
admlocal@devOps:~/leantime_ansible$ nano vars/va&#x266A;&#x232B;&#x232B;main.yml &#x266A;
BB
<hr>
B<b class="BLK BWHI">[ A ler... ]B</b>B<b class="BLK BWHI">[ 5 linhas lidas ]B</b>B<b class="BLK BWHI">  GNU nano 4.8                                                 vars/main.yml                                                              B</b>&crarr;
B<b class="BLK BWHI">^GB</b> AjudaB<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> ProcurarB<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursor    B<b class="BLK BWHI">M-UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txt&crarr;
B<b class="BLK BWHI">^XB</b> SairB<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> RefazerB<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
B--- login_leantime: leantimeDBadminpassword_leantime: "#S3gr3d0S3cr3t0#"versao_leantime: v2.1.7&crarr;
B<b class="BLK BWHI">ModificadoB</b>&crarr;
    &crarr;
   login_websit&crarr;
e: "my_name@my_email.com"&crarr;
   password_website: "S3cr3tPwd@V3ryS3cret«"&crarr;
    password_website: "S3cr3tPwd@V3ryS3cret«"&crarr;
 &#x232B;    login_website: "my_name@my_email.com"&crarr;
          B<b class="BLK BWHI">M-DB</b> Formato DOSB<b class="BLK BWHI">M-AB</b> AnexarB<b class="BLK BWHI">BB</b> SegurançaB<b class="BLK BWHI">CB</b> Cancelar           B<b class="BLK BWHI">M-MB</b> Formato MacB<b class="BLK BWHI">M-PB</b> PreporB<b class="BLK BWHI">^TB</b> P/ ficheiros&crarr;
B<b class="BLK BWHI">Nome do ficheiro onde escrever: vars/main.yml                                                                                             B</b> B<b class="BLK BWHI">[ A escrever... ]B</b>B<b class="BLK BWHI">          B</b>B<b class="BLK BWHI">[ 7 linhas escritas ]B</b>B<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> Procurar      B<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursorB<b class="BLK BWHI">UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txtB<b class="BLK BWHI">XB</b> Sair    B<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> Refazer      B<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
          B<b class="BLK BWHI">M-DB</b> Formato DOSB<b class="BLK BWHI">M-AB</b> AnexarB<b class="BLK BWHI">BB</b> SegurançaB<b class="BLK BWHI">CB</b> Cancelar           B<b class="BLK BWHI">M-MB</b> Formato MacB<b class="BLK BWHI">M-PB</b> PreporB<b class="BLK BWHI">^TB</b> P/ ficheiros&crarr;
B<b class="BLK BWHI">Nome do ficheiro onde escrever: vars/main.yml                                                                                             B</b> B<b class="BLK BWHI">[ A escrever... ]B</b>B<b class="BLK BWHI">[ 7 linhas escritas ]B</b>B<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> Procurar      B<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursorB<b class="BLK BWHI">UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txtB<b class="BLK BWHI">XB</b> Sair    B<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> Refazer      B<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
 &#x232B;
<hr>
&crarr;
admlocal@devOps:~/leantime_ansible$ nano vars/main.yml &#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;molecule verify
<b class=BLU>INFO    </b> default scenario test matrix: verify
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>verify</b>
<b class=BLU>INFO    </b> Running Ansible Verifier

PLAY [Infraestrutura conduzida por testes] ***********************************************************************************************

TASK [Variáveis] *************************************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Atualizar a cache do sistema] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [teste: a cache encontra-se actualizada?] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Atualizar o sistema operativo (equivalente a apt upgrade)] *************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [teste: o sistema operativo encontra-se atualizado?] ********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O sistema operativo está atualizado"</b>
<b class=GRN>}</b>

TASK [Teste: a cache encontra-se atualizada?] ********************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas] ****************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: as dependencias encontra-se instaladas?] ************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: As dependencias estavam instaladas"</b>
<b class=GRN>}</b>

TASK [Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque] ****************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?] ***********************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"</b>
<b class=GRN>}</b>

TASK [Rotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2] ********************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile.] ****************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})</b>

TASK [Teste: As linhas do php.ini encontram-se alteradas ?] ******************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O ficheiro php.ini foi alterado com sucesso"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre a pastas /var/www/leantime] **********************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: A pasta /var/www/leantime existe e tem as permissões certas?] ***************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas no site leantime"</b>
<b class=GRN>}</b>

TASK [Simulação: Verifica se é necessário criar a base de dados leantime_database] *******************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: A base de dados leantime_database existe ?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A base de dados leantime_database já se encontra criada"</b>
<b class=GRN>}</b>

TASK [Simulação e Teste: Verifica se o endereço git para a versão de leantime existe] ****************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Obtem informação sobre o ficheiro /var/www/leantime/config/configuration.php] *******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /var/www/leantime/config/configuration.php existe e tem as permissões certas?] ***********************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas e ficheiro configuration.php existente"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o módulo replace.] ******************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O dbUser foi alterado?] *****************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o módulo replace.] **************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: a variável dbDatabase foi alterada?] ****************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o módulo replace.] **************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O dbPassword foi alterado?] *************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-available/leantime.conf] *******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permissões certas?] ***********************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf] *********************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permissões certas?] *************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/000-default.conf] ******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/000-default.conf NÃO existe?] *********************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "All assertions passed"</b>
<b class=GRN>}</b>

TASK [Simulação: Activa o módulo mod_rewrite no apache] **********************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Activa o módulo mod_rewrite no apache] **********************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: o mod_rewrite do apache encontra-se ativo?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: mod_rewrite encontra-se instalado e ativo"</b>
<b class=GRN>}</b>

TASK [Simulação: Tenta fazer login na aplicação com o utilizador criado] *****************************************************************
<b class=HIM>[WARNING]: The value True (type bool) in a string field was converted to 'True' (type string). If this does not look like what you</b>
<b class=HIM>expect, quote the entire value to ensure it does not change.</b>
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso] **********************************
<b class=RED>fatal: [ubuntu-20.04]: FAILED! =&gt; {"msg": "The task includes an option with an undefined variable. The error was: 'dict object' has no attribute 'set_cookie'\n\nThe error appears to be in '/home/admlocal/leantime_ansible/molecule/default/verify.yml': line 353, column 5, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n  - name: \"Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso\"\n    ^ here\nThis one looks easy to fix. It seems that there is a value started\nwith a quote, and the YAML parser is expecting to see the line ended\nwith the same kind of quote. For instance:\n\n    when: \"ok\" in result.stdout\n\nCould be written as:\n\n   when: '\"ok\" in result.stdout'\n\nOr equivalently:\n\n   when: \"'ok' in result.stdout\"\n"}</b>

PLAY RECAP *******************************************************************************************************************************
<b class=RED>ubuntu-20.04</b>               : <b class=GRN>ok=36  </b> changed=0    unreachable=0    <b class=RED>failed=1   </b> skipped=0    rescued=0    ignored=0


<b class=HIR>CRITICAL</b> Ansible return code was <b class=HIC>2</b>, command was: ansible-playbook --inventory <b class=MAG>/home/admlocal/.cache/molecule/leantime_ansible/default/</b><b style="color:#ff55ff;">inventory</b> --skip-tags molecule-notest,notest <b class=MAG>/home/admlocal/leantime_ansible/molecule/default/</b><b style="color:#ff55ff;">verify.yml</b>
admlocal@devOps:~/leantime_ansible$ molecule verify&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;nano vars/main.yml &#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;molecule verify&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;lint&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;nano molecule/default/verify.yml 
BB
<hr>
B<b class="BLK BWHI">[ A ler... ]B</b>B<b class="BLK BWHI">[ 368 linhas lidas ]B</b>B<b class="BLK BWHI">  GNU nano 4.8                                          molecule/default/verify.yml                                                       B</b>&crarr;
B<b class="BLK BWHI">^GB</b> AjudaB<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> ProcurarB<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursor    B<b class="BLK BWHI">M-UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txt&crarr;
B<b class="BLK BWHI">^XB</b> SairB<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> RefazerB<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
B---&crarr;
<b class=CYN># Tutorial de inspiração para a infraestrutura conduzida por teste no site</b>&crarr;
# https://www.adictosaltrabajo.com/2020/05/08/ansible-testing-using-molecule-with-ansible-as-verifier/&crarr;
B- name: "Infraestrutura conduzida por testes"hosts: allgather_facts: falsebecome: truetasks:- name: Variáveisinclude_vars:file: ../../vars/main.yml- name: "Simulação: Atualizar a cache do sistema"apt:&#x232B;&#x232B;update_cache: truecache_valid_time: 3600check_mode: trueregister: estado- name: "teste: a cache encontra-se actualizada?"assert:that:- not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem actualizações pendentes"- name: "Atualizar o sistema operativo (equivalente a apt upgrade)"apt:&#x232B;&#x232B;upgrade: safecheck_mode: trueregister: estado- name: "teste: o sistema operativo encontra-se atualizado?"&crarr;
  - name: "teste: o sistema operativo encontra-se atualizado?"&crarr;
    assert:that: - not estado.changed    success_msg: "SUCESSO: O sistema operativo está atualizado"    fail_msg: "ERRO: Existem actualizações pendentes"&crarr;
  - name: "Teste: a cache encontra-se atualizada?"  assert:    that:  - not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem atualizações pendentes"&crarr;
  - name: "Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas"apt:&#x232B;&#x232B;pkg:  - mc  - screen- git    - apache2  - mysql-server- phpphp-mysql- php-ldap- php-cli- php-soap    - php-json  - graphviz- php-xml  - php-gd  - php-zip- libapache2-mod-php    - php-dev&crarr;
- libapache2-mod-php    - php-dev  - libmcrypt-dev- gccmake- autoconf- libc-dev- pkg-config    - pwgen  - curl- unzipzip- php-mbstring- expect- net-tools    - python3-mysqldb  - python3-apt- python3-pycurlcheck_mode: trueregister: estado&crarr;
  - name: "Teste: as dependencias encontra-se instaladas?"assert:that:not estado.changedsuccess_msg: "SUCESSO: As dependencias estavam instaladas"fail_msg: "ERRO: Faltam instalar algumas dependencias. O software pode estar parcialmente instalado"&crarr;
<b class=CYN>  # Fonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html</b>B- name: "Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque"service:name: apache2state: startedenabled: truecheck_mode: true&crarr;
enabled: true&#x232B;O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?"O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"O serviço apache2 não se encontra correcta<b class=CYN>: https://www.mydailytutorials.com/using--find-module-search-filesfolder</b>BRotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2"find:paths: /etcpatterns: "php.ini"recurseregister: caminho_php_ini&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html</b>B- name: "Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile."ansible.builtin.lineinfile:path: "{{ caminho_php_ini.files[0].path }}"regexp: "{{ item.regexp  }}"line: "{{ item.line }}"with_items:- regexp: "^file_uploads"line: "file_uploads = 1"- regexp: "^upload_max_filesize"line: "upload_max_filesize = 1G"- regexp: "^max_file_uploads"line: "max_file_uploads = 20"- regexp: "^post_max_size"line: "post_max_size = 2G"- regexp: "^memory_limit"&crarr;
line: "post_max_size = 2G"- regexp: "^memory_limit"line: "memory_limit = 2G"- regexp: "^max_input_time"  line: "max_input_time = 3600"As linhas do php.ini encontram-se alteradas ?"ficheiro php.ini foi alterado com sucesso"Algumas alterações ao ficheiro php.ini não tiveram sucesso"<b class=CYN>O site deve existir na pasta /var/www/leantime. Este teste visa determinar se a pasta</b>&crarr;
  # existe e se temas permissões certas&crarr;
  # Fonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.htmlB- name: "Simulação: Obtem informação sobre a pastas /var/www/leantime"&crarr;
    stat:    path: "/var/www/leantime"register: pasta&crarr;
  - name: "Teste: A pasta /var/www/leantime existe e tem as permissões certas?"assert:  that:  - pasta.stat.exists- pasta.stat.isdir  - pasta.stat.mode == "0755"- pasta.stat.pw_name == "www-data"  - pasta.stat.gr_name == "www-data"success_msg: "SUCESSO: Permissões correctas no site leantime"fail_msg: "ERRO: Permissões incorrectas no site leantime ou site não existente"&crarr;
<b class=CYN>  # Outro dos requesitos é a existência de uma base de dados para o site.</b>&crarr;
B<b class=CYN>  # Outro dos requesitos é a existência de uma base de dados para o site.</b>&crarr;
  # Esta base de dados deve ser criada, logo tem de ser testada para determinar se ela existe ou não.&crarr;
  # Fonte de inspiração: https://serverfault.com/questions/173978/from-a-shell-script-how-can-i-check-whether-a-mysql-database-existsB- name: "Simulação: Verifica se é necessário criar a base de dados leantime_database"shell: "mysql -u root -e 'use leantime_database'"resultfailed_when: false  changed_when: false&crarr;
  - name: "Teste: A base de dados leantime_database existe ?"assert:that:- result.rc == 0success_msg: "SUCESSO: A base de dados leantime_database já se encontra criada"fail_msg: "ERRO: Não existe a base de dados leantime_database"&crarr;
<b class=CYN>  # Teste: O download do software leantime deve ser possível, a partir do site do leantime</b>B- name: "Simulação e Teste: Verifica se o endereço git para a versão de leantime existe"uri:&#x232B;&#x232B;url: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zipregister: resultado<b class=CYN>Teste: Do ficheiro configuration.php no site do leantime. A existência deste ficheiro       com as permissões certas indica que o processo de unzip correu bemDocumentação oficial em: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html</b>Bo ficheiro /var/www/leantime/config/configuration.php"/config/configuration.php"ficheiroO ficheiro /var/www/leantime/config/configuration.php existe e tem as permissões certas?"ficheiro.stat.exists&crarr;
that: - ficheiro.stat.exists - ficheiro.stat.isreg - ficheiro.stat.mode == "0755" - ficheiro.stat.pw_name == "www-data"    - ficheiro.stat.gr_name == "www-data"  success_msg: "SUCESSO: Permissões correctas e ficheiro configuration.php existente"  fail_msg: "ERRO: Permissões incorrectas ou ficheiro configuration.php não existente"&crarr;
<b class=CYN>  # Teste: O ficheiro /var/www/leantime/config/configuration.php necessita de ser alterado.</b>&crarr;
  # As variáveis dbuser, dbDatabase, e dbPassword necessitam de estar configuradas.&crarr;
  # Por simulação o sistema vai determinar se estas estão configuradas com o valor esperado.&crarr;
  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.htmlB- name: "Simulação: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o módulo replace."ansible.builtin.replace:path: /var/www/leantime/config/configuration.phpregexp: 'dbUser=""' replace: 'dbUser="{{ login_leantime }}"'  check_mode: yesregister: conffailed_when: false&crarr;
  - name: "Teste: O dbUser foi alterado?"&crarr;
    assert: that: - conf is not changed    - conf is not failed  success_msg: "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"fail_msg: "ERRO: O dbUser não foi alterado no ficheiro configuration.php"&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html</b>B- name: "Simulação: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o módulo replace."ansible.builtin.replace:path: /var/www/leantime/config/configuration.php&crarr;
    ansible.builtin.replace:path: /var/www/leantime/config/configuration.phpregexp: 'dbDatabase=""'replace: 'dbDatabase="leantime_database"'check_mode: yesregister: conffailed_when: false&crarr;
  - name: "Teste: a variável dbDatabase foi alterada?"&crarr;
    assert: that: - conf is not changed - conf is not failed    success_msg: "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"  fail_msg: "ERRO: O dbDatabase não foi alterado no ficheiro configuration.php"&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html</b>B- name: "Simulação: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o módulo replace."ansible.builtin.replace:  path: /var/www/leantime/config/configuration.php  regexp: 'dbPassword=""'replace: 'dbPassword="{{ password_leantime }}"'  check_mode: yesregister: conffailed_when: false&crarr;
  - name: "Teste: O dbPassword foi alterado?"assert:that:- conf is not changed- conf is not failed success_msg: "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"    fail_msg: "ERRO: O dbPassword não foi alterado no ficheiro configuration.php"&crarr;
<b class=CYN>  # A configuração do site leantime necessita que seja criado um site através de um ficheiro de</b>&crarr;
B<b class=CYN>  # A configuração do site leantime necessita que seja criado um site através de um ficheiro de</b>&crarr;
  # configuração, dentro das pasta do apache2. Deve existir um ficheiro de configuração do&crarr;
  # leantime em (/etc/apache2/sites-availableB&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html</b>B- name: "Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-available/leantime.conf"stat:path: "/etc/apache2/sites-available/leantime.conf"  register: ficheiro&crarr;
  - name: "Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permissões certas?"assert:that:  - ficheiro.stat.exists  - ficheiro.stat.isreg- ficheiro.stat.mode == "0777" - ficheiro.stat.pw_name == "root" - ficheiro.stat.gr_name == "www-data"  success_msg: "SUCESSO: Permissões correctas"fail_msg: "ERRO: Permissões incorrectas"&crarr;
<b class=CYN>  # O site deve estar ativo no apache. Este teste vai verificar se o site se encontra ativo</b>&crarr;
  # https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.htmlB- name: "Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf"stat:path: "/etc/apache2/sites-enabled/leantime.conf"  register: ficheiro&crarr;
  - name: "Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permissões certas?"assert:that:  - ficheiro.stat.exists  - ficheiro.stat.islnk- ficheiro.stat.mode == "0777" - ficheiro.stat.pw_name == "root"&crarr;
- ficheiro.stat.mode == "0777" - ficheiro.stat.pw_name == "root" - ficheiro.stat.gr_name == "root" success_msg: "SUCESSO: Permissões correctas" fail_msg: "ERRO: Permissões incorrectas"&crarr;
<b class=CYN>  # https//docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html</b>B- name: "Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/000-default.conf"stat:path: "/etc/apache2/sites-enabled/000-default.conf"  register: ficheiro&crarr;
  - name: "Teste: O ficheiro /etc/apache2/sites-enabled/000-default.conf NÃO existe?"assert:that:&#x232B;not ficheiro.stat.exists&crarr;
  - name: "Simulação: Activa o módulo mod_rewrite no apache"apache2_module:name: rewritestate: present&crarr;
    check_mode: true&crarr;
    register: estado&crarr;
  - name: "Simulação: Activa o módulo mod_rewrite no apache"apache2_module:  name: rewritestate: present  check_mode: trueregister: estado&crarr;
  - name: "Teste: o mod_rewrite do apache encontra-se ativo?"assert:that:- not estado.changed&crarr;
that:- not estado.changedsuccess_msg: "SUCESSO: mod_rewrite encontra-se instalado e ativo"fail_msg: "ERRO: mod_rewrite não instalado ou não ativo!"&crarr;
<b class=CYN>  # Teste: Verificar se o sistema se encontra devidamente instalado e configurado.       Se a base de dados estiver correctamente configurada e se o administrador do</b>&crarr;
  #        sistema estiver configurado, deve ser possível fazer login ao sistema sem problemas.B&crarr;
<b class=CYN>  #        Este teste tem como objetivo verificar se é possível fazer o login</b>&crarr;
  # Através do BurpSuite (https://portswigger.net/burp), aprendido nas aulas de Testes de Penetração e Desenvolvimento de Exploits&crarr;
  # foi realizado um debug da sessão de login. Com base nessa sessão a fase de Login encontra-se aqui replicada.&crarr;
  # è necessário gravar a cockie de sessão. A página oficial do Ansible contem um erro que é resolvido com a seguinte...&crarr;
  # Fonte: https://stackoverflow.com/questions/63791689/ansible-looses-cookie-contentB- name: "Simulação: Tenta fazer login na aplicação com o utilizador criado"uri:&#x232B;&#x232B;url: http://localhostmethod: POST    body: "username={{ login_website  }}&amp;password={{ password_website  }}&amp;redirectUrl:=/&amp;login=Login"  status_code: 200follow_redirects: trueregister: paginalogin&crarr;
  - name: "Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso"uri:    url: http://localhost/calendar/showMyCalendar  method: GETheaders:  Cookie: "{{ paginalogin.set_cookie }}"  return_content: yespaginawebExiste o texto editCompanySettings na página?""'password' not in paginaweb.content"&crarr;
"'password' not in paginaweb.content"- "'editCompanySettings' in paginaweb.content"success_msg: "SUCESSO: Login com sucesso. Utilizador e palavra passe iniciais correctamente criados"fail_msg: "ERRO: Não foi possivel fazer login! O utilizador ou palavra passe não foram criados com sucesso!"&crarr;
assert:&crarr;
- name: "Teste: Existe o texto editCompanySettings na página?"&crarr;
register: paginaweb&crarr;
return_content: yes&crarr;
Cookie: "{{ paginalogin.set_cookie }}"&crarr;
headers:&crarr;
method: GET&crarr;
url: http://localhost/calendar/showMyCalendar&crarr;
uri:&crarr;
- name: "Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso"&crarr;
register: paginalogin&crarr;
follow_redirects: true&crarr;
status_code: 200&crarr;
body: "username={{ login_website  }}&amp;password={{ password_website  }}&amp;redirectUrl:=/&amp;login=Login"&crarr;
method: POST&crarr;
url: http://localhost&crarr;
uri:&crarr;
- name: "Simulação: Tenta fazer login na aplicação com o utilizador criado"&crarr;
<b class=CYN>  # Fonte: https://stackoverflow.com/questions/63791689/ansible-looses-cookie-content</b>&crarr;
B<b class=CYN>  # Através do BurpSuite (https://portswigger.net/burp), aprendido nas aulas de Testes de Penetração e Desenvolvimento de Exploits</b>&crarr;
  # foi realizado um debug da sessão de login. Com base nessa sessão a fase de Login encontra-se aqui replicada.&crarr;
  # è necessário gravar a cockie de sessão. A página oficial do Ansible contem um erro que é resolvido com a seguinte...&crarr;
B  &crarr;
<b class=CYN>  #        Este teste tem como objetivo verificar se é possível fazer o login</b>&crarr;
  B&crarr;
<b class=CYN>  #        sistema estiver configurado, deve ser possível fazer login ao sistema sem problemas.</b>&crarr;
  B&crarr;
<b class=CYN>  #        Se a base de dados estiver correctamente configurada e se o administrador do</b>&crarr;
  B&crarr;
<b class=CYN>  # Teste: Verificar se o sistema se encontra devidamente instalado e configurado.</b>&crarr;
  B&crarr;
fail_msg: "ERRO: mod_rewrite não instalado ou não ativo!"&crarr;
  &crarr;
success_msg: "SUCESSO: mod_rewrite encontra-se instalado e ativo"&crarr;
  &crarr;
- not estado.changed&crarr;
  &crarr;
that:&crarr;
  &crarr;
assert:&crarr;
  &crarr;
- name: "Teste: o mod_rewrite do apache encontra-se ativo?"&crarr;
  &crarr;
&#x232B;register: estado&crarr;
  &#x232B; &crarr;
&crarr;
  &crarr;

- name: "Teste: Existe o texto editCompanySettings na página?"&crarr;
  &crarr;

assert:&crarr;
  &crarr;

that:&crarr;
  &crarr;

- "'password' not in paginaweb.content"&crarr;
  &crarr;

- "'editCompanySettings' in paginaweb.content"&crarr;
  &crarr;

success_msg: "SUCESSO: Login com sucesso. Utilizador e palavra passe iniciais correctamente criados"&crarr;
  &crarr;

fail_msg: "ERRO: Não foi possivel fazer login! O utilizador ou palavra passe não foram criados com sucesso!"&crarr;
  &crarr;


<hr>
&crarr;
admlocal@devOps:~/leantime_ansible$ nano molecule/default/verify.yml &#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;molecule verify
<b class=BLU>INFO    </b> default scenario test matrix: verify
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>verify</b>
<b class=BLU>INFO    </b> Running Ansible Verifier

PLAY [Infraestrutura conduzida por testes] ***********************************************************************************************

TASK [Variáveis] *************************************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Atualizar a cache do sistema] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [teste: a cache encontra-se actualizada?] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Atualizar o sistema operativo (equivalente a apt upgrade)] *************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [teste: o sistema operativo encontra-se atualizado?] ********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O sistema operativo está atualizado"</b>
<b class=GRN>}</b>

TASK [Teste: a cache encontra-se atualizada?] ********************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas] ****************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: as dependencias encontra-se instaladas?] ************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: As dependencias estavam instaladas"</b>
<b class=GRN>}</b>

TASK [Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque] ****************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?] ***********************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"</b>
<b class=GRN>}</b>

TASK [Rotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2] ********************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile.] ****************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})</b>

TASK [Teste: As linhas do php.ini encontram-se alteradas ?] ******************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O ficheiro php.ini foi alterado com sucesso"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre a pastas /var/www/leantime] **********************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: A pasta /var/www/leantime existe e tem as permissões certas?] ***************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas no site leantime"</b>
<b class=GRN>}</b>

TASK [Simulação: Verifica se é necessário criar a base de dados leantime_database] *******************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: A base de dados leantime_database existe ?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A base de dados leantime_database já se encontra criada"</b>
<b class=GRN>}</b>

TASK [Simulação e Teste: Verifica se o endereço git para a versão de leantime existe] ****************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Obtem informação sobre o ficheiro /var/www/leantime/config/configuration.php] *******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /var/www/leantime/config/configuration.php existe e tem as permissões certas?] ***********************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas e ficheiro configuration.php existente"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o módulo replace.] ******************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O dbUser foi alterado?] *****************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o módulo replace.] **************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: a variável dbDatabase foi alterada?] ****************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o módulo replace.] **************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O dbPassword foi alterado?] *************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-available/leantime.conf] *******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permissões certas?] ***********************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf] *********************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permissões certas?] *************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/000-default.conf] ******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/000-default.conf NÃO existe?] *********************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "All assertions passed"</b>
<b class=GRN>}</b>

TASK [Simulação: Activa o módulo mod_rewrite no apache] **********************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Activa o módulo mod_rewrite no apache] **********************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: o mod_rewrite do apache encontra-se ativo?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: mod_rewrite encontra-se instalado e ativo"</b>
<b class=GRN>}</b>

TASK [Simulação: Tenta fazer login na aplicação com o utilizador criado] *****************************************************************
<b class=HIM>[WARNING]: The value True (type bool) in a string field was converted to 'True' (type string). If this does not look like what you</b>
<b class=HIM>expect, quote the entire value to ensure it does not change.</b>
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso] **********************************
<b class=RED>fatal: [ubuntu-20.04]: FAILED! =&gt; {"msg": "The task includes an option with an undefined variable. The error was: 'dict object' has no attribute 'set_cookie'\n\nThe error appears to be in '/home/admlocal/leantime_ansible/molecule/default/verify.yml': line 353, column 5, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n  - name: \"Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso\"\n    ^ here\nThis one looks easy to fix. It seems that there is a value started\nwith a quote, and the YAML parser is expecting to see the line ended\nwith the same kind of quote. For instance:\n\n    when: \"ok\" in result.stdout\n\nCould be written as:\n\n   when: '\"ok\" in result.stdout'\n\nOr equivalently:\n\n   when: \"'ok' in result.stdout\"\n"}</b>

PLAY RECAP *******************************************************************************************************************************
<b class=RED>ubuntu-20.04</b>               : <b class=GRN>ok=36  </b> changed=0    unreachable=0    <b class=RED>failed=1   </b> skipped=0    rescued=0    ignored=0


<b class=HIR>CRITICAL</b> Ansible return code was <b class=HIC>2</b>, command was: ansible-playbook --inventory <b class=MAG>/home/admlocal/.cache/molecule/leantime_ansible/default/</b><b style="color:#ff55ff;">inventory</b> --skip-tags molecule-notest,notest <b class=MAG>/home/admlocal/leantime_ansible/molecule/default/</b><b style="color:#ff55ff;">verify.yml</b>
admlocal@devOps:~/leantime_ansible$ molecule verify&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;lint
<b class=BLU>INFO    </b> default scenario test matrix: dependency, lint
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>dependency</b>
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>lint</b>
COMMAND: set -e
yamllint .
ansible-lint

Loading custom .yamllint config file, this extends our internal yamllint config.
admlocal@devOps:~/leantime_ansible$ molecule lint&#x232B;&#x232B;&#x232B;&#x232B;verify&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;nano molecule/default/verify.yml 
BB
<hr>
B<b class="BLK BWHI">[ A ler... ]B</b>B<b class="BLK BWHI">[ 368 linhas lidas ]B</b>B<b class="BLK BWHI">  GNU nano 4.8                                          molecule/default/verify.yml                                                       B</b>&crarr;
B<b class="BLK BWHI">^GB</b> AjudaB<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> ProcurarB<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursor    B<b class="BLK BWHI">M-UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txt&crarr;
B<b class="BLK BWHI">^XB</b> SairB<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> RefazerB<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
B---&crarr;
<b class=CYN># Tutorial de inspiração para a infraestrutura conduzida por teste no site</b>&crarr;
# https://www.adictosaltrabajo.com/2020/05/08/ansible-testing-using-molecule-with-ansible-as-verifier/&crarr;
B- name: "Infraestrutura conduzida por testes"hosts: allgather_facts: falsebecome: truetasks:- name: Variáveisinclude_vars:file: ../../vars/main.yml- name: "Simulação: Atualizar a cache do sistema"apt:&#x232B;&#x232B;update_cache: truecache_valid_time: 3600check_mode: trueregister: estado- name: "teste: a cache encontra-se actualizada?"assert:that:- not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem actualizações pendentes"- name: "Atualizar o sistema operativo (equivalente a apt upgrade)"apt:&#x232B;&#x232B;upgrade: safecheck_mode: trueregister: estado- name: "teste: o sistema operativo encontra-se atualizado?"&crarr;
  - name: "teste: o sistema operativo encontra-se atualizado?"&crarr;
    assert:that: - not estado.changed    success_msg: "SUCESSO: O sistema operativo está atualizado"    fail_msg: "ERRO: Existem actualizações pendentes"&crarr;
  - name: "Teste: a cache encontra-se atualizada?"  assert:    that:  - not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem atualizações pendentes"&crarr;
  - name: "Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas"apt:&#x232B;&#x232B;pkg:  - mc  - screen- git    - apache2  - mysql-server- phpphp-mysql- php-ldap- php-cli- php-soap    - php-json  - graphviz- php-xml  - php-gd  - php-zip- libapache2-mod-php    - php-dev&crarr;
- libapache2-mod-php    - php-dev  - libmcrypt-dev- gccmake- autoconf- libc-dev- pkg-config    - pwgen  - curl- unzipzip- php-mbstring- expect- net-tools    - python3-mysqldb  - python3-apt- python3-pycurlcheck_mode: trueregister: estado&crarr;
  - name: "Teste: as dependencias encontra-se instaladas?"assert:that:not estado.changedsuccess_msg: "SUCESSO: As dependencias estavam instaladas"fail_msg: "ERRO: Faltam instalar algumas dependencias. O software pode estar parcialmente instalado"&crarr;
<b class=CYN>  # Fonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html</b>B- name: "Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque"service:name: apache2state: startedenabled: truecheck_mode: true&crarr;
enabled: true&#x232B;O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?"O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"O serviço apache2 não se encontra correcta<b class=CYN>: https://www.mydailytutorials.com/using--find-module-search-filesfolder</b>BRotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2"find:paths: /etcpatterns: "php.ini"recurseregister: caminho_php_ini&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html</b>B- name: "Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile."ansible.builtin.lineinfile:path: "{{ caminho_php_ini.files[0].path }}"regexp: "{{ item.regexp  }}"line: "{{ item.line }}"with_items:- regexp: "^file_uploads"line: "file_uploads = 1"- regexp: "^upload_max_filesize"line: "upload_max_filesize = 1G"- regexp: "^max_file_uploads"line: "max_file_uploads = 20"- regexp: "^post_max_size"line: "post_max_size = 2G"- regexp: "^memory_limit"&crarr;
line: "post_max_size = 2G"- regexp: "^memory_limit"line: "memory_limit = 2G"- regexp: "^max_input_time"  line: "max_input_time = 3600"As linhas do php.ini encontram-se alteradas ?"ficheiro php.ini foi alterado com sucesso"Algumas alterações ao ficheiro php.ini não tiveram sucesso"<b class=CYN>O site deve existir na pasta /var/www/leantime. Este teste visa determinar se a pasta</b>&crarr;
  # existe e se temas permissões certas&crarr;
  # Fonte de inspiração: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.htmlB- name: "Simulação: Obtem informação sobre a pastas /var/www/leantime"&crarr;
    stat:    path: "/var/www/leantime"register: pasta&crarr;
  - name: "Teste: A pasta /var/www/leantime existe e tem as permissões certas?"assert:  that:  - pasta.stat.exists- pasta.stat.isdir  - pasta.stat.mode == "0755"- pasta.stat.pw_name == "www-data"  - pasta.stat.gr_name == "www-data"success_msg: "SUCESSO: Permissões correctas no site leantime"fail_msg: "ERRO: Permissões incorrectas no site leantime ou site não existente"&crarr;
<b class=CYN>  # Outro dos requesitos é a existência de uma base de dados para o site.</b>&crarr;
B<b class=CYN>  # Outro dos requesitos é a existência de uma base de dados para o site.</b>&crarr;
  # Esta base de dados deve ser criada, logo tem de ser testada para determinar se ela existe ou não.&crarr;
  # Fonte de inspiração: https://serverfault.com/questions/173978/from-a-shell-script-how-can-i-check-whether-a-mysql-database-existsB- name: "Simulação: Verifica se é necessário criar a base de dados leantime_database"shell: "mysql -u root -e 'use leantime_database'"resultfailed_when: false  changed_when: false&crarr;
  - name: "Teste: A base de dados leantime_database existe ?"assert:that:- result.rc == 0success_msg: "SUCESSO: A base de dados leantime_database já se encontra criada"fail_msg: "ERRO: Não existe a base de dados leantime_database"&crarr;
<b class=CYN>  # Teste: O download do software leantime deve ser possível, a partir do site do leantime</b>B- name: "Simulação e Teste: Verifica se o endereço git para a versão de leantime existe"uri:&#x232B;&#x232B;url: https://github.com/Leantime/leantime/releases/download/{{ versao_leantime }}/Leantime-{{ versao_leantime }}.zipregister: resultado<b class=CYN>Teste: Do ficheiro configuration.php no site do leantime. A existência deste ficheiro       com as permissões certas indica que o processo de unzip correu bemDocumentação oficial em: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html</b>Bo ficheiro /var/www/leantime/config/configuration.php"/config/configuration.php"ficheiroO ficheiro /var/www/leantime/config/configuration.php existe e tem as permissões certas?"ficheiro.stat.exists&crarr;
that: - ficheiro.stat.exists - ficheiro.stat.isreg - ficheiro.stat.mode == "0755" - ficheiro.stat.pw_name == "www-data"    - ficheiro.stat.gr_name == "www-data"  success_msg: "SUCESSO: Permissões correctas e ficheiro configuration.php existente"  fail_msg: "ERRO: Permissões incorrectas ou ficheiro configuration.php não existente"&crarr;
<b class=CYN>  # Teste: O ficheiro /var/www/leantime/config/configuration.php necessita de ser alterado.</b>&crarr;
  # As variáveis dbuser, dbDatabase, e dbPassword necessitam de estar configuradas.&crarr;
  # Por simulação o sistema vai determinar se estas estão configuradas com o valor esperado.&crarr;
  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.htmlB- name: "Simulação: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o módulo replace."ansible.builtin.replace:path: /var/www/leantime/config/configuration.phpregexp: 'dbUser=""' replace: 'dbUser="{{ login_leantime }}"'  check_mode: yesregister: conffailed_when: false&crarr;
  - name: "Teste: O dbUser foi alterado?"&crarr;
    assert: that: - conf is not changed    - conf is not failed  success_msg: "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"fail_msg: "ERRO: O dbUser não foi alterado no ficheiro configuration.php"&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html</b>B- name: "Simulação: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o módulo replace."ansible.builtin.replace:path: /var/www/leantime/config/configuration.php&crarr;
    ansible.builtin.replace:path: /var/www/leantime/config/configuration.phpregexp: 'dbDatabase=""'replace: 'dbDatabase="leantime_database"'check_mode: yesregister: conffailed_when: false&crarr;
  - name: "Teste: a variável dbDatabase foi alterada?"&crarr;
    assert: that: - conf is not changed - conf is not failed    success_msg: "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"  fail_msg: "ERRO: O dbDatabase não foi alterado no ficheiro configuration.php"&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html</b>B- name: "Simulação: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o módulo replace."ansible.builtin.replace:  path: /var/www/leantime/config/configuration.php  regexp: 'dbPassword=""'replace: 'dbPassword="{{ password_leantime }}"'  check_mode: yesregister: conffailed_when: false&crarr;
  - name: "Teste: O dbPassword foi alterado?"assert:that:- conf is not changed- conf is not failed success_msg: "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"    fail_msg: "ERRO: O dbPassword não foi alterado no ficheiro configuration.php"&crarr;
<b class=CYN>  # A configuração do site leantime necessita que seja criado um site através de um ficheiro de</b>&crarr;
B<b class=CYN>  # A configuração do site leantime necessita que seja criado um site através de um ficheiro de</b>&crarr;
  # configuração, dentro das pasta do apache2. Deve existir um ficheiro de configuração do&crarr;
  # leantime em (/etc/apache2/sites-availableB&crarr;
<b class=CYN>  # Fonte: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html</b>B- name: "Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-available/leantime.conf"stat:path: "/etc/apache2/sites-available/leantime.conf"  register: ficheiro&crarr;
  - name: "Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permissões certas?"assert:that:  - ficheiro.stat.exists  - ficheiro.stat.isreg- ficheiro.stat.mode == "0777" - ficheiro.stat.pw_name == "root" - ficheiro.stat.gr_name == "www-data"  success_msg: "SUCESSO: Permissões correctas"fail_msg: "ERRO: Permissões incorrectas"&crarr;
<b class=CYN>  # O site deve estar ativo no apache. Este teste vai verificar se o site se encontra ativo</b>&crarr;
  # https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.htmlB- name: "Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf"stat:path: "/etc/apache2/sites-enabled/leantime.conf"  register: ficheiro&crarr;
  - name: "Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permissões certas?"assert:that:  - ficheiro.stat.exists  - ficheiro.stat.islnk- ficheiro.stat.mode == "0777" - ficheiro.stat.pw_name == "root"&crarr;
- ficheiro.stat.mode == "0777" - ficheiro.stat.pw_name == "root" - ficheiro.stat.gr_name == "root" success_msg: "SUCESSO: Permissões correctas" fail_msg: "ERRO: Permissões incorrectas"&crarr;
<b class=CYN>  # https//docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html</b>B- name: "Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/000-default.conf"stat:path: "/etc/apache2/sites-enabled/000-default.conf"  register: ficheiro&crarr;
  - name: "Teste: O ficheiro /etc/apache2/sites-enabled/000-default.conf NÃO existe?"assert:that:&#x232B;not ficheiro.stat.exists&crarr;
  - name: "Simulação: Activa o módulo mod_rewrite no apache"apache2_module:name: rewritestate: present&crarr;
    check_mode: true&crarr;
    register: estado&crarr;
  - name: "Simulação: Activa o módulo mod_rewrite no apache"apache2_module:  name: rewritestate: present  check_mode: trueregister: estado&crarr;
  - name: "Teste: o mod_rewrite do apache encontra-se ativo?"assert:that:- not estado.changed&crarr;
that:- not estado.changedsuccess_msg: "SUCESSO: mod_rewrite encontra-se instalado e ativo"fail_msg: "ERRO: mod_rewrite não instalado ou não ativo!"&crarr;
<b class=CYN>  # Teste: Verificar se o sistema se encontra devidamente instalado e configurado.       Se a base de dados estiver correctamente configurada e se o administrador do</b>&crarr;
  #        sistema estiver configurado, deve ser possível fazer login ao sistema sem problemas.B&crarr;
<b class=CYN>  #        Este teste tem como objetivo verificar se é possível fazer o login</b>&crarr;
  # Através do BurpSuite (https://portswigger.net/burp), aprendido nas aulas de Testes de Penetração e Desenvolvimento de Exploits&crarr;
  # foi realizado um debug da sessão de login. Com base nessa sessão a fase de Login encontra-se aqui replicada.&crarr;
  # è necessário gravar a cockie de sessão. A página oficial do Ansible contem um erro que é resolvido com a seguinte...&crarr;
  # Fonte: https://stackoverflow.com/questions/63791689/ansible-looses-cookie-contentB- name: "Simulação: Tenta fazer login na aplicação com o utilizador criado"uri:&#x232B;&#x232B;url: http://localhostmethod: POST    body: "username={{ login_website  }}&amp;password={{ password_website  }}&amp;redirectUrl:=/&amp;login=Login"  status_code: 200follow_redirects: trueregister: paginalogin&crarr;
  - name: "Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso"uri:    url: http://localhost/calendar/showMyCalendar  method: GETheaders:  Cookie: "{{ paginalogin.set_cookie }}"  return_content: yespaginawebExiste o texto editCompanySettings na página?""'password' not in paginaweb.content"&crarr;
"'password' not in paginaweb.content"- "'editCompanySettings' in paginaweb.content"success_msg: "SUCESSO: Login com sucesso. Utilizador e palavra passe iniciais correctamente criados"fail_msg: "ERRO: Não foi possivel fazer login! O utilizador ou palavra passe não foram criados com sucesso!"&crarr;
assert:&crarr;
- name: "Teste: Existe o texto editCompanySettings na página?"&crarr;
register: paginaweb&crarr;
return_content: yes&crarr;
Cookie: "{{ paginalogin.set_cookie }}"&crarr;
headers:&crarr;
method: GET&crarr;
url: http://localhost/calendar/showMyCalendar&crarr;
uri:&crarr;
- name: "Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso"&crarr;
register: paginalogin&crarr;
follow_redirects: true&crarr;
status_code: 200&crarr;
body: "username={{ login_website  }}&amp;password={{ password_website  }}&amp;redirectUrl:=/&amp;login=Login"&crarr;
method: POST&crarr;
url: http://localhost&crarr;
uri:&crarr;
- name: "Simulação: Tenta fazer login na aplicação com o utilizador criado"&crarr;
<b class=CYN>  # Fonte: https://stackoverflow.com/questions/63791689/ansible-looses-cookie-content</b>&crarr;
B<b class=CYN>  # è necessário gravar a cockie de sessão. A página oficial do Ansible contem um erro que é resolvido com a seguinte...</b>&crarr;
B<b class=CYN>  # foi realizado um debug da sessão de login. Com base nessa sessão a fase de Login encontra-se aqui replicada.</b>&crarr;
B<b class=CYN>  # Através do BurpSuite (https://portswigger.net/burp), aprendido nas aulas de Testes de Penetração e Desenvolvimento de Exploits</b>&crarr;
B  &crarr;
      &crarr;
<b class=CYN>  #        Este teste tem como objetivo verificar se é possível fazer o login</b>B&crarr;
<b class=CYN>  #        Se a base de dados estiver correctamente configurada e se o administrador do</b>&crarr;
  #        sistema estiver configurado, deve ser possível fazer login ao sistema sem problemas.B&crarr;
<b class=CYN>  # Teste: Verificar se o sistema se encontra devidamente instalado e configurado.</b>B&crarr;
fail_msg: "ERRO: mod_rewrite não instalado ou não ativo!"&crarr;
success_msg: "SUCESSO: mod_rewrite encontra-se instalado e ativo"&crarr;
- not estado.changed&crarr;
that:&crarr;
assert:&crarr;
- name: "Teste: o mod_rewrite do apache encontra-se ativo?"&crarr;
&#x232B;register: estado&crarr;
 &crarr;
  &crarr;
&crarr;
  B<b class="BLK BWHI">ModificadoB</b> &#x232B;"&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;"{{ paginalogin.set_cookie }}"&#x232B;&#x232B;&#x232B;GET&crarr;
&crarr;
&#x232B;&#x232B;&crarr;

- name: "Teste: Existe o texto editCompanySettings na página?"&crarr;

assert:&crarr;

that:&crarr;

- "'password' not in paginaweb.content"&crarr;

- "'editCompanySettings' in paginaweb.content"&crarr;

success_msg: "SUCESSO: Login com sucesso. Utilizador e palavra passe iniciais correctamente criados"&crarr;

fail_msg: "ERRO: Não foi possivel fazer login! O utilizador ou palavra passe não foram criados com sucesso!"&crarr;

         B<b class="BLK BWHI">M-DB</b> Formato DOSB<b class="BLK BWHI">M-AB</b> AnexarB<b class="BLK BWHI">BB</b> SegurançaB<b class="BLK BWHI">CB</b> Cancelar           B<b class="BLK BWHI">M-MB</b> Formato MacB<b class="BLK BWHI">M-PB</b> PreporB<b class="BLK BWHI">^TB</b> P/ ficheiros&crarr;
B<b class="BLK BWHI">Nome do ficheiro onde escrever: molecule/default/verify.yml                                                                               B</b> B<b class="BLK BWHI">[ A escrever... ]B</b>B<b class="BLK BWHI">          B</b>B<b class="BLK BWHI">[ 368 linhas escritas ]B</b>B<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> Procurar      B<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursorB<b class="BLK BWHI">UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txtB<b class="BLK BWHI">XB</b> Sair    B<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> Refazer      B<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;

<hr>
&crarr;
admlocal@devOps:~/leantime_ansible$ nano molecule/default/verify.yml &#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;molecule lint&#x232B;&#x232B;&#x232B;&#x232B;verify
<b class=BLU>INFO    </b> default scenario test matrix: verify
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>verify</b>
<b class=BLU>INFO    </b> Running Ansible Verifier

PLAY [Infraestrutura conduzida por testes] ***********************************************************************************************

TASK [Variáveis] *************************************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Atualizar a cache do sistema] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [teste: a cache encontra-se actualizada?] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Atualizar o sistema operativo (equivalente a apt upgrade)] *************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [teste: o sistema operativo encontra-se atualizado?] ********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O sistema operativo está atualizado"</b>
<b class=GRN>}</b>

TASK [Teste: a cache encontra-se atualizada?] ********************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas] ****************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: as dependencias encontra-se instaladas?] ************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: As dependencias estavam instaladas"</b>
<b class=GRN>}</b>

TASK [Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque] ****************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?] ***********************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"</b>
<b class=GRN>}</b>

TASK [Rotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2] ********************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile.] ****************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})</b>

TASK [Teste: As linhas do php.ini encontram-se alteradas ?] ******************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O ficheiro php.ini foi alterado com sucesso"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre a pastas /var/www/leantime] **********************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: A pasta /var/www/leantime existe e tem as permissões certas?] ***************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas no site leantime"</b>
<b class=GRN>}</b>

TASK [Simulação: Verifica se é necessário criar a base de dados leantime_database] *******************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: A base de dados leantime_database existe ?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A base de dados leantime_database já se encontra criada"</b>
<b class=GRN>}</b>

TASK [Simulação e Teste: Verifica se o endereço git para a versão de leantime existe] ****************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Obtem informação sobre o ficheiro /var/www/leantime/config/configuration.php] *******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /var/www/leantime/config/configuration.php existe e tem as permissões certas?] ***********************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas e ficheiro configuration.php existente"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o módulo replace.] ******************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O dbUser foi alterado?] *****************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o módulo replace.] **************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: a variável dbDatabase foi alterada?] ****************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o módulo replace.] **************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O dbPassword foi alterado?] *************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-available/leantime.conf] *******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permissões certas?] ***********************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf] *********************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permissões certas?] *************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/000-default.conf] ******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/000-default.conf NÃO existe?] *********************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "All assertions passed"</b>
<b class=GRN>}</b>

TASK [Simulação: Activa o módulo mod_rewrite no apache] **********************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Activa o módulo mod_rewrite no apache] **********************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: o mod_rewrite do apache encontra-se ativo?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: mod_rewrite encontra-se instalado e ativo"</b>
<b class=GRN>}</b>

TASK [Simulação: Tenta fazer login na aplicação com o utilizador criado] *****************************************************************
<b class=HIM>[WARNING]: The value True (type bool) in a string field was converted to 'True' (type string). If this does not look like what you</b>
<b class=HIM>expect, quote the entire value to ensure it does not change.</b>
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso] **********************************
<b class=RED>fatal: [ubuntu-20.04]: FAILED! =&gt; {"msg": "The task includes an option with an undefined variable. The error was: 'dict object' has no attribute 'set_cookie'\n\nThe error appears to be in '/home/admlocal/leantime_ansible/molecule/default/verify.yml': line 353, column 5, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n  - name: \"Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso\"\n    ^ here\nThis one looks easy to fix. It seems that there is a value started\nwith a quote, and the YAML parser is expecting to see the line ended\nwith the same kind of quote. For instance:\n\n    when: \"ok\" in result.stdout\n\nCould be written as:\n\n   when: '\"ok\" in result.stdout'\n\nOr equivalently:\n\n   when: \"'ok' in result.stdout\"\n"}</b>

PLAY RECAP *******************************************************************************************************************************
<b class=RED>ubuntu-20.04</b>               : <b class=GRN>ok=36  </b> changed=0    unreachable=0    <b class=RED>failed=1   </b> skipped=0    rescued=0    ignored=0


<b class=HIR>CRITICAL</b> Ansible return code was <b class=HIC>2</b>, command was: ansible-playbook --inventory <b class=MAG>/home/admlocal/.cache/molecule/leantime_ansible/default/</b><b style="color:#ff55ff;">inventory</b> --skip-tags molecule-notest,notest <b class=MAG>/home/admlocal/leantime_ansible/molecule/default/</b><b style="color:#ff55ff;">verify.yml</b>
admlocal@devOps:~/leantime_ansible$ molecule verify&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;nano molecule/default/verify.yml 
BB
<hr>
B<b class="BLK BWHI">[ A ler... ]B</b>B<b class="BLK BWHI">[ 368 linhas lidas ]B</b>B<b class="BLK BWHI">  GNU nano 4.8                                          molecule/default/verify.yml                                                       B</b>&crarr;
B<b class="BLK BWHI">^GB</b> AjudaB<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> ProcurarB<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursor    B<b class="BLK BWHI">M-UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txt&crarr;
B<b class="BLK BWHI">^XB</b> SairB<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> RefazerB<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
B---&crarr;
<b class=CYN># Tutorial de inspiração para a infraestrutura conduzida por teste no site</b>&crarr;
# https://www.adictosaltrabajo.com/2020/05/08/ansible-testing-using-molecule-with-ansible-as-verifier/&crarr;
B- name: "Infraestrutura conduzida por testes"hosts: allgather_facts: falsebecome: truetasks:- name: Variáveisinclude_vars:file: ../../vars/main.yml- name: "Simulação: Atualizar a cache do sistema"apt:&#x232B;&#x232B;update_cache: truecache_valid_time: 3600check_mode: trueregister: estado- name: "teste: a cache encontra-se actualizada?"assert:that:- not estado.changedsuccess_msg: "SUCESSO: A cache está atualizada"fail_msg: "ERRO: Existem actualizações pendentes"- name: "Atualizar o sistema operativo (equivalente a apt upgrade)"apt:&#x232B;&#x232B;upgrade: safecheck_mode: trueregister: estado- name: "teste: o sistema operativo encontra-se atualizado?"&crarr;
         In. parágB<b class="BLK BWHI">^YB</b> Prim.linhaB<b class="BLK BWHI">^TB</b> Ir para txtB<b class="BLK BWHI">CB</b> Cancelar           B<b class="BLK BWHI">OB</b> Fim parágB<b class="BLK BWHI">VB</b> Últ. linha&crarr;
B<b class="BLK BWHI">Insira nº da linha, nº da coluna:                                                                                                         B</b>B<b class="BLK BWHI">3</b>&crarr;
BB<b class="BLK BWHI">5</b>&crarr;
BB<b class="BLK BWHI">3</b>&crarr;
BB<b class="BLK BWHI">,</b>&crarr;
BB<b class="BLK BWHI">5</b>&crarr;
B&crarr;
B<b class="BLK BWHI">^OB</b> GravarProcurar      B<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursor    B<b class="BLK BWHI">M-UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txtB<b class="BLK BWHI">XB</b> Sair    B<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txtB<b class="BLK BWHI">TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> RefazerB<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
<b class=CYN>  # Teste: Verificar se o sistema se encontra devidamente instalado e configurado.</b>&crarr;
  #        Se a base de dados estiver correctamente configurada e se o administrador do&crarr;
  #        sistema estiver configurado, deve ser possível fazer login ao sistema sem problemas.B&crarr;
<b class=CYN>  #        Este teste tem como objetivo verificar se é possível fazer o login</b>&crarr;
  # Através do BurpSuite (https://portswigger.net/burp), aprendido nas aulas de Testes de Penetração e Desenvolvimento de Exploits&crarr;
  # foi realizado um debug da sessão de login. Com base nessa sessão a fase de Login encontra-se aqui replicada.&crarr;
  # è necessário gravar a cockie de sessão. A página oficial do Ansible contem um erro que é resolvido com a seguinte...&crarr;
  # Fonte: https://stackoverflow.com/questions/63791689/ansible-looses-cookie-contentB- name: "Simulação: Tenta fazer login na aplicação com o utilizador criado"  uri    url: http://localhost  method: POSTbody: "username={{ login_website  }}&amp;password={{ password_website  }}&amp;redirectUrl:=/&amp;login=Login"status_code: 200    follow_redirects: trueregister: paginalogin&crarr;
  - name: "Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso"uri:&#x232B;&#x232B;url: http://localhost/calendar/showMyCalendarmethod: GETheaders:Cookie: "{{ paginalogin.set_cookie }}"  return_content: yespaginawebTExiste o texto editCompanySettings na página?""'password' not in paginaweb.content"- "'editCompanySettings' in paginaweb.content"  success_msg: "SUCESSO: Login com sucesso. Utilizador e palavra passe iniciais correctamente criados"  fail_msg: "ERRO: Não foi possivel fazer login! O utilizador ou palavra passe não foram criados com sucesso!"&crarr;
&crarr;
    name: "SB<b class="BLK BWHI">ModificadoB</b>&#x232B;""imulação: Tenta fazer login na aplicação com o utilizador criado"&crarr;
  - name: &#x232B; &#x232B;"&crarr;
      body: "u&#x232B;&#x232B;"username={{ login_website  }}&amp;password={{ password_website  }}&amp;redirectUrl:=/&amp;login=Login"&#x232B; &#x232B;"&crarr;
      body: "username={{ login_website  }}&amp;password={{ password_website&crarr;
&crarr;
  - name: "&#x232B;"Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso"&#x232B; &#x232B;"&#x232B; &#x232B;"&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;"&#x232B;"{{ paginalogin.set_cookie }}"&crarr;
&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;"Teste: Existe o texto editCompanySettings na página?"&#x232B; &#x232B;"&crarr;
      - "&#x232B;"'password' not in paginaweb.content"&#x232B; &#x232B;"&#x232B; &#x232B;"&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;"&#x232B;"'editCompanySettings' in paginaweb.content"&crarr;
&#x232B;:&crarr;
&#x232B;: "Simulação: Tenta fazer login na aplicação com o utilizador criado"&crarr;
fail_msg: "ERRO: mod_rewrite não instalado ou não ativo!"&crarr;
success_msg: "SUCESSO: mod_rewrite encontra-se instalado e ativo"&crarr;
- not estado.changed&crarr;
that:&crarr;
assert:&crarr;
- name: "Teste: o mod_rewrite do apache encontra-se ativo?"&crarr;
register: estado&crarr;
check_mode: true&crarr;
 &#x232B; sg: "&crarr;
&crarr;
     &#x232B;<b class=CYN>É necessário gravar a cockie de sessão. A página oficial do Ansible contem um erro que é resolvido com a seguinte...</b>B         B<b class="BLK BWHI">M-DB</b> Formato DOSB<b class="BLK BWHI">M-AB</b> AnexarB<b class="BLK BWHI">BB</b> SegurançaB<b class="BLK BWHI">CB</b> Cancelar           B<b class="BLK BWHI">M-MB</b> Formato MacB<b class="BLK BWHI">M-PB</b> PreporB<b class="BLK BWHI">^TB</b> P/ ficheiros&crarr;
B<b class="BLK BWHI">Nome do ficheiro onde escrever: molecule/default/verify.yml                                                                               B</b> B<b class="BLK BWHI">[ A escrever... ]B</b>B<b class="BLK BWHI">          B</b>B<b class="BLK BWHI">[ 368 linhas escritas ]B</b>B<b class="BLK BWHI">^OB</b> GravarB<b class="BLK BWHI">^WB</b> Procurar      B<b class="BLK BWHI">^KB</b> Cortar txt    B<b class="BLK BWHI">^JB</b> Justificar    B<b class="BLK BWHI">^CB</b> Pos cursorB<b class="BLK BWHI">UB</b> Desfazer     B<b class="BLK BWHI">M-AB</b> Marcar txtB<b class="BLK BWHI">XB</b> Sair    B<b class="BLK BWHI">^RB</b> CarregarB<b class="BLK BWHI">^\B</b> Substituir    B<b class="BLK BWHI">^UB</b> Colar txt     B<b class="BLK BWHI">^TB</b> Ortografia    B<b class="BLK BWHI">^_B</b> Ir p/ linha   B<b class="BLK BWHI">M-EB</b> Refazer      B<b class="BLK BWHI">M-6B</b> Copiar txt&crarr;
&crarr;

<hr>
&crarr;
admlocal@devOps:~/leantime_ansible$ molecule lint
<b class=BLU>INFO    </b> default scenario test matrix: dependency, lint
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>dependency</b>
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=RED>WARNING </b> Skipping, missing the requirements file.
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>lint</b>
COMMAND: set -e
yamllint .
ansible-lint

Loading custom .yamllint config file, this extends our internal yamllint config.
admlocal@devOps:~/leantime_ansible$ molecule lint&#x232B;&#x232B;&#x232B;&#x232B;verify
<b class=BLU>INFO    </b> default scenario test matrix: verify
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>verify</b>
<b class=BLU>INFO    </b> Running Ansible Verifier

PLAY [Infraestrutura conduzida por testes] ***********************************************************************************************

TASK [Variáveis] *************************************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Atualizar a cache do sistema] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [teste: a cache encontra-se actualizada?] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Atualizar o sistema operativo (equivalente a apt upgrade)] *************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [teste: o sistema operativo encontra-se atualizado?] ********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O sistema operativo está atualizado"</b>
<b class=GRN>}</b>

TASK [Teste: a cache encontra-se atualizada?] ********************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas] ****************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: as dependencias encontra-se instaladas?] ************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: As dependencias estavam instaladas"</b>
<b class=GRN>}</b>

TASK [Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque] ****************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?] ***********************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"</b>
<b class=GRN>}</b>

TASK [Rotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2] ********************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile.] ****************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'})</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'})</b>

TASK [Teste: As linhas do php.ini encontram-se alteradas ?] ******************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O ficheiro php.ini foi alterado com sucesso"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre a pastas /var/www/leantime] **********************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: A pasta /var/www/leantime existe e tem as permissões certas?] ***************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas no site leantime"</b>
<b class=GRN>}</b>

TASK [Simulação: Verifica se é necessário criar a base de dados leantime_database] *******************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: A base de dados leantime_database existe ?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A base de dados leantime_database já se encontra criada"</b>
<b class=GRN>}</b>

TASK [Simulação e Teste: Verifica se o endereço git para a versão de leantime existe] ****************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Obtem informação sobre o ficheiro /var/www/leantime/config/configuration.php] *******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /var/www/leantime/config/configuration.php existe e tem as permissões certas?] ***********************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas e ficheiro configuration.php existente"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o módulo replace.] ******************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O dbUser foi alterado?] *****************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o módulo replace.] **************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: a variável dbDatabase foi alterada?] ****************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o módulo replace.] **************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O dbPassword foi alterado?] *************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-available/leantime.conf] *******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permissões certas?] ***********************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf] *********************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permissões certas?] *************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/000-default.conf] ******************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/000-default.conf NÃO existe?] *********************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "All assertions passed"</b>
<b class=GRN>}</b>

TASK [Simulação: Activa o módulo mod_rewrite no apache] **********************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Activa o módulo mod_rewrite no apache] **********************************************************************************
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Teste: o mod_rewrite do apache encontra-se ativo?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: mod_rewrite encontra-se instalado e ativo"</b>
<b class=GRN>}</b>

TASK [Simulação: Tenta fazer login na aplicação com o utilizador criado] *****************************************************************
<b class=HIM>[WARNING]: The value True (type bool) in a string field was converted to 'True' (type string). If this does not look like what you</b>
<b class=HIM>expect, quote the entire value to ensure it does not change.</b>
<b class=GRN>ok: [ubuntu-20.04]</b>

TASK [Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso] **********************************
<b class=RED>fatal: [ubuntu-20.04]: FAILED! =&gt; {"msg": "The task includes an option with an undefined variable. The error was: 'dict object' has no attribute 'set_cookie'\n\nThe error appears to be in '/home/admlocal/leantime_ansible/molecule/default/verify.yml': line 353, column 5, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n  - name: \"Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso\"\n    ^ here\nThis one looks easy to fix. It seems that there is a value started\nwith a quote, and the YAML parser is expecting to see the line ended\nwith the same kind of quote. For instance:\n\n    when: \"ok\" in result.stdout\n\nCould be written as:\n\n   when: '\"ok\" in result.stdout'\n\nOr equivalently:\n\n   when: \"'ok' in result.stdout\"\n"}</b>

PLAY RECAP *******************************************************************************************************************************
<b class=RED>ubuntu-20.04</b>               : <b class=GRN>ok=36  </b> changed=0    unreachable=0    <b class=RED>failed=1   </b> skipped=0    rescued=0    ignored=0


<b class=HIR>CRITICAL</b> Ansible return code was <b class=HIC>2</b>, command was: ansible-playbook --inventory <b class=MAG>/home/admlocal/.cache/molecule/leantime_ansible/default/</b><b style="color:#ff55ff;">inventory</b> --skip-tags molecule-notest,notest <b class=MAG>/home/admlocal/leantime_ansible/molecule/default/</b><b style="color:#ff55ff;">verify.yml</b>
admlocal@devOps:~/leantime_ansible$ molecule verify --debug
Usage: molecule verify [OPTIONS]
Try "molecule verify --help" for help.

Error: no such option: --debug
admlocal@devOps:~/leantime_ansible$ molecu&#x232B;ule verify --debug&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;-verify&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B; verify&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B; verify&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;&#x232B;
<b class=HIK>DEBUG   </b> Validating schema <b class=MAG>/home/admlocal/leantime_ansible/molecule/default/</b><b style="color:#ff55ff;">molecule.yml.</b>
<b class=BLU>INFO    </b> default scenario test matrix: verify
<b class=BLU>INFO    </b> Performing prerun<b class=YEL>...</b>
<b class=BLU>INFO    </b> Using .cache/roles/nunomourinho.leantime_ansible symlink to current repository in order to enable Ansible to find the role using its expected full name.
<b class=BLU>INFO    </b> Added <b class=YEL>ANSIBLE_ROLES_PATH</b>=~<b class=MAG>/.ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/usr/share/ansible/</b><b style="color:#ff55ff;">roles</b>:<b class=MAG>/etc/ansible/</b><b style="color:#ff55ff;">roles</b>:.<b class=MAG>/.cache/</b><b style="color:#ff55ff;">roles</b>
<b class=BLU>INFO    </b> <b class=HIK>Running </b><b class=HIK>default</b><b class=HIK> &gt; </b><b class=HIK>verify</b>
<b class=BLU>INFO    </b> Running Ansible Verifier
<b class=BLU>Using /home/admlocal/.cache/molecule/leantime_ansible/default/ansible.cfg as config file</b>

PLAY [Infraestrutura conduzida por testes] ***********************************************************************************************

TASK [Variáveis] *************************************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"ansible_facts": {"login_leantime": "leantimeDBadmin", "login_website": "my_name@my_email.com", "password_leantime": "#S3gr3d0S3cr3t0#", "password_website": "S3cr3tPwd@V3ryS3cret«", "versao_leantime": "v2.1.7"}, "ansible_included_var_files": ["/home/admlocal/leantime_ansible/molecule/default/../../vars/main.yml"], "changed": false}</b>

TASK [Simulação: Atualizar a cache do sistema] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3"}, "cache_update_time": 1622020250, "cache_updated": false, "changed": false}</b>

TASK [teste: a cache encontra-se actualizada?] *******************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Atualizar o sistema operativo (equivalente a apt upgrade)] *************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "msg": "Reading package lists...\nBuilding dependency tree...\nReading state information...\nCalculating upgrade...\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\n", "stderr": "", "stderr_lines": [], "stdout": "Reading package lists...\nBuilding dependency tree...\nReading state information...\nCalculating upgrade...\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\n", "stdout_lines": ["Reading package lists...", "Building dependency tree...", "Reading state information...", "Calculating upgrade...", "0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded."]}</b>

TASK [teste: o sistema operativo encontra-se atualizado?] ********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O sistema operativo está atualizado"</b>
<b class=GRN>}</b>

TASK [Teste: a cache encontra-se atualizada?] ********************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A cache está atualizada"</b>
<b class=GRN>}</b>

TASK [Simulação: testa se as aplicações dependencia do software leantime se encontram instaladas] ****************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"cache_update_time": 1622020250, "cache_updated": false, "changed": false}</b>

TASK [Teste: as dependencias encontra-se instaladas?] ************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: As dependencias estavam instaladas"</b>
<b class=GRN>}</b>

TASK [Simulação: Testar se o serviço apache2 se encontra instalado, iniciado e ativo no arranque] ****************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "enabled": true, "name": "apache2", "state": "started", "status": {"ActiveEnterTimestamp": "Tue 2021-05-25 23:38:38 UTC", "ActiveEnterTimestampMonotonic": "326035816", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "remote-fs.target systemd-tmpfiles-setup.service basic.target network.target sysinit.target nss-lookup.target systemd-journald.socket -.mount system.slice", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Tue 2021-05-25 23:38:37 UTC", "AssertTimestampMonotonic": "325941816", "Before": "multi-user.target shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Tue 2021-05-25 23:38:37 UTC", "ConditionTimestampMonotonic": "325941816", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/apache2.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "The Apache HTTP Server", "DevicePolicy": "auto", "Documentation": "https://httpd.apache.org/docs/2.4/", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "Environment": "APACHE_STARTED_BY_SYSTEMD=true", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "28018", "ExecMainStartTimestamp": "Tue 2021-05-25 23:38:38 UTC", "ExecMainStartTimestampMonotonic": "326035787", "ExecMainStatus": "0", "ExecReload": "{ path=/usr/sbin/apachectl ; argv[]=/usr/sbin/apachectl graceful ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/usr/sbin/apachectl ; argv[]=/usr/sbin/apachectl graceful ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/apachectl ; argv[]=/usr/sbin/apachectl start ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/apachectl ; argv[]=/usr/sbin/apachectl start ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStop": "{ path=/usr/sbin/apachectl ; argv[]=/usr/sbin/apachectl stop ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStopEx": "{ path=/usr/sbin/apachectl ; argv[]=/usr/sbin/apachectl stop ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/apache2.service", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "apache2.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Tue 2021-05-25 23:38:37 UTC", "InactiveExitTimestampMonotonic": "325944063", "InvocationID": "bcaf796d984f4659b3246e96f4dde8f2", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7814", "LimitNPROCSoft": "7814", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7814", "LimitSIGPENDINGSoft": "7814", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "28018", "MemoryAccounting": "yes", "MemoryCurrent": "17825792", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "apache2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "yes", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "-.mount system.slice sysinit.target", "RequiresMountsFor": "/tmp /var/tmp", "Restart": "on-abort", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Tue 2021-05-25 23:38:38 UTC", "StateChangeTimestampMonotonic": "326035816", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "6", "TasksMax": "2344", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "forking", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}</b>

TASK [Teste: O serviço apache2 encontra-se ativo no arranque no sistema, e está iniciado?] ***********************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O serviço apache2 está correctamente instalado e inicia com o arranque do sistema"</b>
<b class=GRN>}</b>

TASK [Rotina Auxiliar&gt; Procura o caminho do ficheiro php.ini do servidor apache2] ********************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "examined": 2021, "files": [{"atime": 1621986020.5731876, "ctime": 1621985964.1089694, "dev": 2049, "gid": 0, "gr_name": "root", "inode": 18, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": false, "isreg": true, "issock": false, "isuid": false, "mode": "0644", "mtime": 1621985964.1089694, "nlink": 1, "path": "/etc/php/7.4/apache2/php.ini", "pw_name": "root", "rgrp": true, "roth": true, "rusr": true, "size": 72940, "uid": 0, "wgrp": false, "woth": false, "wusr": true, "xgrp": false, "xoth": false, "xusr": false}, {"atime": 1621985942.1700056, "ctime": 1621985876.6532636, "dev": 2049, "gid": 0, "gr_name": "root", "inode": 774454, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": false, "isreg": true, "issock": false, "isuid": false, "mode": "0644", "mtime": 1601999276.0, "nlink": 1, "path": "/etc/php/7.4/cli/php.ini", "pw_name": "root", "rgrp": true, "roth": true, "rusr": true, "size": 72539, "uid": 0, "wgrp": false, "woth": false, "wusr": true, "xgrp": false, "xoth": false, "xusr": false}], "matched": 2, "msg": ""}</b>

TASK [Simulação: Ativa a opção file_uploads no ficheiro php.ini, utilizando o módulo lineinfile.] ****************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^file_uploads', 'line': 'file_uploads = 1'}) =&gt; {"ansible_loop_var": "item", "backup": "", "changed": false, "item": {"line": "file_uploads = 1", "regexp": "^file_uploads"}, "msg": ""}</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^upload_max_filesize', 'line': 'upload_max_filesize = 1G'}) =&gt; {"ansible_loop_var": "item", "backup": "", "changed": false, "item": {"line": "upload_max_filesize = 1G", "regexp": "^upload_max_filesize"}, "msg": ""}</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_file_uploads', 'line': 'max_file_uploads = 20'}) =&gt; {"ansible_loop_var": "item", "backup": "", "changed": false, "item": {"line": "max_file_uploads = 20", "regexp": "^max_file_uploads"}, "msg": ""}</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^post_max_size', 'line': 'post_max_size = 2G'}) =&gt; {"ansible_loop_var": "item", "backup": "", "changed": false, "item": {"line": "post_max_size = 2G", "regexp": "^post_max_size"}, "msg": ""}</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^memory_limit', 'line': 'memory_limit = 2G'}) =&gt; {"ansible_loop_var": "item", "backup": "", "changed": false, "item": {"line": "memory_limit = 2G", "regexp": "^memory_limit"}, "msg": ""}</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; (item={'regexp': '^max_input_time', 'line': 'max_input_time = 3600'}) =&gt; {"ansible_loop_var": "item", "backup": "", "changed": false, "item": {"line": "max_input_time = 3600", "regexp": "^max_input_time"}, "msg": ""}</b>

TASK [Teste: As linhas do php.ini encontram-se alteradas ?] ******************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O ficheiro php.ini foi alterado com sucesso"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre a pastas /var/www/leantime] **********************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "stat": {"atime": 1621985965.1694996, "attr_flags": "e", "attributes": ["extents"], "block_size": 4096, "blocks": 8, "charset": "binary", "ctime": 1621985973.1975117, "dev": 2049, "device_type": 0, "executable": true, "exists": true, "gid": 33, "gr_name": "www-data", "inode": 1280370, "isblk": false, "ischr": false, "isdir": true, "isfifo": false, "isgid": false, "islnk": false, "isreg": false, "issock": false, "isuid": false, "mimetype": "inode/directory", "mode": "0755", "mtime": 1621985973.1975117, "nlink": 8, "path": "/var/www/leantime", "pw_name": "www-data", "readable": true, "rgrp": true, "roth": true, "rusr": true, "size": 4096, "uid": 33, "version": "2814010018", "wgrp": false, "woth": false, "writeable": true, "wusr": true, "xgrp": true, "xoth": true, "xusr": true}}</b>

TASK [Teste: A pasta /var/www/leantime existe e tem as permissões certas?] ***************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas no site leantime"</b>
<b class=GRN>}</b>

TASK [Simulação: Verifica se é necessário criar a base de dados leantime_database] *******************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "cmd": "mysql -u root -e 'use leantime_database'", "delta": "0:00:00.027427", "end": "2021-05-26 09:28:55.149819", "failed_when_result": false, "rc": 0, "start": "2021-05-26 09:28:55.122392", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}</b>

TASK [Teste: A base de dados leantime_database existe ?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: A base de dados leantime_database já se encontra criada"</b>
<b class=GRN>}</b>

TASK [Simulação e Teste: Verifica se o endereço git para a versão de leantime existe] ****************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"accept_ranges": "bytes", "age": "129", "changed": false, "connection": "close", "content_disposition": "attachment; filename=Leantime-v2.1.7.zip", "content_length": "29635461", "content_type": "application/octet-stream", "cookies": {}, "cookies_string": "", "date": "Wed, 26 May 2021 09:28:56 GMT", "elapsed": 2, "etag": "\"2f38e583171fbf2cbfcab5381b900ec9\"", "last_modified": "Sat, 06 Feb 2021 04:55:33 GMT", "msg": "OK (29635461 bytes)", "redirected": true, "server": "AmazonS3", "status": 200, "strict_transport_security": "max-age=31536000", "url": "https://github-releases.githubusercontent.com/29745084/a199b200-680d-11eb-9f71-1d481f70a225?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20210526%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20210526T092646Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=ec2f005ebb222fb09876feb3e2b419f89a088078724241f4e47ed533ce4281be&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;key_id=0&amp;repo_id=29745084&amp;response-content-disposition=attachment%3B%20filename%3DLeantime-v2.1.7.zip&amp;response-content-type=application%2Foctet-stream", "via": "1.1 varnish, 1.1 varnish", "x_amz_id_2": "MANlIkCq7QsYNpsBCeQPvkDmHIbSHcI9HSALB+ZRWfBMcx5loQ662ZVSVOuPv0Hj7jVv2Anm3wg=", "x_amz_request_id": "E2TJEN94SJ017CNF", "x_cache": "MISS, HIT", "x_cache_hits": "0, 0", "x_fastly_request_id": "64ff8596b77103b513fc147413bb0a9bfeca73ed", "x_served_by": "cache-dca17781-DCA, cache-mad22046-MAD"}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /var/www/leantime/config/configuration.php] *******************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "stat": {"atime": 1621986033.7277615, "attr_flags": "e", "attributes": ["extents"], "block_size": 4096, "blocks": 16, "charset": "us-ascii", "checksum": "3e32b92314445eebee7c73294775ba7577dc5e15", "ctime": 1621985977.0914576, "dev": 2049, "device_type": 0, "executable": true, "exists": true, "gid": 33, "gr_name": "www-data", "inode": 774462, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": false, "isreg": true, "issock": false, "isuid": false, "mimetype": "text/x-php", "mode": "0755", "mtime": 1621985977.0914576, "nlink": 1, "path": "/var/www/leantime/config/configuration.php", "pw_name": "www-data", "readable": true, "rgrp": true, "roth": true, "rusr": true, "size": 5724, "uid": 33, "version": "260453957", "wgrp": false, "woth": false, "writeable": true, "wusr": true, "xgrp": true, "xoth": true, "xusr": true}}</b>

TASK [Teste: O ficheiro /var/www/leantime/config/configuration.php existe e tem as permissões certas?] ***********************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas e ficheiro configuration.php existente"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbuser foi alterado no ficheiro configuration.php utilizando o módulo replace.] ******************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "failed_when_result": false, "msg": ""}</b>

TASK [Teste: O dbUser foi alterado?] *****************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbUser foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbDatabase foi alterado no ficheiro configuration.php utilizando o módulo replace.] **************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "failed_when_result": false, "msg": ""}</b>

TASK [Teste: a variável dbDatabase foi alterada?] ****************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbDatabase foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Testa se o dbPassword foi alterado no ficheiro configuration.php utilizando o módulo replace.] **************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "failed_when_result": false, "msg": ""}</b>

TASK [Teste: O dbPassword foi alterado?] *************************************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: O dbPassword foi alterado no ficheiro configuration.php"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-available/leantime.conf] *******************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "stat": {"atime": 1621985979.8768497, "attr_flags": "e", "attributes": ["extents"], "block_size": 4096, "blocks": 8, "charset": "us-ascii", "checksum": "589a794e2832307500d22bf7df4b52d92282f318", "ctime": 1621985978.8403316, "dev": 2049, "device_type": 0, "executable": true, "exists": true, "gid": 33, "gr_name": "www-data", "inode": 774463, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": false, "isreg": true, "issock": false, "isuid": false, "mimetype": "text/plain", "mode": "0777", "mtime": 1621985977.5997117, "nlink": 1, "path": "/etc/apache2/sites-available/leantime.conf", "pw_name": "root", "readable": true, "rgrp": true, "roth": true, "rusr": true, "size": 320, "uid": 0, "version": "3389268433", "wgrp": true, "woth": true, "writeable": true, "wusr": true, "xgrp": true, "xoth": true, "xusr": true}}</b>

TASK [Teste: O ficheiro /etc/apache2/sites-available/leantime.conf existe e tem as permissões certas?] ***********************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/leantime.conf] *********************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "stat": {"atime": 1621985979.8768497, "attr_flags": "", "attributes": [], "block_size": 4096, "blocks": 0, "charset": "binary", "ctime": 1621985978.4601417, "dev": 2049, "device_type": 0, "executable": true, "exists": true, "gid": 0, "gr_name": "root", "inode": 1033827, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": true, "isreg": false, "issock": false, "isuid": false, "lnk_source": "/etc/apache2/sites-available/leantime.conf", "lnk_target": "/etc/apache2/sites-available/leantime.conf", "mimetype": "inode/symlink", "mode": "0777", "mtime": 1621985978.4601417, "nlink": 1, "path": "/etc/apache2/sites-enabled/leantime.conf", "pw_name": "root", "readable": true, "rgrp": true, "roth": true, "rusr": true, "size": 42, "uid": 0, "version": null, "wgrp": true, "woth": true, "writeable": true, "wusr": true, "xgrp": true, "xoth": true, "xusr": true}}</b>

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/leantime.conf existe e tem as permissões certas?] *************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: Permissões correctas"</b>
<b class=GRN>}</b>

TASK [Simulação: Obtem informação sobre o ficheiro /etc/apache2/sites-enabled/000-default.conf] ******************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "stat": {"exists": false}}</b>

TASK [Teste: O ficheiro /etc/apache2/sites-enabled/000-default.conf NÃO existe?] *********************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "All assertions passed"</b>
<b class=GRN>}</b>

TASK [Simulação: Activa o módulo mod_rewrite no apache] **********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "result": "Module rewrite enabled"}</b>

TASK [Simulação: Activa o módulo mod_rewrite no apache] **********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"changed": false, "result": "Module rewrite enabled"}</b>

TASK [Teste: o mod_rewrite do apache encontra-se ativo?] *********************************************************************************
<b class=GRN>ok: [ubuntu-20.04] =&gt; {</b>
<b class=GRN>    "changed": false,</b>
<b class=GRN>    "msg": "SUCESSO: mod_rewrite encontra-se instalado e ativo"</b>
<b class=GRN>}</b>

TASK [Simulação: Tenta fazer login na aplicação com o utilizador criado] *****************************************************************
<b class=HIM>[WARNING]: The value True (type bool) in a string field was converted to 'True' (type string). If this does not look like what you</b>
<b class=HIM>expect, quote the entire value to ensure it does not change.</b>
<b class=GRN>ok: [ubuntu-20.04] =&gt; {"accept_ranges": "bytes", "changed": false, "connection": "close", "content_length": "10918", "content_type": "text/html", "cookies": {}, "cookies_string": "", "date": "Wed, 26 May 2021 09:29:05 GMT", "elapsed": 0, "etag": "\"2aa6-5c330063848fb\"", "last_modified": "Tue, 25 May 2021 23:38:33 GMT", "msg": "OK (10918 bytes)", "redirected": false, "server": "Apache/2.4.41 (Ubuntu)", "status": 200, "url": "http://localhost", "vary": "Accept-Encoding"}</b>

TASK [Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso] **********************************
<b class=RED>fatal: [ubuntu-20.04]: FAILED! =&gt; {"msg": "The task includes an option with an undefined variable. The error was: 'dict object' has no attribute 'set_cookie'\n\nThe error appears to be in '/home/admlocal/leantime_ansible/molecule/default/verify.yml': line 353, column 5, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n  - name: \"Simulação: Obtem a página showMyCalendar para testar uma página com o login efetuado com sucesso\"\n    ^ here\nThis one looks easy to fix. It seems that there is a value started\nwith a quote, and the YAML parser is expecting to see the line ended\nwith the same kind of quote. For instance:\n\n    when: \"ok\" in result.stdout\n\nCould be written as:\n\n   when: '\"ok\" in result.stdout'\n\nOr equivalently:\n\n   when: \"'ok' in result.stdout\"\n"}</b>

PLAY RECAP *******************************************************************************************************************************
<b class=RED>ubuntu-20.04</b>               : <b class=GRN>ok=36  </b> changed=0    unreachable=0    <b class=RED>failed=1   </b> skipped=0    rescued=0    ignored=0


<b class=HIR>CRITICAL</b> Ansible return code was <b class=HIC>2</b>, command was: ansible-playbook --inventory <b class=MAG>/home/admlocal/.cache/molecule/leantime_ansible/default/</b><b style="color:#ff55ff;">inventory</b> --skip-tags molecule-notest,notest <b class=MAG>/home/admlocal/leantime_ansible/molecule/default/</b><b style="color:#ff55ff;">verify.yml</b>
admlocal@devOps:~/leantime_ansible$ exit
exit
</pre>
</body>
</html>
